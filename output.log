nohup: ignoring input

    ======== Experiment Configuration ========
    Dataset: BrainTumor
    Alpha (Data Percent): 0.6
    Batch Size: 32
    Learning Rate: 5e-05
    Number of Clients: 4
    Iterations (Communication Rounds): 100
    Local Worker Epochs: 1
    Test Environments (Clients): [3]
    Model: ViT-B/16
    Beta1: 0.9, Beta2: 0.98
    Weight Decay: 0.02
    ==========================================
    
[0.5217391304347826, 0.14492753623188406, 0.3333333333333333, 0.33333333333]
============ Train epoch 0 ============
0 0
cla loss:  3.295967227849529 trans loss: 0.8742165224036978
0 0
cla loss:  3.275471966470306 trans loss: 0.884536313950716
0 0
cla loss:  3.2877572253720846 trans loss: 0.869487163109995

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.68it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.65it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.63it/s]
 11%|█         | 4/36 [00:00<00:04,  6.76it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.71it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.63it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.65it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.62it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.63it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.70it/s]
 31%|███       | 11/36 [00:01<00:03,  6.65it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.67it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.71it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.72it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.82it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.75it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.78it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.65it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.64it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.59it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.57it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.50it/s]
 64%|██████▍   | 23/36 [00:03<00:02,  6.49it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.54it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.65it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.63it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.71it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.57it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.63it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.70it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.74it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.79it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.69it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.69it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.84it/s]
100%|██████████| 36/36 [00:05<00:00,  6.85it/s]
100%|██████████| 36/36 [00:05<00:00,  6.68it/s]
 Site-0| Train Acc: 0.6076

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.82it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.80it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.84it/s]
100%|██████████| 4/4 [00:00<00:00,  6.87it/s]
100%|██████████| 4/4 [00:00<00:00,  6.85it/s]
 Site-0| Val  Acc: 0.6016

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.74it/s]
 20%|██        | 2/10 [00:00<00:01,  7.00it/s]
 30%|███       | 3/10 [00:00<00:01,  6.71it/s]
 40%|████      | 4/10 [00:00<00:00,  6.71it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.59it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.51it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.64it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.68it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.74it/s]
100%|██████████| 10/10 [00:01<00:00,  6.71it/s]
100%|██████████| 10/10 [00:01<00:00,  6.69it/s]
 Site-1| Train Acc: 0.6406

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.82it/s]
100%|██████████| 1/1 [00:00<00:00,  6.81it/s]
 Site-1| Val  Acc: 0.6250

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.09it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.01it/s]
 13%|█▎        | 3/23 [00:00<00:03,  5.89it/s]
 17%|█▋        | 4/23 [00:00<00:03,  6.27it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.46it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.35it/s]
 30%|███       | 7/23 [00:01<00:02,  6.55it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.52it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.54it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.63it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.64it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.61it/s]
 57%|█████▋    | 13/23 [00:02<00:01,  6.59it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.63it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.53it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.66it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.59it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.72it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.66it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.51it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.58it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.62it/s]
100%|██████████| 23/23 [00:03<00:00,  6.69it/s]
100%|██████████| 23/23 [00:03<00:00,  6.54it/s]
 Site-2| Train Acc: 0.6250

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.89it/s]
100%|██████████| 2/2 [00:00<00:00,  6.80it/s]
100%|██████████| 2/2 [00:00<00:00,  6.81it/s]
 Site-2| Val  Acc: 0.6562

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.27it/s]
 40%|████      | 2/5 [00:00<00:00,  6.73it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.15it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.49it/s]
100%|██████████| 5/5 [00:00<00:00,  7.06it/s]
 Test site-0| Test Acc: 0.6667 | Bacc: 0.7085

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.62it/s]
100%|██████████| 2/2 [00:00<00:00,  9.91it/s]
 Test site-1| Test Acc: 0.5476 | Bacc: 0.5857

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.65it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.61it/s]
100%|██████████| 3/3 [00:00<00:00,  6.70it/s]
100%|██████████| 3/3 [00:00<00:00,  6.67it/s]
 Test site-2| Test Acc: 0.5745 | Bacc: 0.6053

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.11it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.37it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.15it/s]
 31%|███       | 4/13 [00:00<00:01,  7.07it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.42it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.64it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.73it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.35it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.19it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  5.96it/s]
100%|██████████| 13/13 [00:01<00:00,  7.33it/s]
 Test site-3| Test Acc: 0.5635 | Bacc: 0.5704
============ Train epoch 1 ============
0 0
cla loss:  3.085588619337609 trans loss: 0.7834571114736586
0 0
cla loss:  3.052837275979507 trans loss: 0.7788049908139598
0 0
cla loss:  3.0783258742423514 trans loss: 0.7885903266806099

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.69it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.64it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.78it/s]
 11%|█         | 4/36 [00:00<00:04,  6.84it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.70it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.74it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.86it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.64it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.54it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.62it/s]
 31%|███       | 11/36 [00:01<00:03,  6.47it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.53it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.47it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.53it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.39it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.41it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.50it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.37it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.48it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.46it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.43it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.51it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.56it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.57it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.62it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.71it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.72it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.74it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.78it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.69it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.58it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.67it/s]
 92%|█████████▏| 33/36 [00:05<00:00,  6.61it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.67it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.64it/s]
100%|██████████| 36/36 [00:05<00:00,  6.70it/s]
100%|██████████| 36/36 [00:05<00:00,  6.60it/s]
 Site-0| Train Acc: 0.7196

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.62it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.56it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.66it/s]
100%|██████████| 4/4 [00:00<00:00,  6.59it/s]
100%|██████████| 4/4 [00:00<00:00,  6.59it/s]
 Site-0| Val  Acc: 0.6641

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.78it/s]
 20%|██        | 2/10 [00:00<00:01,  6.86it/s]
 30%|███       | 3/10 [00:00<00:01,  6.72it/s]
 40%|████      | 4/10 [00:00<00:00,  6.63it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.66it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.32it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.39it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.50it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.42it/s]
100%|██████████| 10/10 [00:01<00:00,  6.53it/s]
100%|██████████| 10/10 [00:01<00:00,  6.53it/s]
 Site-1| Train Acc: 0.7344

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.79it/s]
100%|██████████| 1/1 [00:00<00:00,  6.77it/s]
 Site-1| Val  Acc: 0.6875

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.32it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.28it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.50it/s]
 17%|█▋        | 4/23 [00:00<00:03,  6.31it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.33it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.34it/s]
 30%|███       | 7/23 [00:01<00:02,  6.43it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.54it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.43it/s]
 43%|████▎     | 10/23 [00:01<00:02,  6.48it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.46it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.52it/s]
 57%|█████▋    | 13/23 [00:02<00:01,  6.68it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.79it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.74it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.53it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.61it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.75it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.76it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.74it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.83it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.73it/s]
100%|██████████| 23/23 [00:03<00:00,  6.75it/s]
100%|██████████| 23/23 [00:03<00:00,  6.59it/s]
 Site-2| Train Acc: 0.7310

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.50it/s]
100%|██████████| 2/2 [00:00<00:00,  6.51it/s]
100%|██████████| 2/2 [00:00<00:00,  6.50it/s]
 Site-2| Val  Acc: 0.6562

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.11it/s]
 40%|████      | 2/5 [00:00<00:00,  6.61it/s]
 60%|██████    | 3/5 [00:00<00:00,  5.81it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.18it/s]
100%|██████████| 5/5 [00:00<00:00,  6.78it/s]
 Test site-0| Test Acc: 0.7619 | Bacc: 0.7913

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.52it/s]
100%|██████████| 2/2 [00:00<00:00,  9.85it/s]
 Test site-1| Test Acc: 0.7619 | Bacc: 0.7762

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.55it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.47it/s]
100%|██████████| 3/3 [00:00<00:00,  6.57it/s]
100%|██████████| 3/3 [00:00<00:00,  6.55it/s]
 Test site-2| Test Acc: 0.6809 | Bacc: 0.6925

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.02it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.19it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.60it/s]
 31%|███       | 4/13 [00:00<00:01,  6.43it/s]
 38%|███▊      | 5/13 [00:00<00:01,  6.67it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.05it/s]
 54%|█████▍    | 7/13 [00:00<00:00,  7.63it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.15it/s]
 69%|██████▉   | 9/13 [00:01<00:00,  8.50it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  8.75it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  6.30it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  5.51it/s]
100%|██████████| 13/13 [00:01<00:00,  6.99it/s]
 Test site-3| Test Acc: 0.5761 | Bacc: 0.5799
============ Train epoch 2 ============
0 0
cla loss:  2.9861093034696338 trans loss: 0.7994272367439078
0 0
cla loss:  2.943221929684356 trans loss: 0.7981857941977343
0 0
cla loss:  2.966109432766785 trans loss: 0.7951735536656787

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.44it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.74it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.71it/s]
 11%|█         | 4/36 [00:00<00:04,  6.68it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.61it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.73it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.74it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.70it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.77it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.77it/s]
 31%|███       | 11/36 [00:01<00:03,  6.85it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.75it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.73it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.70it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.53it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.62it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.60it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.65it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.64it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.67it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.71it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.76it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.85it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.64it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.53it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.53it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.37it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.57it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.50it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.49it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.38it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.38it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.43it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.42it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.55it/s]
100%|██████████| 36/36 [00:05<00:00,  6.61it/s]
100%|██████████| 36/36 [00:05<00:00,  6.62it/s]
 Site-0| Train Acc: 0.7726

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.77it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.75it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.84it/s]
100%|██████████| 4/4 [00:00<00:00,  6.88it/s]
100%|██████████| 4/4 [00:00<00:00,  6.84it/s]
 Site-0| Val  Acc: 0.6875

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.47it/s]
 20%|██        | 2/10 [00:00<00:01,  6.55it/s]
 30%|███       | 3/10 [00:00<00:01,  6.43it/s]
 40%|████      | 4/10 [00:00<00:00,  6.45it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.39it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.40it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.45it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.41it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.38it/s]
100%|██████████| 10/10 [00:01<00:00,  6.52it/s]
100%|██████████| 10/10 [00:01<00:00,  6.45it/s]
 Site-1| Train Acc: 0.7906

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.65it/s]
100%|██████████| 1/1 [00:00<00:00,  6.64it/s]
 Site-1| Val  Acc: 0.7500

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.45it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.53it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.45it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.51it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.52it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.60it/s]
 30%|███       | 7/23 [00:01<00:02,  6.34it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.50it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.60it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.62it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.69it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.37it/s]
 57%|█████▋    | 13/23 [00:02<00:01,  6.41it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.38it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.27it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.38it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.59it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.56it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.52it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.57it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.51it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.51it/s]
100%|██████████| 23/23 [00:03<00:00,  6.42it/s]
100%|██████████| 23/23 [00:03<00:00,  6.48it/s]
 Site-2| Train Acc: 0.7785

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.66it/s]
100%|██████████| 2/2 [00:00<00:00,  6.61it/s]
100%|██████████| 2/2 [00:00<00:00,  6.61it/s]
 Site-2| Val  Acc: 0.7656

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.30it/s]
 40%|████      | 2/5 [00:00<00:00,  6.67it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.19it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.43it/s]
100%|██████████| 5/5 [00:00<00:00,  6.93it/s]
 Test site-0| Test Acc: 0.8163 | Bacc: 0.8370

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.74it/s]
100%|██████████| 2/2 [00:00<00:00, 10.12it/s]
 Test site-1| Test Acc: 0.8095 | Bacc: 0.8217

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.80it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.65it/s]
100%|██████████| 3/3 [00:00<00:00,  6.69it/s]
100%|██████████| 3/3 [00:00<00:00,  6.69it/s]
 Test site-2| Test Acc: 0.7340 | Bacc: 0.7360

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.94it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.25it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.02it/s]
 31%|███       | 4/13 [00:00<00:01,  6.95it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.18it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.46it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.59it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.25it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.07it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  5.90it/s]
100%|██████████| 13/13 [00:01<00:00,  7.23it/s]
 Test site-3| Test Acc: 0.5888 | Bacc: 0.5848
============ Train epoch 3 ============
0 0
cla loss:  2.9081387747472256 trans loss: 0.7978126173043371
0 0
cla loss:  2.868118008177484 trans loss: 0.796183073340948
0 0
cla loss:  2.888854144206598 trans loss: 0.8004466352151267

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:04,  7.15it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.73it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.63it/s]
 11%|█         | 4/36 [00:00<00:04,  6.51it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.50it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.36it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.41it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.51it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.53it/s]
 28%|██▊       | 10/36 [00:01<00:04,  6.30it/s]
 31%|███       | 11/36 [00:01<00:04,  6.17it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.26it/s]
 36%|███▌      | 13/36 [00:02<00:03,  6.35it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.20it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.18it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.26it/s]
 47%|████▋     | 17/36 [00:02<00:03,  6.32it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.32it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.32it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.38it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.48it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.55it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.59it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.55it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.63it/s]
 72%|███████▏  | 26/36 [00:04<00:01,  6.71it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.69it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.70it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.45it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.44it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.68it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.61it/s]
 92%|█████████▏| 33/36 [00:05<00:00,  6.63it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.73it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.58it/s]
100%|██████████| 36/36 [00:05<00:00,  6.54it/s]
100%|██████████| 36/36 [00:05<00:00,  6.48it/s]
 Site-0| Train Acc: 0.8021

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.59it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.60it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.69it/s]
100%|██████████| 4/4 [00:00<00:00,  6.78it/s]
100%|██████████| 4/4 [00:00<00:00,  6.72it/s]
 Site-0| Val  Acc: 0.7344

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.49it/s]
 20%|██        | 2/10 [00:00<00:01,  6.57it/s]
 30%|███       | 3/10 [00:00<00:01,  6.64it/s]
 40%|████      | 4/10 [00:00<00:00,  6.68it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.51it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.60it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.71it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.70it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.56it/s]
100%|██████████| 10/10 [00:01<00:00,  6.66it/s]
100%|██████████| 10/10 [00:01<00:00,  6.63it/s]
 Site-1| Train Acc: 0.8094

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.78it/s]
100%|██████████| 1/1 [00:00<00:00,  6.76it/s]
 Site-1| Val  Acc: 0.7812

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.48it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.54it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.67it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.67it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.42it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.34it/s]
 30%|███       | 7/23 [00:01<00:02,  6.31it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.46it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.56it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.60it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.73it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.62it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.58it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.57it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.58it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.60it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.68it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.58it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.45it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.64it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.67it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.67it/s]
100%|██████████| 23/23 [00:03<00:00,  6.65it/s]
100%|██████████| 23/23 [00:03<00:00,  6.58it/s]
 Site-2| Train Acc: 0.8030

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.68it/s]
100%|██████████| 2/2 [00:00<00:00,  6.68it/s]
100%|██████████| 2/2 [00:00<00:00,  6.67it/s]
 Site-2| Val  Acc: 0.8125

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.09it/s]
 40%|████      | 2/5 [00:00<00:00,  6.61it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.06it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.21it/s]
100%|██████████| 5/5 [00:00<00:00,  6.85it/s]
 Test site-0| Test Acc: 0.8367 | Bacc: 0.8628

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.61it/s]
100%|██████████| 2/2 [00:00<00:00, 10.05it/s]
 Test site-1| Test Acc: 0.8333 | Bacc: 0.8409

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.46it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.50it/s]
100%|██████████| 3/3 [00:00<00:00,  6.53it/s]
100%|██████████| 3/3 [00:00<00:00,  6.52it/s]
 Test site-2| Test Acc: 0.7128 | Bacc: 0.7027

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.62it/s]
 15%|█▌        | 2/13 [00:00<00:01,  6.86it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.58it/s]
 31%|███       | 4/13 [00:00<00:01,  6.76it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.20it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.46it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.68it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.35it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.29it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.23it/s]
100%|██████████| 13/13 [00:01<00:00,  7.38it/s]
 Test site-3| Test Acc: 0.5964 | Bacc: 0.5873
============ Train epoch 4 ============
0 0
cla loss:  2.8643546643568643 trans loss: 0.8128921650162894
0 0
cla loss:  2.8245982285120976 trans loss: 0.7964222533019942
0 0
cla loss:  2.842916892401537 trans loss: 0.8100771221084211

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:04,  7.05it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.97it/s]
  8%|▊         | 3/36 [00:00<00:05,  6.43it/s]
 11%|█         | 4/36 [00:00<00:06,  4.74it/s]
 14%|█▍        | 5/36 [00:00<00:06,  5.12it/s]
 17%|█▋        | 6/36 [00:01<00:05,  5.60it/s]
 19%|█▉        | 7/36 [00:01<00:05,  5.75it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.06it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.12it/s]
 28%|██▊       | 10/36 [00:01<00:04,  6.16it/s]
 31%|███       | 11/36 [00:01<00:03,  6.32it/s]
 33%|███▎      | 12/36 [00:02<00:03,  6.30it/s]
 36%|███▌      | 13/36 [00:02<00:03,  6.48it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.48it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.56it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.58it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.50it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.58it/s]
 53%|█████▎    | 19/36 [00:03<00:02,  6.57it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.67it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.70it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.58it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.61it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.53it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.62it/s]
 72%|███████▏  | 26/36 [00:04<00:01,  6.82it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.79it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.69it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.57it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.48it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.64it/s]
 89%|████████▉ | 32/36 [00:05<00:00,  6.60it/s]
 92%|█████████▏| 33/36 [00:05<00:00,  6.68it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.66it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.67it/s]
100%|██████████| 36/36 [00:05<00:00,  6.60it/s]
100%|██████████| 36/36 [00:05<00:00,  6.41it/s]
 Site-0| Train Acc: 0.8134

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.66it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.61it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.56it/s]
100%|██████████| 4/4 [00:00<00:00,  6.64it/s]
100%|██████████| 4/4 [00:00<00:00,  6.62it/s]
 Site-0| Val  Acc: 0.7500

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  7.09it/s]
 20%|██        | 2/10 [00:00<00:01,  6.75it/s]
 30%|███       | 3/10 [00:00<00:01,  6.73it/s]
 40%|████      | 4/10 [00:00<00:00,  6.65it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.49it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.39it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.52it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.55it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.52it/s]
100%|██████████| 10/10 [00:01<00:00,  6.58it/s]
100%|██████████| 10/10 [00:01<00:00,  6.57it/s]
 Site-1| Train Acc: 0.8313

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.58it/s]
100%|██████████| 1/1 [00:00<00:00,  6.57it/s]
 Site-1| Val  Acc: 0.8125

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.24it/s]
  9%|▊         | 2/23 [00:00<00:03,  5.96it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.14it/s]
 17%|█▋        | 4/23 [00:00<00:03,  6.33it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.32it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.50it/s]
 30%|███       | 7/23 [00:01<00:02,  6.31it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.40it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.47it/s]
 43%|████▎     | 10/23 [00:01<00:02,  6.50it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.58it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.47it/s]
 57%|█████▋    | 13/23 [00:02<00:01,  6.50it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.62it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.62it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.62it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.71it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.67it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.32it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.35it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.43it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.55it/s]
100%|██████████| 23/23 [00:03<00:00,  6.56it/s]
100%|██████████| 23/23 [00:03<00:00,  6.47it/s]
 Site-2| Train Acc: 0.8234

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.42it/s]
100%|██████████| 2/2 [00:00<00:00,  6.50it/s]
100%|██████████| 2/2 [00:00<00:00,  6.48it/s]
 Site-2| Val  Acc: 0.8438

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.36it/s]
 40%|████      | 2/5 [00:00<00:00,  6.76it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.19it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.43it/s]
100%|██████████| 5/5 [00:00<00:00,  7.02it/s]
 Test site-0| Test Acc: 0.8367 | Bacc: 0.8634

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.35it/s]
100%|██████████| 2/2 [00:00<00:00,  9.68it/s]
 Test site-1| Test Acc: 0.8333 | Bacc: 0.8409

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.63it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.68it/s]
100%|██████████| 3/3 [00:00<00:00,  6.78it/s]
100%|██████████| 3/3 [00:00<00:00,  6.74it/s]
 Test site-2| Test Acc: 0.7553 | Bacc: 0.7410

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.02it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.32it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.19it/s]
 31%|███       | 4/13 [00:00<00:01,  7.13it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.47it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.65it/s]
 62%|██████▏   | 8/13 [00:00<00:00,  8.82it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.49it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.04it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  5.87it/s]
100%|██████████| 13/13 [00:01<00:00,  7.30it/s]
 Test site-3| Test Acc: 0.6193 | Bacc: 0.6148
============ Train epoch 5 ============
0 0
cla loss:  2.8258765115210758 trans loss: 0.8057055158830767
0 0
cla loss:  2.7916627876722635 trans loss: 0.8063360674297391
0 0
cla loss:  2.8086702164693094 trans loss: 0.7964593708215646

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:04,  7.07it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.92it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.73it/s]
 11%|█         | 4/36 [00:00<00:04,  6.82it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.92it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.90it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.83it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.81it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.99it/s]
 28%|██▊       | 10/36 [00:01<00:03,  7.02it/s]
 31%|███       | 11/36 [00:01<00:03,  6.99it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.92it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.94it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.83it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.73it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.72it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.66it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.67it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.63it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.54it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.49it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.39it/s]
 64%|██████▍   | 23/36 [00:03<00:02,  6.37it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.39it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.57it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.66it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.68it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.76it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.76it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.75it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.77it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.60it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.68it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.66it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.60it/s]
100%|██████████| 36/36 [00:05<00:00,  6.63it/s]
100%|██████████| 36/36 [00:05<00:00,  6.71it/s]
 Site-0| Train Acc: 0.8325

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.71it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.78it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.77it/s]
100%|██████████| 4/4 [00:00<00:00,  6.87it/s]
100%|██████████| 4/4 [00:00<00:00,  6.83it/s]
 Site-0| Val  Acc: 0.7734

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.44it/s]
 20%|██        | 2/10 [00:00<00:01,  6.82it/s]
 30%|███       | 3/10 [00:00<00:01,  6.70it/s]
 40%|████      | 4/10 [00:00<00:00,  6.77it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.91it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.66it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.58it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.68it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.61it/s]
100%|██████████| 10/10 [00:01<00:00,  6.63it/s]
100%|██████████| 10/10 [00:01<00:00,  6.67it/s]
 Site-1| Train Acc: 0.8344

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.98it/s]
100%|██████████| 1/1 [00:00<00:00,  6.96it/s]
 Site-1| Val  Acc: 0.8125

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.65it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.44it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.64it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.52it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.54it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.39it/s]
 30%|███       | 7/23 [00:01<00:02,  6.54it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.56it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.64it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.63it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.74it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.77it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.65it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.73it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.63it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.77it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.78it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.67it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.71it/s]
 87%|████████▋ | 20/23 [00:02<00:00,  6.86it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.83it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.64it/s]
100%|██████████| 23/23 [00:03<00:00,  6.66it/s]
100%|██████████| 23/23 [00:03<00:00,  6.66it/s]
 Site-2| Train Acc: 0.8383

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.70it/s]
100%|██████████| 2/2 [00:00<00:00,  6.64it/s]
100%|██████████| 2/2 [00:00<00:00,  6.64it/s]
 Site-2| Val  Acc: 0.8750

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.38it/s]
 40%|████      | 2/5 [00:00<00:00,  6.87it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.32it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.60it/s]
100%|██████████| 5/5 [00:00<00:00,  7.20it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8745

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.83it/s]
100%|██████████| 2/2 [00:00<00:00, 10.28it/s]
 Test site-1| Test Acc: 0.8333 | Bacc: 0.8409

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.85it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.79it/s]
100%|██████████| 3/3 [00:00<00:00,  6.88it/s]
100%|██████████| 3/3 [00:00<00:00,  6.85it/s]
 Test site-2| Test Acc: 0.7553 | Bacc: 0.7410

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.36it/s]
 15%|█▌        | 2/13 [00:00<00:01,  6.80it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.88it/s]
 31%|███       | 4/13 [00:00<00:01,  6.97it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.35it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.55it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.67it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.28it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.15it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.13it/s]
100%|██████████| 13/13 [00:01<00:00,  7.32it/s]
 Test site-3| Test Acc: 0.6345 | Bacc: 0.6288
============ Train epoch 6 ============
0 0
cla loss:  2.8023048872923733 trans loss: 0.8114569879057419
0 0
cla loss:  2.77150185743169 trans loss: 0.8124538637585377
0 0
cla loss:  2.7899305053691767 trans loss: 0.8115151048305645

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.68it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.57it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.66it/s]
 11%|█         | 4/36 [00:00<00:04,  6.59it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.46it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.45it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.49it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.58it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.50it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.50it/s]
 31%|███       | 11/36 [00:01<00:03,  6.42it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.50it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.61it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.67it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.66it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.67it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.65it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.72it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.70it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.57it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.60it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.49it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.56it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.51it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.50it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.52it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.55it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.67it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.67it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.64it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.62it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.64it/s]
 92%|█████████▏| 33/36 [00:05<00:00,  6.67it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.56it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.62it/s]
100%|██████████| 36/36 [00:05<00:00,  6.44it/s]
100%|██████████| 36/36 [00:05<00:00,  6.57it/s]
 Site-0| Train Acc: 0.8420

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.55it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.61it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.77it/s]
100%|██████████| 4/4 [00:00<00:00,  6.86it/s]
100%|██████████| 4/4 [00:00<00:00,  6.78it/s]
 Site-0| Val  Acc: 0.7734

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.79it/s]
 20%|██        | 2/10 [00:00<00:01,  6.50it/s]
 30%|███       | 3/10 [00:00<00:01,  6.61it/s]
 40%|████      | 4/10 [00:00<00:00,  6.73it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.76it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.57it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.57it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.55it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.60it/s]
100%|██████████| 10/10 [00:01<00:00,  6.67it/s]
100%|██████████| 10/10 [00:01<00:00,  6.63it/s]
 Site-1| Train Acc: 0.8531

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.85it/s]
100%|██████████| 1/1 [00:00<00:00,  6.84it/s]
 Site-1| Val  Acc: 0.8125

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.51it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.48it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.66it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.65it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.72it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.75it/s]
 30%|███       | 7/23 [00:01<00:02,  6.68it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.69it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.71it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.74it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.80it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.86it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.65it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.66it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.64it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.63it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.68it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.71it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.68it/s]
 87%|████████▋ | 20/23 [00:02<00:00,  6.74it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.63it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.42it/s]
100%|██████████| 23/23 [00:03<00:00,  6.48it/s]
100%|██████████| 23/23 [00:03<00:00,  6.65it/s]
 Site-2| Train Acc: 0.8465

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.64it/s]
100%|██████████| 2/2 [00:00<00:00,  6.40it/s]
100%|██████████| 2/2 [00:00<00:00,  6.42it/s]
 Site-2| Val  Acc: 0.8750

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.34it/s]
 40%|████      | 2/5 [00:00<00:00,  6.80it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.21it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.47it/s]
100%|██████████| 5/5 [00:00<00:00,  7.05it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8745

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.54it/s]
100%|██████████| 2/2 [00:00<00:00,  9.92it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.72it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.67it/s]
100%|██████████| 3/3 [00:00<00:00,  6.78it/s]
100%|██████████| 3/3 [00:00<00:00,  6.75it/s]
 Test site-2| Test Acc: 0.7766 | Bacc: 0.7599

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.76it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.21it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.07it/s]
 31%|███       | 4/13 [00:00<00:01,  7.06it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.42it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.64it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.76it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.40it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.25it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.24it/s]
100%|██████████| 13/13 [00:01<00:00,  7.48it/s]
 Test site-3| Test Acc: 0.6244 | Bacc: 0.6167
============ Train epoch 7 ============
0 0
cla loss:  2.7818501379022647 trans loss: 0.8020965942186327
0 0
cla loss:  2.748064745610683 trans loss: 0.8162258767602432
0 0
cla loss:  2.7648311835437562 trans loss: 0.8001103847470116

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.90it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.63it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.68it/s]
 11%|█         | 4/36 [00:00<00:04,  6.69it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.76it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.58it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.54it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.61it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.77it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.76it/s]
 31%|███       | 11/36 [00:01<00:03,  6.70it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.53it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.56it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.61it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.62it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.63it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.52it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.42it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.47it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.42it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.53it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.41it/s]
 64%|██████▍   | 23/36 [00:03<00:02,  6.45it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.50it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.57it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.56it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.68it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.49it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.47it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.62it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.45it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.53it/s]
 92%|█████████▏| 33/36 [00:05<00:00,  6.53it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.49it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.54it/s]
100%|██████████| 36/36 [00:05<00:00,  6.59it/s]
100%|██████████| 36/36 [00:05<00:00,  6.57it/s]
 Site-0| Train Acc: 0.8576

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.77it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.84it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.91it/s]
100%|██████████| 4/4 [00:00<00:00,  6.81it/s]
100%|██████████| 4/4 [00:00<00:00,  6.82it/s]
 Site-0| Val  Acc: 0.7812

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  7.06it/s]
 20%|██        | 2/10 [00:00<00:01,  6.84it/s]
 30%|███       | 3/10 [00:00<00:01,  6.91it/s]
 40%|████      | 4/10 [00:00<00:00,  6.84it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.72it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.76it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.59it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.39it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.50it/s]
100%|██████████| 10/10 [00:01<00:00,  6.59it/s]
100%|██████████| 10/10 [00:01<00:00,  6.65it/s]
 Site-1| Train Acc: 0.8719

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  7.10it/s]
100%|██████████| 1/1 [00:00<00:00,  7.08it/s]
 Site-1| Val  Acc: 0.8125

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.83it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.69it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.77it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.81it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.84it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.57it/s]
 30%|███       | 7/23 [00:01<00:02,  6.64it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.59it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.47it/s]
 43%|████▎     | 10/23 [00:01<00:02,  6.34it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.39it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.51it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.61it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.61it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.50it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.36it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.59it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.63it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.64it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.74it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.59it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.42it/s]
100%|██████████| 23/23 [00:03<00:00,  6.53it/s]
100%|██████████| 23/23 [00:03<00:00,  6.57it/s]
 Site-2| Train Acc: 0.8533

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.83it/s]
100%|██████████| 2/2 [00:00<00:00,  6.77it/s]
100%|██████████| 2/2 [00:00<00:00,  6.77it/s]
 Site-2| Val  Acc: 0.8906

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.35it/s]
 40%|████      | 2/5 [00:00<00:00,  6.78it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.11it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.42it/s]
100%|██████████| 5/5 [00:00<00:00,  7.04it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8747

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.89it/s]
100%|██████████| 2/2 [00:00<00:00, 10.41it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.88it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.84it/s]
100%|██████████| 3/3 [00:00<00:00,  6.93it/s]
100%|██████████| 3/3 [00:00<00:00,  6.91it/s]
 Test site-2| Test Acc: 0.7766 | Bacc: 0.7599

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.19it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.50it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.29it/s]
 31%|███       | 4/13 [00:00<00:01,  6.89it/s]
 38%|███▊      | 5/13 [00:00<00:01,  6.99it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.06it/s]
 54%|█████▍    | 7/13 [00:00<00:00,  7.65it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.15it/s]
 69%|██████▉   | 9/13 [00:01<00:00,  8.49it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  8.71it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  6.29it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  5.51it/s]
100%|██████████| 13/13 [00:01<00:00,  7.10it/s]
 Test site-3| Test Acc: 0.6371 | Bacc: 0.6309
============ Train epoch 8 ============
0 0
cla loss:  2.769173842578677 trans loss: 0.7946994583211352
0 0
cla loss:  2.737735164824443 trans loss: 0.8246380626855783
0 0
cla loss:  2.760131532822422 trans loss: 0.8218849996226517

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:04,  7.02it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.84it/s]
  8%|▊         | 3/36 [00:00<00:05,  6.51it/s]
 11%|█         | 4/36 [00:00<00:04,  6.48it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.40it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.45it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.31it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.44it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.54it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.67it/s]
 31%|███       | 11/36 [00:01<00:03,  6.65it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.56it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.62it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.48it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.50it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.50it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.54it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.57it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.58it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.65it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.71it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.75it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.66it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.64it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.65it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.67it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.43it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.10it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.29it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.37it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.41it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.35it/s]
 92%|█████████▏| 33/36 [00:05<00:00,  6.43it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.53it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.50it/s]
100%|██████████| 36/36 [00:05<00:00,  6.56it/s]
100%|██████████| 36/36 [00:05<00:00,  6.52it/s]
 Site-0| Train Acc: 0.8568

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.46it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.53it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.69it/s]
100%|██████████| 4/4 [00:00<00:00,  6.79it/s]
100%|██████████| 4/4 [00:00<00:00,  6.71it/s]
 Site-0| Val  Acc: 0.7812

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.70it/s]
 20%|██        | 2/10 [00:00<00:01,  6.27it/s]
 30%|███       | 3/10 [00:00<00:01,  6.35it/s]
 40%|████      | 4/10 [00:00<00:00,  6.22it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.13it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.34it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.54it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.44it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.50it/s]
100%|██████████| 10/10 [00:01<00:00,  6.44it/s]
100%|██████████| 10/10 [00:01<00:00,  6.39it/s]
 Site-1| Train Acc: 0.8594

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.88it/s]
100%|██████████| 1/1 [00:00<00:00,  6.86it/s]
 Site-1| Val  Acc: 0.8125

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.89it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.70it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.56it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.64it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.73it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.32it/s]
 30%|███       | 7/23 [00:01<00:02,  6.38it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.41it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.42it/s]
 43%|████▎     | 10/23 [00:01<00:02,  6.50it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.52it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.55it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.50it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.59it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.37it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.56it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.57it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.45it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.40it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.54it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.51it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.71it/s]
100%|██████████| 23/23 [00:03<00:00,  6.45it/s]
100%|██████████| 23/23 [00:03<00:00,  6.51it/s]
 Site-2| Train Acc: 0.8587

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.62it/s]
100%|██████████| 2/2 [00:00<00:00,  6.47it/s]
100%|██████████| 2/2 [00:00<00:00,  6.49it/s]
 Site-2| Val  Acc: 0.8750

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.07it/s]
 40%|████      | 2/5 [00:00<00:00,  6.60it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.10it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.26it/s]
100%|██████████| 5/5 [00:00<00:00,  6.84it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8688

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.58it/s]
100%|██████████| 2/2 [00:00<00:00,  9.91it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.52it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.13it/s]
100%|██████████| 3/3 [00:00<00:00,  6.40it/s]
100%|██████████| 3/3 [00:00<00:00,  6.36it/s]
 Test site-2| Test Acc: 0.7979 | Bacc: 0.7926

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.75it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.18it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.83it/s]
 31%|███       | 4/13 [00:00<00:01,  6.90it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.26it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.27it/s]
 54%|█████▍    | 7/13 [00:00<00:00,  7.79it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.28it/s]
 69%|██████▉   | 9/13 [00:01<00:00,  8.63it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  8.83it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  6.58it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  5.70it/s]
100%|██████████| 13/13 [00:01<00:00,  7.22it/s]
 Test site-3| Test Acc: 0.6345 | Bacc: 0.6289
============ Train epoch 9 ============
0 0
cla loss:  2.7602114976950025 trans loss: 0.8070261502385738
0 0
cla loss:  2.727293119957699 trans loss: 0.8140922997465085
0 0
cla loss:  2.7459324532417795 trans loss: 0.8198658341738447

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.97it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.78it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.62it/s]
 11%|█         | 4/36 [00:00<00:04,  6.64it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.69it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.71it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.67it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.66it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.51it/s]
 28%|██▊       | 10/36 [00:01<00:04,  6.34it/s]
 31%|███       | 11/36 [00:01<00:03,  6.57it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.48it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.44it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.57it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.53it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.57it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.65it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.68it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.78it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.64it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.82it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.81it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.77it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.80it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.72it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.54it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.61it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.66it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.74it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.83it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.78it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.78it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.87it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.96it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.88it/s]
100%|██████████| 36/36 [00:05<00:00,  6.85it/s]
100%|██████████| 36/36 [00:05<00:00,  6.69it/s]
 Site-0| Train Acc: 0.8568

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.80it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.72it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.79it/s]
100%|██████████| 4/4 [00:00<00:00,  6.84it/s]
100%|██████████| 4/4 [00:00<00:00,  6.81it/s]
 Site-0| Val  Acc: 0.7812

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.87it/s]
 20%|██        | 2/10 [00:00<00:01,  6.65it/s]
 30%|███       | 3/10 [00:00<00:01,  6.72it/s]
 40%|████      | 4/10 [00:00<00:00,  6.74it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.72it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.57it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.54it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.59it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.50it/s]
100%|██████████| 10/10 [00:01<00:00,  6.57it/s]
100%|██████████| 10/10 [00:01<00:00,  6.61it/s]
 Site-1| Train Acc: 0.8750

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.82it/s]
100%|██████████| 1/1 [00:00<00:00,  6.80it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.61it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.58it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.59it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.64it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.58it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.59it/s]
 30%|███       | 7/23 [00:01<00:02,  6.61it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.51it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.63it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.61it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.59it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.62it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.49it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.53it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.60it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.71it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.46it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.55it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.37it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.39it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.39it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.40it/s]
100%|██████████| 23/23 [00:03<00:00,  6.47it/s]
100%|██████████| 23/23 [00:03<00:00,  6.53it/s]
 Site-2| Train Acc: 0.8655

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.83it/s]
100%|██████████| 2/2 [00:00<00:00,  6.61it/s]
100%|██████████| 2/2 [00:00<00:00,  6.63it/s]
 Site-2| Val  Acc: 0.8906

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.12it/s]
 40%|████      | 2/5 [00:00<00:00,  6.69it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.13it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.43it/s]
100%|██████████| 5/5 [00:00<00:00,  6.99it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8688

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.69it/s]
100%|██████████| 2/2 [00:00<00:00, 10.04it/s]
 Test site-1| Test Acc: 0.8810 | Bacc: 0.8864

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.57it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.69it/s]
100%|██████████| 3/3 [00:00<00:00,  6.82it/s]
100%|██████████| 3/3 [00:00<00:00,  6.77it/s]
 Test site-2| Test Acc: 0.7979 | Bacc: 0.7805

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.24it/s]
 15%|█▌        | 2/13 [00:00<00:01,  6.50it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.67it/s]
 31%|███       | 4/13 [00:00<00:01,  6.80it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.23it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.50it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.67it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.34it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.15it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.13it/s]
100%|██████████| 13/13 [00:01<00:00,  7.30it/s]
 Test site-3| Test Acc: 0.6244 | Bacc: 0.6139
============ Train epoch 10 ============
0 0
cla loss:  2.7485889717562113 trans loss: 0.8093431753728857
0 0
cla loss:  2.7189523838273244 trans loss: 0.8065404026352581
0 0
cla loss:  2.7381027032382526 trans loss: 0.8159514737488637

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.73it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.76it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.67it/s]
 11%|█         | 4/36 [00:00<00:04,  6.63it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.78it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.75it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.64it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.53it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.56it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.63it/s]
 31%|███       | 11/36 [00:01<00:03,  6.71it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.79it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.88it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.92it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.89it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.88it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.88it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.78it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.77it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.92it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.98it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.99it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.84it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.80it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.77it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.76it/s]
 75%|███████▌  | 27/36 [00:03<00:01,  6.73it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.75it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.74it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.56it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.56it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.69it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.47it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.48it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.64it/s]
100%|██████████| 36/36 [00:05<00:00,  6.57it/s]
100%|██████████| 36/36 [00:05<00:00,  6.72it/s]
 Site-0| Train Acc: 0.8602

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.45it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.48it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.58it/s]
100%|██████████| 4/4 [00:00<00:00,  6.62it/s]
100%|██████████| 4/4 [00:00<00:00,  6.58it/s]
 Site-0| Val  Acc: 0.7812

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.62it/s]
 20%|██        | 2/10 [00:00<00:01,  6.88it/s]
 30%|███       | 3/10 [00:00<00:00,  7.02it/s]
 40%|████      | 4/10 [00:00<00:00,  6.86it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.63it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.76it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.91it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.88it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.91it/s]
100%|██████████| 10/10 [00:01<00:00,  6.81it/s]
100%|██████████| 10/10 [00:01<00:00,  6.83it/s]
 Site-1| Train Acc: 0.8750

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  7.10it/s]
100%|██████████| 1/1 [00:00<00:00,  7.08it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.85it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.81it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.81it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.80it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.60it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.68it/s]
 30%|███       | 7/23 [00:01<00:02,  6.77it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.75it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.73it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.70it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.76it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.60it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.45it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.64it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.72it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.50it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.62it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.46it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.62it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.58it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.61it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.60it/s]
100%|██████████| 23/23 [00:03<00:00,  6.49it/s]
100%|██████████| 23/23 [00:03<00:00,  6.62it/s]
 Site-2| Train Acc: 0.8668

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.63it/s]
100%|██████████| 2/2 [00:00<00:00,  6.62it/s]
100%|██████████| 2/2 [00:00<00:00,  6.61it/s]
 Site-2| Val  Acc: 0.8906

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.30it/s]
 40%|████      | 2/5 [00:00<00:00,  6.63it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.19it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.49it/s]
100%|██████████| 5/5 [00:00<00:00,  7.07it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8688

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.61it/s]
100%|██████████| 2/2 [00:00<00:00, 10.00it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.58it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.62it/s]
100%|██████████| 3/3 [00:00<00:00,  6.75it/s]
100%|██████████| 3/3 [00:00<00:00,  6.71it/s]
 Test site-2| Test Acc: 0.7979 | Bacc: 0.7805

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.05it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.21it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.09it/s]
 31%|███       | 4/13 [00:00<00:01,  7.10it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.42it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.62it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.73it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.33it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  6.96it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  5.84it/s]
100%|██████████| 13/13 [00:01<00:00,  7.24it/s]
 Test site-3| Test Acc: 0.6218 | Bacc: 0.6093
============ Train epoch 11 ============
0 0
cla loss:  2.748411792007523 trans loss: 0.7952251895588247
0 0
cla loss:  2.714984555939334 trans loss: 0.8249846987388841
0 0
cla loss:  2.732349256774289 trans loss: 0.8259026420176329

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.92it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.13it/s]
  8%|▊         | 3/36 [00:00<00:05,  6.19it/s]
 11%|█         | 4/36 [00:00<00:05,  6.33it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.38it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.46it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.37it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.63it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.58it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.70it/s]
 31%|███       | 11/36 [00:01<00:03,  6.49it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.50it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.60it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.73it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.60it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.62it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.63it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.45it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.52it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.50it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.52it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.56it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.62it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.45it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.63it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.60it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.47it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.43it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.63it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.60it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.69it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.72it/s]
 92%|█████████▏| 33/36 [00:05<00:00,  6.45it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.48it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.51it/s]
100%|██████████| 36/36 [00:05<00:00,  6.56it/s]
100%|██████████| 36/36 [00:05<00:00,  6.54it/s]
 Site-0| Train Acc: 0.8655

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.69it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.60it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.66it/s]
100%|██████████| 4/4 [00:00<00:00,  6.70it/s]
100%|██████████| 4/4 [00:00<00:00,  6.68it/s]
 Site-0| Val  Acc: 0.7812

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  5.38it/s]
 20%|██        | 2/10 [00:00<00:01,  6.12it/s]
 30%|███       | 3/10 [00:00<00:01,  6.01it/s]
 40%|████      | 4/10 [00:00<00:00,  6.07it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.16it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.38it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.43it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.19it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.14it/s]
100%|██████████| 10/10 [00:01<00:00,  6.06it/s]
100%|██████████| 10/10 [00:01<00:00,  6.12it/s]
 Site-1| Train Acc: 0.8812

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.59it/s]
100%|██████████| 1/1 [00:00<00:00,  6.57it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.34it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.54it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.40it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.34it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.14it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.07it/s]
 30%|███       | 7/23 [00:01<00:02,  6.22it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.24it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.32it/s]
 43%|████▎     | 10/23 [00:01<00:02,  6.27it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.26it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.27it/s]
 57%|█████▋    | 13/23 [00:02<00:01,  6.42it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.44it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.22it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.46it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.58it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.71it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.69it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.76it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.60it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.72it/s]
100%|██████████| 23/23 [00:03<00:00,  6.67it/s]
100%|██████████| 23/23 [00:03<00:00,  6.45it/s]
 Site-2| Train Acc: 0.8668

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.50it/s]
100%|██████████| 2/2 [00:00<00:00,  6.42it/s]
100%|██████████| 2/2 [00:00<00:00,  6.42it/s]
 Site-2| Val  Acc: 0.9219

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  5.81it/s]
 40%|████      | 2/5 [00:00<00:00,  6.38it/s]
 60%|██████    | 3/5 [00:00<00:00,  5.78it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.13it/s]
100%|██████████| 5/5 [00:00<00:00,  6.62it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8685

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.28it/s]
100%|██████████| 2/2 [00:00<00:00,  9.26it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  5.87it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.20it/s]
100%|██████████| 3/3 [00:00<00:00,  6.45it/s]
100%|██████████| 3/3 [00:00<00:00,  6.34it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7854

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.01it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.39it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.14it/s]
 31%|███       | 4/13 [00:00<00:01,  7.07it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.42it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.58it/s]
 54%|█████▍    | 7/13 [00:00<00:00,  8.15it/s]
 69%|██████▉   | 9/13 [00:01<00:00,  9.16it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.38it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.18it/s]
100%|██████████| 13/13 [00:01<00:00,  7.32it/s]
 Test site-3| Test Acc: 0.6269 | Bacc: 0.6145
============ Train epoch 12 ============
0 0
cla loss:  2.743273623624639 trans loss: 0.8202170570891107
0 0
cla loss:  2.7112857193204025 trans loss: 0.8172631500354365
0 0
cla loss:  2.7301872842874957 trans loss: 0.8099084436593942

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.23it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.26it/s]
  8%|▊         | 3/36 [00:00<00:05,  5.97it/s]
 11%|█         | 4/36 [00:00<00:05,  6.16it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.39it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.52it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.58it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.70it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.74it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.77it/s]
 31%|███       | 11/36 [00:01<00:03,  6.67it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.62it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.55it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.56it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.48it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.66it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.61it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.65it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.66it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.84it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.77it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.69it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.69it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.81it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.76it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.72it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.72it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.61it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.67it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.62it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.71it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.62it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.63it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.77it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.87it/s]
100%|██████████| 36/36 [00:05<00:00,  6.83it/s]
100%|██████████| 36/36 [00:05<00:00,  6.65it/s]
 Site-0| Train Acc: 0.8655

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.55it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.56it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.68it/s]
100%|██████████| 4/4 [00:00<00:00,  6.74it/s]
100%|██████████| 4/4 [00:00<00:00,  6.69it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.70it/s]
 20%|██        | 2/10 [00:00<00:01,  6.77it/s]
 30%|███       | 3/10 [00:00<00:01,  6.61it/s]
 40%|████      | 4/10 [00:00<00:00,  6.57it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.57it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.51it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.47it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.47it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.51it/s]
100%|██████████| 10/10 [00:01<00:00,  6.56it/s]
100%|██████████| 10/10 [00:01<00:00,  6.55it/s]
 Site-1| Train Acc: 0.8781

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.74it/s]
100%|██████████| 1/1 [00:00<00:00,  6.73it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.44it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.57it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.47it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.45it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.55it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.52it/s]
 30%|███       | 7/23 [00:01<00:02,  6.59it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.61it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.63it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.65it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.72it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.47it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.52it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.51it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.57it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.58it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.57it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.74it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.57it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.66it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.56it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.62it/s]
100%|██████████| 23/23 [00:03<00:00,  6.50it/s]
100%|██████████| 23/23 [00:03<00:00,  6.57it/s]
 Site-2| Train Acc: 0.8628

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.65it/s]
100%|██████████| 2/2 [00:00<00:00,  6.55it/s]
100%|██████████| 2/2 [00:00<00:00,  6.56it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.15it/s]
 40%|████      | 2/5 [00:00<00:00,  6.66it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.14it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.41it/s]
100%|██████████| 5/5 [00:00<00:00,  6.99it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8688

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.64it/s]
100%|██████████| 2/2 [00:00<00:00, 10.00it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.63it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.57it/s]
100%|██████████| 3/3 [00:00<00:00,  6.67it/s]
100%|██████████| 3/3 [00:00<00:00,  6.64it/s]
 Test site-2| Test Acc: 0.7979 | Bacc: 0.7805

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.02it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.32it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.08it/s]
 31%|███       | 4/13 [00:00<00:01,  6.98it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.29it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.49it/s]
 54%|█████▍    | 7/13 [00:00<00:00,  8.15it/s]
 69%|██████▉   | 9/13 [00:01<00:00,  9.05it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.29it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.31it/s]
100%|██████████| 13/13 [00:01<00:00,  7.36it/s]
 Test site-3| Test Acc: 0.6421 | Bacc: 0.6327
============ Train epoch 13 ============
0 0
cla loss:  2.737282207862816 trans loss: 0.8066931879101087
0 0
cla loss:  2.7051022484074885 trans loss: 0.8134405358352853
0 0
cla loss:  2.725331166281772 trans loss: 0.8129497449002673

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.18it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.12it/s]
  8%|▊         | 3/36 [00:00<00:05,  6.31it/s]
 11%|█         | 4/36 [00:00<00:04,  6.45it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.49it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.44it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.49it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.41it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.53it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.53it/s]
 31%|███       | 11/36 [00:01<00:03,  6.63it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.57it/s]
 36%|███▌      | 13/36 [00:02<00:03,  6.55it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.60it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.47it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.54it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.44it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.44it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.45it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.43it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.30it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.25it/s]
 64%|██████▍   | 23/36 [00:03<00:02,  6.37it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.46it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.52it/s]
 72%|███████▏  | 26/36 [00:04<00:01,  6.66it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.72it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.65it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.66it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.77it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.79it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.81it/s]
 92%|█████████▏| 33/36 [00:05<00:00,  6.87it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.91it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.75it/s]
100%|██████████| 36/36 [00:05<00:00,  6.60it/s]
100%|██████████| 36/36 [00:05<00:00,  6.55it/s]
 Site-0| Train Acc: 0.8655

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.59it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.58it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.65it/s]
100%|██████████| 4/4 [00:00<00:00,  6.70it/s]
100%|██████████| 4/4 [00:00<00:00,  6.67it/s]
 Site-0| Val  Acc: 0.7812

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.63it/s]
 20%|██        | 2/10 [00:00<00:01,  6.73it/s]
 30%|███       | 3/10 [00:00<00:01,  6.74it/s]
 40%|████      | 4/10 [00:00<00:00,  6.70it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.70it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.57it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.55it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.60it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.55it/s]
100%|██████████| 10/10 [00:01<00:00,  6.53it/s]
100%|██████████| 10/10 [00:01<00:00,  6.59it/s]
 Site-1| Train Acc: 0.8781

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.81it/s]
100%|██████████| 1/1 [00:00<00:00,  6.79it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.57it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.64it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.75it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.66it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.35it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.46it/s]
 30%|███       | 7/23 [00:01<00:02,  6.55it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.54it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.45it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.56it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.39it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.33it/s]
 57%|█████▋    | 13/23 [00:02<00:01,  6.36it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.53it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.68it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.72it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.65it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.63it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.61it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.63it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.58it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.57it/s]
100%|██████████| 23/23 [00:03<00:00,  6.62it/s]
100%|██████████| 23/23 [00:03<00:00,  6.56it/s]
 Site-2| Train Acc: 0.8682

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.68it/s]
100%|██████████| 2/2 [00:00<00:00,  6.58it/s]
100%|██████████| 2/2 [00:00<00:00,  6.59it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.22it/s]
 40%|████      | 2/5 [00:00<00:00,  6.69it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.16it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.41it/s]
100%|██████████| 5/5 [00:00<00:00,  7.00it/s]
 Test site-0| Test Acc: 0.8367 | Bacc: 0.8628

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.63it/s]
100%|██████████| 2/2 [00:00<00:00, 10.00it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.64it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.56it/s]
100%|██████████| 3/3 [00:00<00:00,  6.67it/s]
100%|██████████| 3/3 [00:00<00:00,  6.64it/s]
 Test site-2| Test Acc: 0.7766 | Bacc: 0.7627

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.04it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.32it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.96it/s]
 31%|███       | 4/13 [00:00<00:01,  7.03it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.36it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.61it/s]
 54%|█████▍    | 7/13 [00:00<00:00,  8.14it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.55it/s]
 69%|██████▉   | 9/13 [00:01<00:00,  8.82it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.02it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  6.29it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  5.35it/s]
100%|██████████| 13/13 [00:01<00:00,  7.14it/s]
 Test site-3| Test Acc: 0.6193 | Bacc: 0.6044
============ Train epoch 14 ============
0 0
cla loss:  2.736596938952729 trans loss: 0.8139295332395851
0 0
cla loss:  2.7016480951452975 trans loss: 0.8155049388133102
0 0
cla loss:  2.7196977054653457 trans loss: 0.8076451082325461

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.48it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.77it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.67it/s]
 11%|█         | 4/36 [00:00<00:04,  6.66it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.54it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.74it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.55it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.63it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.60it/s]
 28%|██▊       | 10/36 [00:01<00:04,  6.46it/s]
 31%|███       | 11/36 [00:01<00:03,  6.41it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.47it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.46it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.57it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.40it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.45it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.56it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.58it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.62it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.59it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.68it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.62it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.70it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.44it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.45it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.62it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.62it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.60it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.73it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.77it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.82it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.94it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.89it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.68it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.58it/s]
100%|██████████| 36/36 [00:05<00:00,  6.62it/s]
100%|██████████| 36/36 [00:05<00:00,  6.61it/s]
 Site-0| Train Acc: 0.8689

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.20it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.48it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.57it/s]
100%|██████████| 4/4 [00:00<00:00,  6.69it/s]
100%|██████████| 4/4 [00:00<00:00,  6.60it/s]
 Site-0| Val  Acc: 0.7812

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.66it/s]
 20%|██        | 2/10 [00:00<00:01,  6.62it/s]
 30%|███       | 3/10 [00:00<00:01,  6.49it/s]
 40%|████      | 4/10 [00:00<00:00,  6.39it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.56it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.51it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.56it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.57it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.59it/s]
100%|██████████| 10/10 [00:01<00:00,  6.71it/s]
100%|██████████| 10/10 [00:01<00:00,  6.59it/s]
 Site-1| Train Acc: 0.8750

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.96it/s]
100%|██████████| 1/1 [00:00<00:00,  6.94it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.74it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.49it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.23it/s]
 17%|█▋        | 4/23 [00:00<00:03,  6.28it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.44it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.62it/s]
 30%|███       | 7/23 [00:01<00:02,  6.65it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.42it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.27it/s]
 43%|████▎     | 10/23 [00:01<00:02,  6.41it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.41it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.47it/s]
 57%|█████▋    | 13/23 [00:02<00:01,  6.68it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.66it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.71it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.60it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.58it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.60it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.66it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.69it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.66it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.63it/s]
100%|██████████| 23/23 [00:03<00:00,  6.62it/s]
100%|██████████| 23/23 [00:03<00:00,  6.55it/s]
 Site-2| Train Acc: 0.8682

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.88it/s]
100%|██████████| 2/2 [00:00<00:00,  6.72it/s]
100%|██████████| 2/2 [00:00<00:00,  6.73it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.16it/s]
 40%|████      | 2/5 [00:00<00:00,  6.44it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.08it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.19it/s]
100%|██████████| 5/5 [00:00<00:00,  6.84it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8688

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.65it/s]
100%|██████████| 2/2 [00:00<00:00, 10.10it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.58it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.54it/s]
100%|██████████| 3/3 [00:00<00:00,  6.65it/s]
100%|██████████| 3/3 [00:00<00:00,  6.62it/s]
 Test site-2| Test Acc: 0.7979 | Bacc: 0.8081

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.99it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.34it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.13it/s]
 31%|███       | 4/13 [00:00<00:01,  6.95it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.00it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.04it/s]
 54%|█████▍    | 7/13 [00:00<00:00,  7.62it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.09it/s]
 69%|██████▉   | 9/13 [00:01<00:00,  8.49it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  8.70it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  6.23it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  5.28it/s]
100%|██████████| 13/13 [00:01<00:00,  6.94it/s]
 Test site-3| Test Acc: 0.6218 | Bacc: 0.6090
============ Train epoch 15 ============
0 0
cla loss:  2.7352163396289 trans loss: 0.8138494638342354
0 0
cla loss:  2.7035574984909903 trans loss: 0.8220197956765717
0 0
cla loss:  2.718898553944113 trans loss: 0.8159650860719345

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:04,  7.16it/s]
  6%|▌         | 2/36 [00:00<00:04,  7.08it/s]
  8%|▊         | 3/36 [00:00<00:04,  7.04it/s]
 11%|█         | 4/36 [00:00<00:04,  6.96it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.83it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.92it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.83it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.76it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.80it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.82it/s]
 31%|███       | 11/36 [00:01<00:03,  6.76it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.71it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.79it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.72it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.66it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.62it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.61it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.62it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.60it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.61it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.64it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.69it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.67it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.68it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.71it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.76it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.69it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.65it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.70it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.67it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.69it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.70it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.73it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.76it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.86it/s]
100%|██████████| 36/36 [00:05<00:00,  6.85it/s]
100%|██████████| 36/36 [00:05<00:00,  6.75it/s]
 Site-0| Train Acc: 0.8681

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.83it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.83it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.84it/s]
100%|██████████| 4/4 [00:00<00:00,  6.90it/s]
100%|██████████| 4/4 [00:00<00:00,  6.87it/s]
 Site-0| Val  Acc: 0.8047

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.77it/s]
 20%|██        | 2/10 [00:00<00:01,  6.53it/s]
 30%|███       | 3/10 [00:00<00:01,  6.65it/s]
 40%|████      | 4/10 [00:00<00:00,  6.81it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.46it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.52it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.62it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.60it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.72it/s]
100%|██████████| 10/10 [00:01<00:00,  6.68it/s]
100%|██████████| 10/10 [00:01<00:00,  6.64it/s]
 Site-1| Train Acc: 0.8781

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  7.07it/s]
100%|██████████| 1/1 [00:00<00:00,  7.05it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.53it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.09it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.43it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.55it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.65it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.69it/s]
 30%|███       | 7/23 [00:01<00:02,  6.71it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.80it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.61it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.58it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.56it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.71it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.63it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.62it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.60it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.76it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.71it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.68it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.43it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.53it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.43it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.60it/s]
100%|██████████| 23/23 [00:03<00:00,  6.51it/s]
100%|██████████| 23/23 [00:03<00:00,  6.59it/s]
 Site-2| Train Acc: 0.8709

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.24it/s]
100%|██████████| 2/2 [00:00<00:00,  6.07it/s]
100%|██████████| 2/2 [00:00<00:00,  6.09it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.15it/s]
 40%|████      | 2/5 [00:00<00:00,  6.64it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.12it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.33it/s]
100%|██████████| 5/5 [00:00<00:00,  6.93it/s]
 Test site-0| Test Acc: 0.8367 | Bacc: 0.8628

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.73it/s]
100%|██████████| 2/2 [00:00<00:00, 10.10it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.71it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.65it/s]
100%|██████████| 3/3 [00:00<00:00,  6.76it/s]
100%|██████████| 3/3 [00:00<00:00,  6.73it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7716

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.99it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.29it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.78it/s]
 31%|███       | 4/13 [00:00<00:01,  6.53it/s]
 38%|███▊      | 5/13 [00:00<00:01,  6.98it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.30it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.53it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.16it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.06it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  5.96it/s]
100%|██████████| 13/13 [00:01<00:00,  7.21it/s]
 Test site-3| Test Acc: 0.6294 | Bacc: 0.6141
============ Train epoch 16 ============
0 0
cla loss:  2.7342624532517474 trans loss: 0.808858388931907
0 0
cla loss:  2.6968834112637006 trans loss: 0.8111881562812844
0 0
cla loss:  2.7178772274573246 trans loss: 0.8180957086122216

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.81it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.93it/s]
  8%|▊         | 3/36 [00:00<00:04,  7.05it/s]
 11%|█         | 4/36 [00:00<00:04,  6.89it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.84it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.92it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.66it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.70it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.60it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.62it/s]
 31%|███       | 11/36 [00:01<00:03,  6.71it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.73it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.75it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.73it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.70it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.61it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.43it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.52it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.59it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.58it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.71it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.50it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.50it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.60it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.58it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.67it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.62it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.53it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.49it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.50it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.53it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.55it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.68it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.59it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.57it/s]
100%|██████████| 36/36 [00:05<00:00,  6.57it/s]
100%|██████████| 36/36 [00:05<00:00,  6.63it/s]
 Site-0| Train Acc: 0.8689

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.57it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.61it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.59it/s]
100%|██████████| 4/4 [00:00<00:00,  6.74it/s]
100%|██████████| 4/4 [00:00<00:00,  6.68it/s]
 Site-0| Val  Acc: 0.8047

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.74it/s]
 20%|██        | 2/10 [00:00<00:01,  6.60it/s]
 30%|███       | 3/10 [00:00<00:01,  6.62it/s]
 40%|████      | 4/10 [00:00<00:00,  6.55it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.50it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.55it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.57it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.53it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.56it/s]
100%|██████████| 10/10 [00:01<00:00,  6.62it/s]
100%|██████████| 10/10 [00:01<00:00,  6.58it/s]
 Site-1| Train Acc: 0.8844

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.83it/s]
100%|██████████| 1/1 [00:00<00:00,  6.81it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.69it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.90it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.96it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.76it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.65it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.61it/s]
 30%|███       | 7/23 [00:01<00:02,  6.58it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.77it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.78it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.75it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.65it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.46it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.53it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.58it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.70it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.78it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.68it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.76it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.66it/s]
 87%|████████▋ | 20/23 [00:02<00:00,  6.65it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.35it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.35it/s]
100%|██████████| 23/23 [00:03<00:00,  6.39it/s]
100%|██████████| 23/23 [00:03<00:00,  6.61it/s]
 Site-2| Train Acc: 0.8709

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.61it/s]
100%|██████████| 2/2 [00:00<00:00,  6.48it/s]
100%|██████████| 2/2 [00:00<00:00,  6.49it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.12it/s]
 40%|████      | 2/5 [00:00<00:00,  6.60it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.11it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.39it/s]
100%|██████████| 5/5 [00:00<00:00,  6.97it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8685

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.61it/s]
100%|██████████| 2/2 [00:00<00:00,  9.97it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.55it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.49it/s]
100%|██████████| 3/3 [00:00<00:00,  6.60it/s]
100%|██████████| 3/3 [00:00<00:00,  6.57it/s]
 Test site-2| Test Acc: 0.7979 | Bacc: 0.7943

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.97it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.28it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.06it/s]
 31%|███       | 4/13 [00:00<00:01,  7.02it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.39it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.59it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.73it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.36it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.19it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.09it/s]
100%|██████████| 13/13 [00:01<00:00,  7.37it/s]
 Test site-3| Test Acc: 0.6269 | Bacc: 0.6119
============ Train epoch 17 ============
0 0
cla loss:  2.732182345797668 trans loss: 0.8204369550973327
0 0
cla loss:  2.7023176164483305 trans loss: 0.8172431660057912
0 0
cla loss:  2.712664985177505 trans loss: 0.7985070464599072

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.21it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.48it/s]
  8%|▊         | 3/36 [00:00<00:05,  6.44it/s]
 11%|█         | 4/36 [00:00<00:04,  6.45it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.51it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.58it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.48it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.71it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.71it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.67it/s]
 31%|███       | 11/36 [00:01<00:03,  6.61it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.71it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.45it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.40it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.44it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.46it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.55it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.61it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.47it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.40it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.44it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.50it/s]
 64%|██████▍   | 23/36 [00:03<00:02,  6.47it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.54it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.71it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.75it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.64it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.54it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.52it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.60it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.63it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.61it/s]
 92%|█████████▏| 33/36 [00:05<00:00,  6.67it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.64it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.64it/s]
100%|██████████| 36/36 [00:05<00:00,  6.65it/s]
100%|██████████| 36/36 [00:05<00:00,  6.56it/s]
 Site-0| Train Acc: 0.8689

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.58it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.57it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.64it/s]
100%|██████████| 4/4 [00:00<00:00,  6.56it/s]
100%|██████████| 4/4 [00:00<00:00,  6.58it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.06it/s]
 20%|██        | 2/10 [00:00<00:01,  6.25it/s]
 30%|███       | 3/10 [00:00<00:01,  6.41it/s]
 40%|████      | 4/10 [00:00<00:00,  6.54it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.60it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.65it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.48it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.53it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.57it/s]
100%|██████████| 10/10 [00:01<00:00,  6.53it/s]
100%|██████████| 10/10 [00:01<00:00,  6.51it/s]
 Site-1| Train Acc: 0.8812

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.78it/s]
100%|██████████| 1/1 [00:00<00:00,  6.76it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.77it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.71it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.55it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.52it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.36it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.52it/s]
 30%|███       | 7/23 [00:01<00:02,  6.63it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.62it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.64it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.76it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.73it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.56it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.53it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.57it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.62it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.44it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.48it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.62it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.38it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.45it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.31it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.41it/s]
100%|██████████| 23/23 [00:03<00:00,  6.45it/s]
100%|██████████| 23/23 [00:03<00:00,  6.53it/s]
 Site-2| Train Acc: 0.8668

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.60it/s]
100%|██████████| 2/2 [00:00<00:00,  6.48it/s]
100%|██████████| 2/2 [00:00<00:00,  6.49it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.13it/s]
 40%|████      | 2/5 [00:00<00:00,  6.62it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.10it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.36it/s]
100%|██████████| 5/5 [00:00<00:00,  6.93it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8685

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.58it/s]
100%|██████████| 2/2 [00:00<00:00,  9.93it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.57it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.53it/s]
100%|██████████| 3/3 [00:00<00:00,  6.40it/s]
100%|██████████| 3/3 [00:00<00:00,  6.43it/s]
 Test site-2| Test Acc: 0.7766 | Bacc: 0.7627

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.42it/s]
 15%|█▌        | 2/13 [00:00<00:01,  6.93it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.88it/s]
 31%|███       | 4/13 [00:00<00:01,  6.92it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.30it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.55it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.72it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.37it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.18it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.11it/s]
100%|██████████| 13/13 [00:01<00:00,  7.36it/s]
 Test site-3| Test Acc: 0.6269 | Bacc: 0.6116
============ Train epoch 18 ============
0 0
cla loss:  2.725871890034508 trans loss: 0.8020336508151874
0 0
cla loss:  2.6995736258712846 trans loss: 0.8218643350816851
0 0
cla loss:  2.7113582596706984 trans loss: 0.8082628798245186

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:04,  7.01it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.97it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.94it/s]
 11%|█         | 4/36 [00:00<00:04,  6.74it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.82it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.81it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.83it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.76it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.77it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.73it/s]
 31%|███       | 11/36 [00:01<00:03,  6.78it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.88it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.87it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.95it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.97it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.90it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.90it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.87it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.94it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.82it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.82it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.72it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.68it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.83it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.74it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.73it/s]
 75%|███████▌  | 27/36 [00:03<00:01,  6.67it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.58it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.62it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.69it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.59it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.60it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.53it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.57it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.60it/s]
100%|██████████| 36/36 [00:05<00:00,  6.52it/s]
100%|██████████| 36/36 [00:05<00:00,  6.74it/s]
 Site-0| Train Acc: 0.8724

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.79it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.82it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.90it/s]
100%|██████████| 4/4 [00:00<00:00,  6.88it/s]
100%|██████████| 4/4 [00:00<00:00,  6.86it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  7.09it/s]
 20%|██        | 2/10 [00:00<00:01,  6.79it/s]
 30%|███       | 3/10 [00:00<00:01,  6.74it/s]
 40%|████      | 4/10 [00:00<00:00,  6.68it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.63it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.77it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.89it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.70it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.76it/s]
100%|██████████| 10/10 [00:01<00:00,  6.79it/s]
100%|██████████| 10/10 [00:01<00:00,  6.77it/s]
 Site-1| Train Acc: 0.8781

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  7.00it/s]
100%|██████████| 1/1 [00:00<00:00,  6.98it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.45it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.60it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.61it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.75it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.76it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.74it/s]
 30%|███       | 7/23 [00:01<00:02,  6.88it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.88it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.95it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.94it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.91it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.75it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.53it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.64it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.74it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.77it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.92it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  7.00it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  7.01it/s]
 87%|████████▋ | 20/23 [00:02<00:00,  6.87it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.76it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.47it/s]
100%|██████████| 23/23 [00:03<00:00,  6.54it/s]
100%|██████████| 23/23 [00:03<00:00,  6.74it/s]
 Site-2| Train Acc: 0.8668

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.86it/s]
100%|██████████| 2/2 [00:00<00:00,  6.82it/s]
100%|██████████| 2/2 [00:00<00:00,  6.81it/s]
 Site-2| Val  Acc: 0.8906

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.42it/s]
 40%|████      | 2/5 [00:00<00:00,  6.69it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.25it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.56it/s]
100%|██████████| 5/5 [00:00<00:00,  7.15it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8688

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.87it/s]
100%|██████████| 2/2 [00:00<00:00, 10.35it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.88it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.81it/s]
100%|██████████| 3/3 [00:00<00:00,  6.91it/s]
100%|██████████| 3/3 [00:00<00:00,  6.88it/s]
 Test site-2| Test Acc: 0.8085 | Bacc: 0.8170

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.18it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.41it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.21it/s]
 31%|███       | 4/13 [00:00<00:01,  7.19it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.53it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.72it/s]
 62%|██████▏   | 8/13 [00:00<00:00,  8.86it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.47it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.30it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.24it/s]
100%|██████████| 13/13 [00:01<00:00,  7.56it/s]
 Test site-3| Test Acc: 0.6396 | Bacc: 0.6305
============ Train epoch 19 ============
0 0
cla loss:  2.7222957635045653 trans loss: 0.8004473238135102
0 0
cla loss:  2.6996341961712096 trans loss: 0.8233844155642256
0 0
cla loss:  2.7179708193294965 trans loss: 0.8259820737431397

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:04,  7.03it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.76it/s]
  8%|▊         | 3/36 [00:00<00:05,  6.56it/s]
 11%|█         | 4/36 [00:00<00:05,  6.34it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.45it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.53it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.61it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.68it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.70it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.64it/s]
 31%|███       | 11/36 [00:01<00:03,  6.67it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.70it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.60it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.61it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.61it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.69it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.68it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.62it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.77it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.85it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.84it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.94it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.95it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.89it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.97it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.87it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.82it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.76it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.71it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.60it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.60it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.64it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.58it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.65it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.73it/s]
100%|██████████| 36/36 [00:05<00:00,  6.75it/s]
100%|██████████| 36/36 [00:05<00:00,  6.70it/s]
 Site-0| Train Acc: 0.8672

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.60it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.61it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.70it/s]
100%|██████████| 4/4 [00:00<00:00,  6.76it/s]
100%|██████████| 4/4 [00:00<00:00,  6.71it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.29it/s]
 20%|██        | 2/10 [00:00<00:01,  6.41it/s]
 30%|███       | 3/10 [00:00<00:01,  6.64it/s]
 40%|████      | 4/10 [00:00<00:00,  6.70it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.70it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.69it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.72it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.69it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.76it/s]
100%|██████████| 10/10 [00:01<00:00,  6.71it/s]
100%|██████████| 10/10 [00:01<00:00,  6.67it/s]
 Site-1| Train Acc: 0.8812

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.99it/s]
100%|██████████| 1/1 [00:00<00:00,  6.97it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.91it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.74it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.70it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.52it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.67it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.68it/s]
 30%|███       | 7/23 [00:01<00:02,  6.72it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.57it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.61it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.72it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.62it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.56it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.57it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.33it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.55it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.56it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.68it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.68it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.66it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.59it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.72it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.69it/s]
100%|██████████| 23/23 [00:03<00:00,  6.73it/s]
100%|██████████| 23/23 [00:03<00:00,  6.64it/s]
 Site-2| Train Acc: 0.8736

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.77it/s]
100%|██████████| 2/2 [00:00<00:00,  6.61it/s]
100%|██████████| 2/2 [00:00<00:00,  6.62it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.33it/s]
 40%|████      | 2/5 [00:00<00:00,  6.82it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.16it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.44it/s]
100%|██████████| 5/5 [00:00<00:00,  7.07it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8685

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.68it/s]
100%|██████████| 2/2 [00:00<00:00, 10.07it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.67it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.65it/s]
100%|██████████| 3/3 [00:00<00:00,  6.44it/s]
100%|██████████| 3/3 [00:00<00:00,  6.49it/s]
 Test site-2| Test Acc: 0.7766 | Bacc: 0.7627

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.95it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.29it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.09it/s]
 31%|███       | 4/13 [00:00<00:01,  7.06it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.41it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.60it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.69it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.31it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.16it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.09it/s]
100%|██████████| 13/13 [00:01<00:00,  7.40it/s]
 Test site-3| Test Acc: 0.6320 | Bacc: 0.6195
============ Train epoch 20 ============
0 0
cla loss:  2.733085080007812 trans loss: 0.8184424713628375
0 0
cla loss:  2.6943238991588805 trans loss: 0.8084758343409054
0 0
cla loss:  2.7137524446650367 trans loss: 0.8203810087999507

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.58it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.59it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.74it/s]
 11%|█         | 4/36 [00:00<00:04,  6.69it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.65it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.63it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.70it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.74it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.72it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.63it/s]
 31%|███       | 11/36 [00:01<00:03,  6.45it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.36it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.55it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.71it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.71it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.68it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.52it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.55it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.67it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.75it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.63it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.74it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.62it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.66it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.59it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.59it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.61it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.59it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.65it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.69it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.58it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.55it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.50it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.54it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.61it/s]
100%|██████████| 36/36 [00:05<00:00,  6.64it/s]
100%|██████████| 36/36 [00:05<00:00,  6.62it/s]
 Site-0| Train Acc: 0.8715

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.60it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.62it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.77it/s]
100%|██████████| 4/4 [00:00<00:00,  6.85it/s]
100%|██████████| 4/4 [00:00<00:00,  6.78it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  7.19it/s]
 20%|██        | 2/10 [00:00<00:01,  6.66it/s]
 30%|███       | 3/10 [00:00<00:01,  6.72it/s]
 40%|████      | 4/10 [00:00<00:00,  6.72it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.62it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.63it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.57it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.47it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.65it/s]
100%|██████████| 10/10 [00:01<00:00,  6.63it/s]
100%|██████████| 10/10 [00:01<00:00,  6.64it/s]
 Site-1| Train Acc: 0.8719

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  7.03it/s]
100%|██████████| 1/1 [00:00<00:00,  7.01it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  5.96it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.59it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.73it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.72it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.61it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.35it/s]
 30%|███       | 7/23 [00:01<00:02,  6.30it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.36it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.21it/s]
 43%|████▎     | 10/23 [00:01<00:02,  6.29it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.43it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.50it/s]
 57%|█████▋    | 13/23 [00:02<00:01,  6.50it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.40it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.48it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.52it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.68it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.58it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.62it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.69it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.72it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.70it/s]
100%|██████████| 23/23 [00:03<00:00,  6.75it/s]
100%|██████████| 23/23 [00:03<00:00,  6.54it/s]
 Site-2| Train Acc: 0.8682

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.89it/s]
100%|██████████| 2/2 [00:00<00:00,  6.77it/s]
100%|██████████| 2/2 [00:00<00:00,  6.78it/s]
 Site-2| Val  Acc: 0.8906

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.37it/s]
 40%|████      | 2/5 [00:00<00:00,  6.88it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.34it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.63it/s]
100%|██████████| 5/5 [00:00<00:00,  7.23it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8685

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.88it/s]
100%|██████████| 2/2 [00:00<00:00, 10.37it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.90it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.40it/s]
100%|██████████| 3/3 [00:00<00:00,  6.66it/s]
100%|██████████| 3/3 [00:00<00:00,  6.63it/s]
 Test site-2| Test Acc: 0.8085 | Bacc: 0.8170

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.20it/s]
 15%|█▌        | 2/13 [00:00<00:01,  6.53it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.41it/s]
 31%|███       | 4/13 [00:00<00:01,  6.68it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.15it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.46it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.71it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.38it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.24it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.09it/s]
100%|██████████| 13/13 [00:01<00:00,  7.24it/s]
 Test site-3| Test Acc: 0.6345 | Bacc: 0.6220
============ Train epoch 21 ============
0 0
cla loss:  2.725824104481606 trans loss: 0.8077057453256157
0 0
cla loss:  2.6938112429038963 trans loss: 0.8308774694126455
0 0
cla loss:  2.7154138735191307 trans loss: 0.8138252517685818

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.90it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.91it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.79it/s]
 11%|█         | 4/36 [00:00<00:04,  6.58it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.60it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.53it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.58it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.66it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.56it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.58it/s]
 31%|███       | 11/36 [00:01<00:03,  6.53it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.56it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.49it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.41it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.40it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.50it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.51it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.58it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.42it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.57it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.64it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.54it/s]
 64%|██████▍   | 23/36 [00:03<00:02,  6.50it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.63it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.68it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.74it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.69it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.84it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.81it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.80it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.58it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.60it/s]
 92%|█████████▏| 33/36 [00:05<00:00,  6.56it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.54it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.48it/s]
100%|██████████| 36/36 [00:05<00:00,  6.46it/s]
100%|██████████| 36/36 [00:05<00:00,  6.58it/s]
 Site-0| Train Acc: 0.8715

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.19it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.22it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.51it/s]
100%|██████████| 4/4 [00:00<00:00,  6.52it/s]
100%|██████████| 4/4 [00:00<00:00,  6.45it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.85it/s]
 20%|██        | 2/10 [00:00<00:01,  6.66it/s]
 30%|███       | 3/10 [00:00<00:01,  6.64it/s]
 40%|████      | 4/10 [00:00<00:00,  6.60it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.64it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.50it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.44it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.46it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.58it/s]
100%|██████████| 10/10 [00:01<00:00,  6.52it/s]
100%|██████████| 10/10 [00:01<00:00,  6.55it/s]
 Site-1| Train Acc: 0.8656

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.36it/s]
100%|██████████| 1/1 [00:00<00:00,  6.35it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.47it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.41it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.56it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.55it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.56it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.61it/s]
 30%|███       | 7/23 [00:01<00:02,  6.68it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.79it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.89it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.73it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.63it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.63it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.64it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.50it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.54it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.36it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.51it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.63it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.62it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.41it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.42it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.53it/s]
100%|██████████| 23/23 [00:03<00:00,  6.44it/s]
100%|██████████| 23/23 [00:03<00:00,  6.56it/s]
 Site-2| Train Acc: 0.8682

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.74it/s]
100%|██████████| 2/2 [00:00<00:00,  6.49it/s]
100%|██████████| 2/2 [00:00<00:00,  6.52it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  5.92it/s]
 40%|████      | 2/5 [00:00<00:00,  6.54it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.18it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.47it/s]
100%|██████████| 5/5 [00:00<00:00,  7.00it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8745

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  5.77it/s]
100%|██████████| 2/2 [00:00<00:00,  8.99it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.12it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.47it/s]
100%|██████████| 3/3 [00:00<00:00,  6.68it/s]
100%|██████████| 3/3 [00:00<00:00,  6.58it/s]
 Test site-2| Test Acc: 0.8085 | Bacc: 0.8170

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.51it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.00it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.94it/s]
 31%|███       | 4/13 [00:00<00:01,  7.01it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.06it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.25it/s]
 54%|█████▍    | 7/13 [00:00<00:00,  7.81it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.29it/s]
 69%|██████▉   | 9/13 [00:01<00:00,  8.62it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  6.95it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.02it/s]
100%|██████████| 13/13 [00:01<00:00,  7.18it/s]
 Test site-3| Test Acc: 0.6142 | Bacc: 0.5998
============ Train epoch 22 ============
0 0
cla loss:  2.726835648618152 trans loss: 0.8070287228229657
0 0
cla loss:  2.6967529867162656 trans loss: 0.8202509385856551
0 0
cla loss:  2.70876613813429 trans loss: 0.8089927620624178

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.62it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.66it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.62it/s]
 11%|█         | 4/36 [00:00<00:04,  6.77it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.77it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.74it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.66it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.78it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.73it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.79it/s]
 31%|███       | 11/36 [00:01<00:03,  6.82it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.84it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.84it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.83it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.94it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.94it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.80it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.85it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.89it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.97it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.85it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.80it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.72it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.77it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.81it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.75it/s]
 75%|███████▌  | 27/36 [00:03<00:01,  6.82it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.87it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.75it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.76it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.58it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.63it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.63it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.64it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.68it/s]
100%|██████████| 36/36 [00:05<00:00,  6.62it/s]
100%|██████████| 36/36 [00:05<00:00,  6.76it/s]
 Site-0| Train Acc: 0.8689

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.73it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.67it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.74it/s]
100%|██████████| 4/4 [00:00<00:00,  6.78it/s]
100%|██████████| 4/4 [00:00<00:00,  6.75it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.81it/s]
 20%|██        | 2/10 [00:00<00:01,  6.79it/s]
 30%|███       | 3/10 [00:00<00:01,  6.92it/s]
 40%|████      | 4/10 [00:00<00:00,  6.79it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.67it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.67it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.67it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.78it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.76it/s]
100%|██████████| 10/10 [00:01<00:00,  6.84it/s]
100%|██████████| 10/10 [00:01<00:00,  6.78it/s]
 Site-1| Train Acc: 0.8719

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  7.07it/s]
100%|██████████| 1/1 [00:00<00:00,  7.05it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.79it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.48it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.73it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.77it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.62it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.61it/s]
 30%|███       | 7/23 [00:01<00:02,  6.56it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.84it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.93it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.92it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.90it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.76it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.55it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.73it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.68it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.74it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.87it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.91it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.95it/s]
 87%|████████▋ | 20/23 [00:02<00:00,  6.99it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.90it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.85it/s]
100%|██████████| 23/23 [00:03<00:00,  6.81it/s]
100%|██████████| 23/23 [00:03<00:00,  6.79it/s]
 Site-2| Train Acc: 0.8777

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.70it/s]
100%|██████████| 2/2 [00:00<00:00,  6.75it/s]
100%|██████████| 2/2 [00:00<00:00,  6.73it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.39it/s]
 40%|████      | 2/5 [00:00<00:00,  6.89it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.34it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.63it/s]
100%|██████████| 5/5 [00:00<00:00,  7.24it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8685

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.87it/s]
100%|██████████| 2/2 [00:00<00:00, 10.34it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.86it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.57it/s]
100%|██████████| 3/3 [00:00<00:00,  6.75it/s]
100%|██████████| 3/3 [00:00<00:00,  6.73it/s]
 Test site-2| Test Acc: 0.8085 | Bacc: 0.8170

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.10it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.39it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.21it/s]
 31%|███       | 4/13 [00:00<00:01,  7.06it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.08it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.10it/s]
 54%|█████▍    | 7/13 [00:00<00:00,  7.65it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.15it/s]
 69%|██████▉   | 9/13 [00:01<00:00,  8.54it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  8.76it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  6.44it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  5.39it/s]
100%|██████████| 13/13 [00:01<00:00,  7.05it/s]
 Test site-3| Test Acc: 0.6269 | Bacc: 0.6119
============ Train epoch 23 ============
0 0
cla loss:  2.7255924502808844 trans loss: 0.8223513736197697
0 0
cla loss:  2.688384840835878 trans loss: 0.803377940127598
0 0
cla loss:  2.7036821710404437 trans loss: 0.8000077859840201

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.82it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.65it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.67it/s]
 11%|█         | 4/36 [00:00<00:04,  6.57it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.58it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.74it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.60it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.67it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.70it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.50it/s]
 31%|███       | 11/36 [00:01<00:03,  6.53it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.70it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.69it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.47it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.60it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.49it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.54it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.68it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.66it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.74it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.73it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.82it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.82it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.60it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.63it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.69it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.56it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.70it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.65it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.70it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.67it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.60it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.62it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.64it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.72it/s]
100%|██████████| 36/36 [00:05<00:00,  6.66it/s]
100%|██████████| 36/36 [00:05<00:00,  6.65it/s]
 Site-0| Train Acc: 0.8767

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.86it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.76it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.81it/s]
100%|██████████| 4/4 [00:00<00:00,  6.83it/s]
100%|██████████| 4/4 [00:00<00:00,  6.82it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  7.10it/s]
 20%|██        | 2/10 [00:00<00:01,  7.02it/s]
 30%|███       | 3/10 [00:00<00:01,  6.99it/s]
 40%|████      | 4/10 [00:00<00:00,  6.96it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.97it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.95it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.83it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.83it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.73it/s]
100%|██████████| 10/10 [00:01<00:00,  6.68it/s]
100%|██████████| 10/10 [00:01<00:00,  6.83it/s]
 Site-1| Train Acc: 0.8812

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  7.05it/s]
100%|██████████| 1/1 [00:00<00:00,  7.03it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.97it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.64it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.87it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.77it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.73it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.93it/s]
 30%|███       | 7/23 [00:01<00:02,  6.73it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.76it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.69it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.79it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.91it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.89it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.86it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.82it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.93it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.60it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.56it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.67it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.72it/s]
 87%|████████▋ | 20/23 [00:02<00:00,  6.83it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.67it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.80it/s]
100%|██████████| 23/23 [00:03<00:00,  6.74it/s]
100%|██████████| 23/23 [00:03<00:00,  6.77it/s]
 Site-2| Train Acc: 0.8668

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.91it/s]
100%|██████████| 2/2 [00:00<00:00,  6.78it/s]
100%|██████████| 2/2 [00:00<00:00,  6.79it/s]
 Site-2| Val  Acc: 0.8906

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.20it/s]
 40%|████      | 2/5 [00:00<00:00,  6.67it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.18it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.50it/s]
100%|██████████| 5/5 [00:00<00:00,  7.06it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8688

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.82it/s]
100%|██████████| 2/2 [00:00<00:00, 10.29it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.81it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.69it/s]
100%|██████████| 3/3 [00:00<00:00,  6.81it/s]
100%|██████████| 3/3 [00:00<00:00,  6.78it/s]
 Test site-2| Test Acc: 0.8085 | Bacc: 0.8160

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.12it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.42it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.22it/s]
 31%|███       | 4/13 [00:00<00:01,  7.20it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.52it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.71it/s]
 62%|██████▏   | 8/13 [00:00<00:00,  8.83it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.46it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.32it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.28it/s]
100%|██████████| 13/13 [00:01<00:00,  7.58it/s]
 Test site-3| Test Acc: 0.6218 | Bacc: 0.6120
============ Train epoch 24 ============
0 0
cla loss:  2.7235455045748 trans loss: 0.8128215664595215
0 0
cla loss:  2.689017471955649 trans loss: 0.8169037133605037
0 0
cla loss:  2.7040781843003314 trans loss: 0.8171360354926718

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.89it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.99it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.95it/s]
 11%|█         | 4/36 [00:00<00:04,  6.90it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.85it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.85it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.82it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.78it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.55it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.58it/s]
 31%|███       | 11/36 [00:01<00:03,  6.69it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.69it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.66it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.69it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.82it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.79it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.56it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.66it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.75it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.71it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.60it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.66it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.57it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.47it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.49it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.50it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.56it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.80it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.91it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.74it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.74it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.62it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.65it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.69it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.61it/s]
100%|██████████| 36/36 [00:05<00:00,  6.57it/s]
100%|██████████| 36/36 [00:05<00:00,  6.68it/s]
 Site-0| Train Acc: 0.8707

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.68it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.69it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.76it/s]
100%|██████████| 4/4 [00:00<00:00,  6.80it/s]
100%|██████████| 4/4 [00:00<00:00,  6.76it/s]
 Site-0| Val  Acc: 0.8047

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.57it/s]
 20%|██        | 2/10 [00:00<00:01,  6.58it/s]
 30%|███       | 3/10 [00:00<00:01,  6.26it/s]
 40%|████      | 4/10 [00:00<00:00,  6.39it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.42it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.60it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.71it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.73it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.72it/s]
100%|██████████| 10/10 [00:01<00:00,  6.75it/s]
100%|██████████| 10/10 [00:01<00:00,  6.62it/s]
 Site-1| Train Acc: 0.8750

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.86it/s]
100%|██████████| 1/1 [00:00<00:00,  6.84it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  7.02it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.65it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.71it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.60it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.71it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.72it/s]
 30%|███       | 7/23 [00:01<00:02,  6.44it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.34it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.41it/s]
 43%|████▎     | 10/23 [00:01<00:02,  6.35it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.50it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.42it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.57it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.65it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.61it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.50it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.50it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.51it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.61it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.64it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.62it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.65it/s]
100%|██████████| 23/23 [00:03<00:00,  6.65it/s]
100%|██████████| 23/23 [00:03<00:00,  6.57it/s]
 Site-2| Train Acc: 0.8709

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.90it/s]
100%|██████████| 2/2 [00:00<00:00,  6.82it/s]
100%|██████████| 2/2 [00:00<00:00,  6.83it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.30it/s]
 40%|████      | 2/5 [00:00<00:00,  6.82it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.32it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.58it/s]
100%|██████████| 5/5 [00:00<00:00,  7.16it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8685

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.86it/s]
100%|██████████| 2/2 [00:00<00:00, 10.26it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.79it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.72it/s]
100%|██████████| 3/3 [00:00<00:00,  6.82it/s]
100%|██████████| 3/3 [00:00<00:00,  6.79it/s]
 Test site-2| Test Acc: 0.7766 | Bacc: 0.7754

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.08it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.04it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.91it/s]
 31%|███       | 4/13 [00:00<00:01,  6.85it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.28it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.54it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.74it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.41it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.25it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.20it/s]
100%|██████████| 13/13 [00:01<00:00,  7.43it/s]
 Test site-3| Test Acc: 0.6345 | Bacc: 0.6241
============ Train epoch 25 ============
0 0
cla loss:  2.7194157449444334 trans loss: 0.8128788459241091
0 0
cla loss:  2.6896551553927472 trans loss: 0.8083056582877385
0 0
cla loss:  2.702515412814653 trans loss: 0.7960413634477548

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.76it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.63it/s]
  8%|▊         | 3/36 [00:00<00:05,  6.56it/s]
 11%|█         | 4/36 [00:00<00:04,  6.48it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.38it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.39it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.45it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.28it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.43it/s]
 28%|██▊       | 10/36 [00:01<00:04,  6.48it/s]
 31%|███       | 11/36 [00:01<00:03,  6.59it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.63it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.59it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.62it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.76it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.56it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.63it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.65it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.71it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.59it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.61it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.57it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.54it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.67it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.61it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.64it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.71it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.70it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.80it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.78it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.69it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.48it/s]
 92%|█████████▏| 33/36 [00:05<00:00,  6.61it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.68it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.60it/s]
100%|██████████| 36/36 [00:05<00:00,  6.75it/s]
100%|██████████| 36/36 [00:05<00:00,  6.61it/s]
 Site-0| Train Acc: 0.8750

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.81it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.67it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.76it/s]
100%|██████████| 4/4 [00:00<00:00,  6.80it/s]
100%|██████████| 4/4 [00:00<00:00,  6.78it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.95it/s]
 20%|██        | 2/10 [00:00<00:01,  6.80it/s]
 30%|███       | 3/10 [00:00<00:01,  6.68it/s]
 40%|████      | 4/10 [00:00<00:00,  6.73it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.50it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.49it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.34it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.35it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.42it/s]
100%|██████████| 10/10 [00:01<00:00,  6.49it/s]
100%|██████████| 10/10 [00:01<00:00,  6.51it/s]
 Site-1| Train Acc: 0.8875

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.52it/s]
100%|██████████| 1/1 [00:00<00:00,  6.50it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.51it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.52it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.79it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.59it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.34it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.38it/s]
 30%|███       | 7/23 [00:01<00:02,  6.59it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.65it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.65it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.51it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.41it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.54it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.64it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.57it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.59it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.60it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.63it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.60it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.49it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.67it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.78it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.56it/s]
100%|██████████| 23/23 [00:03<00:00,  6.68it/s]
100%|██████████| 23/23 [00:03<00:00,  6.59it/s]
 Site-2| Train Acc: 0.8696

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.85it/s]
100%|██████████| 2/2 [00:00<00:00,  6.67it/s]
100%|██████████| 2/2 [00:00<00:00,  6.69it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.16it/s]
 40%|████      | 2/5 [00:00<00:00,  6.56it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.10it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.36it/s]
100%|██████████| 5/5 [00:00<00:00,  6.94it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8745

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.08it/s]
100%|██████████| 2/2 [00:00<00:00,  9.09it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.73it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.48it/s]
100%|██████████| 3/3 [00:00<00:00,  6.58it/s]
100%|██████████| 3/3 [00:00<00:00,  6.57it/s]
 Test site-2| Test Acc: 0.7979 | Bacc: 0.8070

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.90it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.23it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.77it/s]
 31%|███       | 4/13 [00:00<00:01,  6.75it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.22it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.50it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.76it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.42it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.10it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  5.90it/s]
100%|██████████| 13/13 [00:01<00:00,  7.23it/s]
 Test site-3| Test Acc: 0.6269 | Bacc: 0.6143
============ Train epoch 26 ============
0 0
cla loss:  2.7194294366405236 trans loss: 0.8111255585248746
0 0
cla loss:  2.692862927614145 trans loss: 0.8195723447967415
0 0
cla loss:  2.7023792674194027 trans loss: 0.8055323793660456

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.76it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.75it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.64it/s]
 11%|█         | 4/36 [00:00<00:04,  6.59it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.57it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.56it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.56it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.59it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.58it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.62it/s]
 31%|███       | 11/36 [00:01<00:03,  6.64it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.69it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.77it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.64it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.66it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.58it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.47it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.57it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.58it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.66it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.70it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.68it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.63it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.52it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.64it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.61it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.60it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.63it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.81it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.81it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.83it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.67it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.56it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.52it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.54it/s]
100%|██████████| 36/36 [00:05<00:00,  6.44it/s]
100%|██████████| 36/36 [00:05<00:00,  6.61it/s]
 Site-0| Train Acc: 0.8707

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.57it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.65it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.71it/s]
100%|██████████| 4/4 [00:00<00:00,  6.75it/s]
100%|██████████| 4/4 [00:00<00:00,  6.71it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.68it/s]
 20%|██        | 2/10 [00:00<00:01,  6.52it/s]
 30%|███       | 3/10 [00:00<00:01,  6.51it/s]
 40%|████      | 4/10 [00:00<00:00,  6.68it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.70it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.71it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.65it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.67it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.91it/s]
100%|██████████| 10/10 [00:01<00:00,  6.84it/s]
100%|██████████| 10/10 [00:01<00:00,  6.73it/s]
 Site-1| Train Acc: 0.8812

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.95it/s]
100%|██████████| 1/1 [00:00<00:00,  6.93it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.33it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.66it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.55it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.72it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.70it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.66it/s]
 30%|███       | 7/23 [00:01<00:02,  6.70it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.58it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.53it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.59it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.71it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.73it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.66it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.75it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.70it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.58it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.42it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.44it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.51it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.60it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.58it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.59it/s]
100%|██████████| 23/23 [00:03<00:00,  6.68it/s]
100%|██████████| 23/23 [00:03<00:00,  6.62it/s]
 Site-2| Train Acc: 0.8723

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.76it/s]
100%|██████████| 2/2 [00:00<00:00,  6.32it/s]
100%|██████████| 2/2 [00:00<00:00,  6.37it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.17it/s]
 40%|████      | 2/5 [00:00<00:00,  6.75it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.20it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.51it/s]
100%|██████████| 5/5 [00:00<00:00,  7.08it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8742

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.64it/s]
100%|██████████| 2/2 [00:00<00:00, 10.04it/s]
 Test site-1| Test Acc: 0.8810 | Bacc: 0.8864

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.30it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.40it/s]
100%|██████████| 3/3 [00:00<00:00,  6.56it/s]
100%|██████████| 3/3 [00:00<00:00,  6.50it/s]
 Test site-2| Test Acc: 0.7979 | Bacc: 0.8081

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.97it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.29it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.05it/s]
 31%|███       | 4/13 [00:00<00:01,  7.02it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.31it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.54it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.72it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.31it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.21it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.20it/s]
100%|██████████| 13/13 [00:01<00:00,  7.45it/s]
 Test site-3| Test Acc: 0.6218 | Bacc: 0.6066
============ Train epoch 27 ============
0 0
cla loss:  2.719239411042563 trans loss: 0.8123268086706573
0 0
cla loss:  2.69081430339334 trans loss: 0.817439747815156
0 0
cla loss:  2.704564731923779 trans loss: 0.8074072386751223

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.74it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.91it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.91it/s]
 11%|█         | 4/36 [00:00<00:04,  6.91it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.85it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.74it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.68it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.74it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.65it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.57it/s]
 31%|███       | 11/36 [00:01<00:03,  6.52it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.75it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.69it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.57it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.60it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.57it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.65it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.76it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.83it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.85it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.78it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.72it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.77it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.69it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.73it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.84it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.85it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.83it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.81it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.67it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.54it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.68it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.67it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.76it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.62it/s]
100%|██████████| 36/36 [00:05<00:00,  6.64it/s]
100%|██████████| 36/36 [00:05<00:00,  6.71it/s]
 Site-0| Train Acc: 0.8681

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.59it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.73it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.85it/s]
100%|██████████| 4/4 [00:00<00:00,  6.86it/s]
100%|██████████| 4/4 [00:00<00:00,  6.82it/s]
 Site-0| Val  Acc: 0.8125

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.62it/s]
 20%|██        | 2/10 [00:00<00:01,  6.66it/s]
 30%|███       | 3/10 [00:00<00:01,  6.54it/s]
 40%|████      | 4/10 [00:00<00:00,  6.51it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.31it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.38it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.51it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.62it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.59it/s]
100%|██████████| 10/10 [00:01<00:00,  6.59it/s]
100%|██████████| 10/10 [00:01<00:00,  6.54it/s]
 Site-1| Train Acc: 0.8750

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  7.01it/s]
100%|██████████| 1/1 [00:00<00:00,  6.99it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.39it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.51it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.20it/s]
 17%|█▋        | 4/23 [00:00<00:03,  6.13it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.31it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.45it/s]
 30%|███       | 7/23 [00:01<00:02,  6.51it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.54it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.55it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.58it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.56it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.59it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.64it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.47it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.48it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.54it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.58it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.66it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.75it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.78it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.70it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.48it/s]
100%|██████████| 23/23 [00:03<00:00,  6.41it/s]
100%|██████████| 23/23 [00:03<00:00,  6.51it/s]
 Site-2| Train Acc: 0.8709

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.85it/s]
100%|██████████| 2/2 [00:00<00:00,  6.74it/s]
100%|██████████| 2/2 [00:00<00:00,  6.75it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.31it/s]
 40%|████      | 2/5 [00:00<00:00,  6.81it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.30it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.57it/s]
100%|██████████| 5/5 [00:00<00:00,  7.16it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8685

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.80it/s]
100%|██████████| 2/2 [00:00<00:00, 10.25it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.79it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.73it/s]
100%|██████████| 3/3 [00:00<00:00,  6.84it/s]
100%|██████████| 3/3 [00:00<00:00,  6.81it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7981

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.34it/s]
 15%|█▌        | 2/13 [00:00<00:01,  6.84it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.89it/s]
 31%|███       | 4/13 [00:00<00:01,  6.96it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.34it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.56it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.70it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.31it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.23it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.21it/s]
100%|██████████| 13/13 [00:01<00:00,  7.41it/s]
 Test site-3| Test Acc: 0.6218 | Bacc: 0.6072
============ Train epoch 28 ============
0 0
cla loss:  2.7259301252700574 trans loss: 0.8157683586954472
0 0
cla loss:  2.6944315589253027 trans loss: 0.8284338050751231
0 0
cla loss:  2.7069699416807547 trans loss: 0.8059413978202858

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.88it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.86it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.78it/s]
 11%|█         | 4/36 [00:00<00:04,  6.88it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.84it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.92it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.95it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.90it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.90it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.96it/s]
 31%|███       | 11/36 [00:01<00:03,  6.98it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.97it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.84it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.81it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.82it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.88it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.79it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.77it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.73it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.77it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.70it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.45it/s]
 64%|██████▍   | 23/36 [00:03<00:02,  6.47it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.58it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.65it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.66it/s]
 75%|███████▌  | 27/36 [00:03<00:01,  6.53it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.61it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.80it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.80it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.81it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.74it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.80it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.76it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.72it/s]
100%|██████████| 36/36 [00:05<00:00,  6.71it/s]
100%|██████████| 36/36 [00:05<00:00,  6.76it/s]
 Site-0| Train Acc: 0.8698

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.60it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.65it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.71it/s]
100%|██████████| 4/4 [00:00<00:00,  6.76it/s]
100%|██████████| 4/4 [00:00<00:00,  6.72it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.66it/s]
 20%|██        | 2/10 [00:00<00:01,  6.42it/s]
 30%|███       | 3/10 [00:00<00:01,  6.55it/s]
 40%|████      | 4/10 [00:00<00:00,  6.56it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.62it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.65it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.61it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.54it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.51it/s]
100%|██████████| 10/10 [00:01<00:00,  6.34it/s]
100%|██████████| 10/10 [00:01<00:00,  6.49it/s]
 Site-1| Train Acc: 0.8750

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.61it/s]
100%|██████████| 1/1 [00:00<00:00,  6.59it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.70it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.73it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.62it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.60it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.57it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.73it/s]
 30%|███       | 7/23 [00:01<00:02,  6.84it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.49it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.35it/s]
 43%|████▎     | 10/23 [00:01<00:02,  6.45it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.55it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.66it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.77it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.81it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.89it/s]
 70%|██████▉   | 16/23 [00:02<00:00,  7.01it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.78it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.65it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.64it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.57it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.47it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.46it/s]
100%|██████████| 23/23 [00:03<00:00,  6.59it/s]
100%|██████████| 23/23 [00:03<00:00,  6.64it/s]
 Site-2| Train Acc: 0.8723

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.86it/s]
100%|██████████| 2/2 [00:00<00:00,  6.76it/s]
100%|██████████| 2/2 [00:00<00:00,  6.77it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.35it/s]
 40%|████      | 2/5 [00:00<00:00,  6.75it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.22it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.50it/s]
100%|██████████| 5/5 [00:00<00:00,  7.10it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8742

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.77it/s]
100%|██████████| 2/2 [00:00<00:00, 10.21it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.79it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.33it/s]
100%|██████████| 3/3 [00:00<00:00,  6.37it/s]
100%|██████████| 3/3 [00:00<00:00,  6.40it/s]
 Test site-2| Test Acc: 0.7979 | Bacc: 0.8081

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.16it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.47it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.23it/s]
 31%|███       | 4/13 [00:00<00:01,  7.19it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.50it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.39it/s]
 54%|█████▍    | 7/13 [00:00<00:00,  7.88it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.31it/s]
 69%|██████▉   | 9/13 [00:01<00:00,  8.62it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  8.84it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  6.28it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  5.33it/s]
100%|██████████| 13/13 [00:01<00:00,  7.09it/s]
 Test site-3| Test Acc: 0.6320 | Bacc: 0.6195
============ Train epoch 29 ============
0 0
cla loss:  2.718069210723417 trans loss: 0.7950348096277247
0 0
cla loss:  2.6906173492795857 trans loss: 0.819992904088006
0 0
cla loss:  2.702087287327752 trans loss: 0.8077691248313865

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.74it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.87it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.77it/s]
 11%|█         | 4/36 [00:00<00:04,  6.66it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.68it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.73it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.76it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.71it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.73it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.86it/s]
 31%|███       | 11/36 [00:01<00:03,  6.78it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.78it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.68it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.58it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.70it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.50it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.41it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.45it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.42it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.52it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.63it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.55it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.61it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.65it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.62it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.63it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.69it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.64it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.64it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.63it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.56it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.48it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.55it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.59it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.55it/s]
100%|██████████| 36/36 [00:05<00:00,  6.63it/s]
100%|██████████| 36/36 [00:05<00:00,  6.63it/s]
 Site-0| Train Acc: 0.8724

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.53it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.58it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.69it/s]
100%|██████████| 4/4 [00:00<00:00,  6.75it/s]
100%|██████████| 4/4 [00:00<00:00,  6.70it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  7.04it/s]
 20%|██        | 2/10 [00:00<00:01,  6.89it/s]
 30%|███       | 3/10 [00:00<00:01,  6.78it/s]
 40%|████      | 4/10 [00:00<00:00,  6.91it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.53it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.47it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.57it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.61it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.74it/s]
100%|██████████| 10/10 [00:01<00:00,  6.66it/s]
100%|██████████| 10/10 [00:01<00:00,  6.67it/s]
 Site-1| Train Acc: 0.8750

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.82it/s]
100%|██████████| 1/1 [00:00<00:00,  6.81it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.64it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.65it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.61it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.56it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.71it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.68it/s]
 30%|███       | 7/23 [00:01<00:02,  6.65it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.73it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.60it/s]
 43%|████▎     | 10/23 [00:01<00:02,  6.39it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.32it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.48it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.59it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.71it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.63it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.71it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.67it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.03it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.23it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.29it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.38it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.50it/s]
100%|██████████| 23/23 [00:03<00:00,  6.53it/s]
100%|██████████| 23/23 [00:03<00:00,  6.52it/s]
 Site-2| Train Acc: 0.8696

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.20it/s]
100%|██████████| 2/2 [00:00<00:00,  6.40it/s]
100%|██████████| 2/2 [00:00<00:00,  6.36it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.08it/s]
 40%|████      | 2/5 [00:00<00:00,  6.66it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.18it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.18it/s]
100%|██████████| 5/5 [00:00<00:00,  6.87it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8745

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.72it/s]
100%|██████████| 2/2 [00:00<00:00, 10.10it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.18it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.37it/s]
100%|██████████| 3/3 [00:00<00:00,  6.57it/s]
100%|██████████| 3/3 [00:00<00:00,  6.49it/s]
 Test site-2| Test Acc: 0.7979 | Bacc: 0.8070

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.07it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.41it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.24it/s]
 31%|███       | 4/13 [00:00<00:01,  7.22it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.54it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.74it/s]
 62%|██████▏   | 8/13 [00:00<00:00,  8.87it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.46it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.32it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.27it/s]
100%|██████████| 13/13 [00:01<00:00,  7.58it/s]
 Test site-3| Test Acc: 0.6294 | Bacc: 0.6165
============ Train epoch 30 ============
0 0
cla loss:  2.718222621697277 trans loss: 0.8024992858944227
0 0
cla loss:  2.6921786938480397 trans loss: 0.8047297746691872
0 0
cla loss:  2.7029564356684084 trans loss: 0.8140574660732518

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.75it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.63it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.69it/s]
 11%|█         | 4/36 [00:00<00:04,  6.72it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.79it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.84it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.81it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.86it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.79it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.92it/s]
 31%|███       | 11/36 [00:01<00:03,  6.73it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.77it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.87it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.90it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.79it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.68it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.38it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.49it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.50it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.59it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.75it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.60it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.51it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.63it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.70it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.51it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.53it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.63it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.63it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.56it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.63it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.68it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.69it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.82it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.89it/s]
100%|██████████| 36/36 [00:05<00:00,  6.80it/s]
100%|██████████| 36/36 [00:05<00:00,  6.70it/s]
 Site-0| Train Acc: 0.8724

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.45it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.61it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.70it/s]
100%|██████████| 4/4 [00:00<00:00,  6.73it/s]
100%|██████████| 4/4 [00:00<00:00,  6.68it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.90it/s]
 20%|██        | 2/10 [00:00<00:01,  6.81it/s]
 30%|███       | 3/10 [00:00<00:01,  6.61it/s]
 40%|████      | 4/10 [00:00<00:00,  6.77it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.91it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.80it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.55it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.54it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.48it/s]
100%|██████████| 10/10 [00:01<00:00,  6.48it/s]
100%|██████████| 10/10 [00:01<00:00,  6.61it/s]
 Site-1| Train Acc: 0.8750

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  7.06it/s]
100%|██████████| 1/1 [00:00<00:00,  7.04it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.89it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.64it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.75it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.71it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.46it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.45it/s]
 30%|███       | 7/23 [00:01<00:02,  6.56it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.63it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.57it/s]
 43%|████▎     | 10/23 [00:01<00:02,  6.41it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.48it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.56it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.39it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.38it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.46it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.40it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.45it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.53it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.66it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.73it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.76it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.64it/s]
100%|██████████| 23/23 [00:03<00:00,  6.75it/s]
100%|██████████| 23/23 [00:03<00:00,  6.58it/s]
 Site-2| Train Acc: 0.8723

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.81it/s]
100%|██████████| 2/2 [00:00<00:00,  6.69it/s]
100%|██████████| 2/2 [00:00<00:00,  6.70it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.34it/s]
 40%|████      | 2/5 [00:00<00:00,  6.84it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.30it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.58it/s]
100%|██████████| 5/5 [00:00<00:00,  7.16it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8745

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.84it/s]
100%|██████████| 2/2 [00:00<00:00, 10.25it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.67it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.68it/s]
100%|██████████| 3/3 [00:00<00:00,  6.80it/s]
100%|██████████| 3/3 [00:00<00:00,  6.76it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7981

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.10it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.40it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.19it/s]
 31%|███       | 4/13 [00:00<00:01,  7.17it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.50it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.68it/s]
 62%|██████▏   | 8/13 [00:00<00:00,  8.82it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.41it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.29it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.24it/s]
100%|██████████| 13/13 [00:01<00:00,  7.52it/s]
 Test site-3| Test Acc: 0.6320 | Bacc: 0.6187
============ Train epoch 31 ============
0 0
cla loss:  2.714574788683024 trans loss: 0.8088014188723348
0 0
cla loss:  2.689716926172151 trans loss: 0.8200181291330999
0 0
cla loss:  2.7072664050001594 trans loss: 0.8067577352475881

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.73it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.73it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.85it/s]
 11%|█         | 4/36 [00:00<00:04,  6.80it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.77it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.63it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.62it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.56it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.62it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.54it/s]
 31%|███       | 11/36 [00:01<00:03,  6.52it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.70it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.70it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.40it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.51it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.58it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.65it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.63it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.59it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.58it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.61it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.57it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.70it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.84it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.77it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.71it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.62it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.72it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.79it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.77it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.87it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.82it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.78it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.74it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.84it/s]
100%|██████████| 36/36 [00:05<00:00,  6.84it/s]
100%|██████████| 36/36 [00:05<00:00,  6.69it/s]
 Site-0| Train Acc: 0.8759

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.83it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.86it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.77it/s]
100%|██████████| 4/4 [00:00<00:00,  6.66it/s]
100%|██████████| 4/4 [00:00<00:00,  6.71it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.42it/s]
 20%|██        | 2/10 [00:00<00:01,  6.48it/s]
 30%|███       | 3/10 [00:00<00:01,  6.70it/s]
 40%|████      | 4/10 [00:00<00:00,  6.74it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.70it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.85it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.73it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.66it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.68it/s]
100%|██████████| 10/10 [00:01<00:00,  6.72it/s]
100%|██████████| 10/10 [00:01<00:00,  6.70it/s]
 Site-1| Train Acc: 0.8750

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  7.06it/s]
100%|██████████| 1/1 [00:00<00:00,  7.04it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.80it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.75it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.90it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.72it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.61it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.67it/s]
 30%|███       | 7/23 [00:01<00:02,  6.67it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.84it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.87it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.88it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.87it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.64it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.68it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.50it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.52it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.51it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.55it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.54it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.54it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.61it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.66it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.62it/s]
100%|██████████| 23/23 [00:03<00:00,  6.58it/s]
100%|██████████| 23/23 [00:03<00:00,  6.65it/s]
 Site-2| Train Acc: 0.8614

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.64it/s]
100%|██████████| 2/2 [00:00<00:00,  6.66it/s]
100%|██████████| 2/2 [00:00<00:00,  6.65it/s]
 Site-2| Val  Acc: 0.8906

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.35it/s]
 40%|████      | 2/5 [00:00<00:00,  6.86it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.33it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.60it/s]
100%|██████████| 5/5 [00:00<00:00,  7.19it/s]
 Test site-0| Test Acc: 0.8367 | Bacc: 0.8631

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.81it/s]
100%|██████████| 2/2 [00:00<00:00, 10.27it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.66it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.70it/s]
100%|██████████| 3/3 [00:00<00:00,  6.83it/s]
100%|██████████| 3/3 [00:00<00:00,  6.78it/s]
 Test site-2| Test Acc: 0.7979 | Bacc: 0.8070

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.17it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.46it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.23it/s]
 31%|███       | 4/13 [00:00<00:01,  6.86it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.30it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.56it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.73it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.39it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.30it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.26it/s]
100%|██████████| 13/13 [00:01<00:00,  7.51it/s]
 Test site-3| Test Acc: 0.6345 | Bacc: 0.6232
============ Train epoch 32 ============
0 0
cla loss:  2.7180720262192004 trans loss: 0.8155145088032861
0 0
cla loss:  2.686687316127758 trans loss: 0.816395534043336
0 0
cla loss:  2.707014107823971 trans loss: 0.8034212235829339

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:04,  7.21it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.87it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.88it/s]
 11%|█         | 4/36 [00:00<00:04,  6.80it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.47it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.68it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.63it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.82it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.77it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.68it/s]
 31%|███       | 11/36 [00:01<00:03,  6.45it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.54it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.52it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.57it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.60it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.48it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.52it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.55it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.59it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.58it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.51it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.56it/s]
 64%|██████▍   | 23/36 [00:03<00:02,  6.44it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.41it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.37it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.41it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.45it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.62it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.66it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.70it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.67it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.73it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.68it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.75it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.71it/s]
100%|██████████| 36/36 [00:05<00:00,  6.83it/s]
100%|██████████| 36/36 [00:05<00:00,  6.62it/s]
 Site-0| Train Acc: 0.8750

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.60it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.61it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.70it/s]
100%|██████████| 4/4 [00:00<00:00,  6.76it/s]
100%|██████████| 4/4 [00:00<00:00,  6.71it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.96it/s]
 20%|██        | 2/10 [00:00<00:01,  6.49it/s]
 30%|███       | 3/10 [00:00<00:01,  6.58it/s]
 40%|████      | 4/10 [00:00<00:00,  6.60it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.61it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.52it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.39it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.27it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.33it/s]
100%|██████████| 10/10 [00:01<00:00,  6.33it/s]
100%|██████████| 10/10 [00:01<00:00,  6.43it/s]
 Site-1| Train Acc: 0.8750

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.89it/s]
100%|██████████| 1/1 [00:00<00:00,  6.87it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.75it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.40it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.32it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.42it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.38it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.33it/s]
 30%|███       | 7/23 [00:01<00:02,  6.37it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.36it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.34it/s]
 43%|████▎     | 10/23 [00:01<00:02,  6.46it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.48it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.30it/s]
 57%|█████▋    | 13/23 [00:02<00:01,  6.26it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.33it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.39it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.52it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.67it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.83it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.91it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  7.02it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  7.04it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  7.04it/s]
100%|██████████| 23/23 [00:03<00:00,  6.88it/s]
100%|██████████| 23/23 [00:03<00:00,  6.58it/s]
 Site-2| Train Acc: 0.8736

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.86it/s]
100%|██████████| 2/2 [00:00<00:00,  6.69it/s]
100%|██████████| 2/2 [00:00<00:00,  6.71it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.23it/s]
 40%|████      | 2/5 [00:00<00:00,  6.69it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.20it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.41it/s]
100%|██████████| 5/5 [00:00<00:00,  7.04it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8742

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.75it/s]
100%|██████████| 2/2 [00:00<00:00, 10.15it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.71it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.73it/s]
100%|██████████| 3/3 [00:00<00:00,  6.73it/s]
100%|██████████| 3/3 [00:00<00:00,  6.72it/s]
 Test site-2| Test Acc: 0.8085 | Bacc: 0.8181

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.10it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.40it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.16it/s]
 31%|███       | 4/13 [00:00<00:01,  7.14it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.48it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.66it/s]
 62%|██████▏   | 8/13 [00:00<00:00,  8.76it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.38it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.23it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.19it/s]
100%|██████████| 13/13 [00:01<00:00,  7.50it/s]
 Test site-3| Test Acc: 0.6244 | Bacc: 0.6117
============ Train epoch 33 ============
0 0
cla loss:  2.7169550819013586 trans loss: 0.8108495431928778
0 0
cla loss:  2.690385051708126 trans loss: 0.8193332726631931
0 0
cla loss:  2.7022140960597514 trans loss: 0.8105595471271917

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:04,  7.11it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.82it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.84it/s]
 11%|█         | 4/36 [00:00<00:04,  6.76it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.68it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.76it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.65it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.66it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.70it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.78it/s]
 31%|███       | 11/36 [00:01<00:03,  6.72it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.67it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.71it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.70it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.59it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.76it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.64it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.67it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.69it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.62it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.61it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.67it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.78it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.81it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.92it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.85it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.87it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.77it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.55it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.56it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.51it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.50it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.50it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.37it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.42it/s]
100%|██████████| 36/36 [00:05<00:00,  6.41it/s]
100%|██████████| 36/36 [00:05<00:00,  6.65it/s]
 Site-0| Train Acc: 0.8672

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.54it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.67it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.73it/s]
100%|██████████| 4/4 [00:00<00:00,  6.83it/s]
100%|██████████| 4/4 [00:00<00:00,  6.76it/s]
 Site-0| Val  Acc: 0.8047

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  7.12it/s]
 20%|██        | 2/10 [00:00<00:01,  7.13it/s]
 30%|███       | 3/10 [00:00<00:01,  6.98it/s]
 40%|████      | 4/10 [00:00<00:00,  6.88it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.89it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.64it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.81it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.81it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.75it/s]
100%|██████████| 10/10 [00:01<00:00,  6.70it/s]
100%|██████████| 10/10 [00:01<00:00,  6.80it/s]
 Site-1| Train Acc: 0.8844

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.98it/s]
100%|██████████| 1/1 [00:00<00:00,  6.96it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.90it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.70it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.66it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.68it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.46it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.49it/s]
 30%|███       | 7/23 [00:01<00:02,  6.51it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.67it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.80it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.71it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.67it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.62it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.56it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.63it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.68it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.60it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.46it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.55it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.65it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.66it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.67it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.76it/s]
100%|██████████| 23/23 [00:03<00:00,  6.74it/s]
100%|██████████| 23/23 [00:03<00:00,  6.65it/s]
 Site-2| Train Acc: 0.8614

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.66it/s]
100%|██████████| 2/2 [00:00<00:00,  6.69it/s]
100%|██████████| 2/2 [00:00<00:00,  6.67it/s]
 Site-2| Val  Acc: 0.8906

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.34it/s]
 40%|████      | 2/5 [00:00<00:00,  6.75it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.25it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.53it/s]
100%|██████████| 5/5 [00:00<00:00,  7.13it/s]
 Test site-0| Test Acc: 0.8571 | Bacc: 0.8801

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.79it/s]
100%|██████████| 2/2 [00:00<00:00, 10.25it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.86it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.79it/s]
100%|██████████| 3/3 [00:00<00:00,  6.86it/s]
100%|██████████| 3/3 [00:00<00:00,  6.84it/s]
 Test site-2| Test Acc: 0.8191 | Bacc: 0.8249

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.94it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.27it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.14it/s]
 31%|███       | 4/13 [00:00<00:01,  7.12it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.50it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.70it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.75it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.34it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.19it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.13it/s]
100%|██████████| 13/13 [00:01<00:00,  7.45it/s]
 Test site-3| Test Acc: 0.6320 | Bacc: 0.6193
============ Train epoch 34 ============
0 0
cla loss:  2.7220322414858256 trans loss: 0.8266062170416866
0 0
cla loss:  2.686877577748131 trans loss: 0.8113623027825475
0 0
cla loss:  2.7070706106310514 trans loss: 0.8083656711794024

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:04,  7.07it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.81it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.81it/s]
 11%|█         | 4/36 [00:00<00:04,  6.73it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.69it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.69it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.84it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.86it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.83it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.82it/s]
 31%|███       | 11/36 [00:01<00:03,  6.70it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.72it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.73it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.75it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.77it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.80it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.73it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.84it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.84it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.95it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.90it/s]
 61%|██████    | 22/36 [00:03<00:01,  7.00it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.84it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.88it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.89it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.85it/s]
 75%|███████▌  | 27/36 [00:03<00:01,  6.88it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.92it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.70it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.61it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.61it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.51it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.53it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.61it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.45it/s]
100%|██████████| 36/36 [00:05<00:00,  6.51it/s]
100%|██████████| 36/36 [00:05<00:00,  6.74it/s]
 Site-0| Train Acc: 0.8715

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.58it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.59it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.70it/s]
100%|██████████| 4/4 [00:00<00:00,  6.74it/s]
100%|██████████| 4/4 [00:00<00:00,  6.70it/s]
 Site-0| Val  Acc: 0.8047

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.43it/s]
 20%|██        | 2/10 [00:00<00:01,  6.93it/s]
 30%|███       | 3/10 [00:00<00:01,  6.82it/s]
 40%|████      | 4/10 [00:00<00:00,  6.96it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.69it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.84it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.93it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.91it/s]
 90%|█████████ | 9/10 [00:01<00:00,  7.02it/s]
100%|██████████| 10/10 [00:01<00:00,  6.88it/s]
100%|██████████| 10/10 [00:01<00:00,  6.87it/s]
 Site-1| Train Acc: 0.8812

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  7.06it/s]
100%|██████████| 1/1 [00:00<00:00,  7.04it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.50it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.71it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.75it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.75it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.77it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.82it/s]
 30%|███       | 7/23 [00:01<00:02,  6.80it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.89it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.68it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.71it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.78it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.78it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.89it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.78it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.86it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.78it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.77it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.80it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.83it/s]
 87%|████████▋ | 20/23 [00:02<00:00,  6.58it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.58it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.86it/s]
100%|██████████| 23/23 [00:03<00:00,  6.65it/s]
100%|██████████| 23/23 [00:03<00:00,  6.75it/s]
 Site-2| Train Acc: 0.8696

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.91it/s]
100%|██████████| 2/2 [00:00<00:00,  6.81it/s]
100%|██████████| 2/2 [00:00<00:00,  6.81it/s]
 Site-2| Val  Acc: 0.8906

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.43it/s]
 40%|████      | 2/5 [00:00<00:00,  6.87it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.35it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.63it/s]
100%|██████████| 5/5 [00:00<00:00,  7.24it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8745

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.89it/s]
100%|██████████| 2/2 [00:00<00:00, 10.38it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.87it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.75it/s]
100%|██████████| 3/3 [00:00<00:00,  6.84it/s]
100%|██████████| 3/3 [00:00<00:00,  6.82it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7981

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.11it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.23it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.12it/s]
 31%|███       | 4/13 [00:00<00:01,  7.13it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.47it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.66it/s]
 62%|██████▏   | 8/13 [00:00<00:00,  8.79it/s]
 69%|██████▉   | 9/13 [00:01<00:00,  9.08it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.11it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  6.56it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  5.74it/s]
100%|██████████| 13/13 [00:01<00:00,  7.37it/s]
 Test site-3| Test Acc: 0.6320 | Bacc: 0.6216
============ Train epoch 35 ============
0 0
cla loss:  2.7132035224281963 trans loss: 0.8099931370672868
0 0
cla loss:  2.6898330396144234 trans loss: 0.8058991042812865
0 0
cla loss:  2.7037969629968233 trans loss: 0.8137614637164016

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.77it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.68it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.73it/s]
 11%|█         | 4/36 [00:00<00:04,  6.62it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.61it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.71it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.77it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.52it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.61it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.56it/s]
 31%|███       | 11/36 [00:01<00:03,  6.40it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.44it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.52it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.63it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.41it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.50it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.57it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.63it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.70it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.67it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.69it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.68it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.71it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.80it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.71it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.62it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.62it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.59it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.67it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.83it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.69it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.68it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.73it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.67it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.66it/s]
100%|██████████| 36/36 [00:05<00:00,  6.67it/s]
100%|██████████| 36/36 [00:05<00:00,  6.64it/s]
 Site-0| Train Acc: 0.8750

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.49it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.27it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.54it/s]
100%|██████████| 4/4 [00:00<00:00,  6.68it/s]
100%|██████████| 4/4 [00:00<00:00,  6.59it/s]
 Site-0| Val  Acc: 0.7891

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.84it/s]
 20%|██        | 2/10 [00:00<00:01,  6.93it/s]
 30%|███       | 3/10 [00:00<00:01,  6.84it/s]
 40%|████      | 4/10 [00:00<00:00,  6.85it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.91it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.97it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.90it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.88it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.59it/s]
100%|██████████| 10/10 [00:01<00:00,  6.76it/s]
100%|██████████| 10/10 [00:01<00:00,  6.82it/s]
 Site-1| Train Acc: 0.8781

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  7.02it/s]
100%|██████████| 1/1 [00:00<00:00,  7.00it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.70it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.83it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.73it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.66it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.69it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.80it/s]
 30%|███       | 7/23 [00:01<00:02,  6.78it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.94it/s]
 39%|███▉      | 9/23 [00:01<00:01,  7.03it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.74it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.73it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.52it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.62it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.73it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.44it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.61it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.66it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.59it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.29it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.36it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.55it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.61it/s]
100%|██████████| 23/23 [00:03<00:00,  6.59it/s]
100%|██████████| 23/23 [00:03<00:00,  6.64it/s]
 Site-2| Train Acc: 0.8709

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.60it/s]
100%|██████████| 2/2 [00:00<00:00,  6.52it/s]
100%|██████████| 2/2 [00:00<00:00,  6.52it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.18it/s]
 40%|████      | 2/5 [00:00<00:00,  6.63it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.04it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.36it/s]
100%|██████████| 5/5 [00:00<00:00,  6.91it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8742

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.43it/s]
100%|██████████| 2/2 [00:00<00:00,  9.80it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.23it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.39it/s]
100%|██████████| 3/3 [00:00<00:00,  6.55it/s]
100%|██████████| 3/3 [00:00<00:00,  6.48it/s]
 Test site-2| Test Acc: 0.7979 | Bacc: 0.8081

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.01it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.16it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.97it/s]
 31%|███       | 4/13 [00:00<00:01,  6.85it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.27it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.54it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.70it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.37it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.28it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.19it/s]
100%|██████████| 13/13 [00:01<00:00,  7.44it/s]
 Test site-3| Test Acc: 0.6218 | Bacc: 0.6066
============ Train epoch 36 ============
0 0
cla loss:  2.7193882704979213 trans loss: 0.8264578682693404
0 0
cla loss:  2.685172215178983 trans loss: 0.8196978455212847
0 0
cla loss:  2.7024805509864387 trans loss: 0.8188904218338243

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:04,  7.05it/s]
  6%|▌         | 2/36 [00:00<00:04,  7.07it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.78it/s]
 11%|█         | 4/36 [00:00<00:04,  6.87it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.85it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.74it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.76it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.79it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.74it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.73it/s]
 31%|███       | 11/36 [00:01<00:03,  6.71it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.71it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.79it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.78it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.78it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.74it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.80it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.63it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.67it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.65it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.56it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.61it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.59it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.57it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.65it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.47it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.52it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.55it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.56it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.55it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.56it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.32it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.51it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.61it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.48it/s]
100%|██████████| 36/36 [00:05<00:00,  6.51it/s]
100%|██████████| 36/36 [00:05<00:00,  6.64it/s]
 Site-0| Train Acc: 0.8733

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.64it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.60it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.71it/s]
100%|██████████| 4/4 [00:00<00:00,  6.75it/s]
100%|██████████| 4/4 [00:00<00:00,  6.71it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.73it/s]
 20%|██        | 2/10 [00:00<00:01,  6.48it/s]
 30%|███       | 3/10 [00:00<00:01,  6.52it/s]
 40%|████      | 4/10 [00:00<00:00,  6.56it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.55it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.65it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.55it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.40it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.48it/s]
100%|██████████| 10/10 [00:01<00:00,  6.49it/s]
100%|██████████| 10/10 [00:01<00:00,  6.52it/s]
 Site-1| Train Acc: 0.8844

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.31it/s]
100%|██████████| 1/1 [00:00<00:00,  6.30it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  7.03it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.93it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.87it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.66it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.76it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.78it/s]
 30%|███       | 7/23 [00:01<00:02,  6.79it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.72it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.75it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.58it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.56it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.64it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.48it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.58it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.48it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.28it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.30it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.41it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.51it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.54it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.49it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.55it/s]
100%|██████████| 23/23 [00:03<00:00,  6.61it/s]
100%|██████████| 23/23 [00:03<00:00,  6.59it/s]
 Site-2| Train Acc: 0.8614

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.67it/s]
100%|██████████| 2/2 [00:00<00:00,  6.49it/s]
100%|██████████| 2/2 [00:00<00:00,  6.51it/s]
 Site-2| Val  Acc: 0.8906

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.11it/s]
 40%|████      | 2/5 [00:00<00:00,  6.56it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.05it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.34it/s]
100%|██████████| 5/5 [00:00<00:00,  6.91it/s]
 Test site-0| Test Acc: 0.8367 | Bacc: 0.8631

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.64it/s]
100%|██████████| 2/2 [00:00<00:00,  9.96it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.64it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.60it/s]
100%|██████████| 3/3 [00:00<00:00,  6.71it/s]
100%|██████████| 3/3 [00:00<00:00,  6.68it/s]
 Test site-2| Test Acc: 0.8085 | Bacc: 0.8160

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.02it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.31it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.11it/s]
 31%|███       | 4/13 [00:00<00:01,  7.05it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.40it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.62it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.80it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.47it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.32it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.16it/s]
100%|██████████| 13/13 [00:01<00:00,  7.48it/s]
 Test site-3| Test Acc: 0.6396 | Bacc: 0.6333
============ Train epoch 37 ============
0 0
cla loss:  2.7208650519500424 trans loss: 0.8384681083449167
0 0
cla loss:  2.690854138465383 trans loss: 0.8171361687794403
0 0
cla loss:  2.7038619913647524 trans loss: 0.8094633431290862

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.77it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.97it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.96it/s]
 11%|█         | 4/36 [00:00<00:04,  6.71it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.83it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.62it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.71it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.59it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.53it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.62it/s]
 31%|███       | 11/36 [00:01<00:03,  6.64it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.66it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.67it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.76it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.77it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.72it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.66it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.69it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.67it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.74it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.67it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.80it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.76it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.80it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.84it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.73it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.78it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.53it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.59it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.60it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.79it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.85it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.86it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.83it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.84it/s]
100%|██████████| 36/36 [00:05<00:00,  6.91it/s]
100%|██████████| 36/36 [00:05<00:00,  6.74it/s]
 Site-0| Train Acc: 0.8698

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.86it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.88it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.93it/s]
100%|██████████| 4/4 [00:00<00:00,  6.99it/s]
100%|██████████| 4/4 [00:00<00:00,  6.95it/s]
 Site-0| Val  Acc: 0.8047

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.72it/s]
 20%|██        | 2/10 [00:00<00:01,  6.10it/s]
 30%|███       | 3/10 [00:00<00:01,  6.27it/s]
 40%|████      | 4/10 [00:00<00:00,  6.21it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.33it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.38it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.44it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.53it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.65it/s]
100%|██████████| 10/10 [00:01<00:00,  6.61it/s]
100%|██████████| 10/10 [00:01<00:00,  6.47it/s]
 Site-1| Train Acc: 0.8781

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  7.05it/s]
100%|██████████| 1/1 [00:00<00:00,  7.03it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.66it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.60it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.55it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.35it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.30it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.52it/s]
 30%|███       | 7/23 [00:01<00:02,  6.22it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.17it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.44it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.50it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.45it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.55it/s]
 57%|█████▋    | 13/23 [00:02<00:01,  6.56it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.44it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.39it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.44it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.52it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.60it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.62it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.70it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.66it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.69it/s]
100%|██████████| 23/23 [00:03<00:00,  6.72it/s]
100%|██████████| 23/23 [00:03<00:00,  6.52it/s]
 Site-2| Train Acc: 0.8723

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.92it/s]
100%|██████████| 2/2 [00:00<00:00,  6.82it/s]
100%|██████████| 2/2 [00:00<00:00,  6.82it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.26it/s]
 40%|████      | 2/5 [00:00<00:00,  6.81it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.22it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.24it/s]
100%|██████████| 5/5 [00:00<00:00,  6.95it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8685

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.80it/s]
100%|██████████| 2/2 [00:00<00:00, 10.23it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.75it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.64it/s]
100%|██████████| 3/3 [00:00<00:00,  6.82it/s]
100%|██████████| 3/3 [00:00<00:00,  6.77it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7981

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.50it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.14it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.02it/s]
 31%|███       | 4/13 [00:00<00:01,  7.02it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.36it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.57it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.73it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.39it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.19it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.13it/s]
100%|██████████| 13/13 [00:01<00:00,  7.37it/s]
 Test site-3| Test Acc: 0.6269 | Bacc: 0.6119
============ Train epoch 38 ============
0 0
cla loss:  2.7146732471696096 trans loss: 0.8070945503124639
0 0
cla loss:  2.6874110291351627 trans loss: 0.8031922701615185
0 0
cla loss:  2.703543930197481 trans loss: 0.7996329725088187

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:04,  7.05it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.95it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.89it/s]
 11%|█         | 4/36 [00:00<00:04,  6.78it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.71it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.72it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.73it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.72it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.69it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.53it/s]
 31%|███       | 11/36 [00:01<00:03,  6.47it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.50it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.50it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.58it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.57it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.49it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.51it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.64it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.64it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.60it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.58it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.50it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.62it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.57it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.64it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.66it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.71it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.78it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.61it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.57it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.69it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.65it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.69it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.54it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.48it/s]
100%|██████████| 36/36 [00:05<00:00,  6.62it/s]
100%|██████████| 36/36 [00:05<00:00,  6.62it/s]
 Site-0| Train Acc: 0.8715

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.76it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.83it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.89it/s]
100%|██████████| 4/4 [00:00<00:00,  6.96it/s]
100%|██████████| 4/4 [00:00<00:00,  6.91it/s]
 Site-0| Val  Acc: 0.8203

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.78it/s]
 20%|██        | 2/10 [00:00<00:01,  6.72it/s]
 30%|███       | 3/10 [00:00<00:01,  6.90it/s]
 40%|████      | 4/10 [00:00<00:00,  6.70it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.63it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.58it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.73it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.67it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.56it/s]
100%|██████████| 10/10 [00:01<00:00,  6.63it/s]
100%|██████████| 10/10 [00:01<00:00,  6.66it/s]
 Site-1| Train Acc: 0.8781

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.92it/s]
100%|██████████| 1/1 [00:00<00:00,  6.90it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.60it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.63it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.68it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.68it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.54it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.61it/s]
 30%|███       | 7/23 [00:01<00:02,  6.61it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.65it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.61it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.72it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.69it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.71it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.81it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.83it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.96it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.68it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.55it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.52it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.50it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.60it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.41it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.35it/s]
100%|██████████| 23/23 [00:03<00:00,  6.53it/s]
100%|██████████| 23/23 [00:03<00:00,  6.61it/s]
 Site-2| Train Acc: 0.8696

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.89it/s]
100%|██████████| 2/2 [00:00<00:00,  6.79it/s]
100%|██████████| 2/2 [00:00<00:00,  6.79it/s]
 Site-2| Val  Acc: 0.9219

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.18it/s]
 40%|████      | 2/5 [00:00<00:00,  6.69it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.16it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.45it/s]
100%|██████████| 5/5 [00:00<00:00,  7.04it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8685

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.67it/s]
100%|██████████| 2/2 [00:00<00:00, 10.05it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.63it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.65it/s]
100%|██████████| 3/3 [00:00<00:00,  6.74it/s]
100%|██████████| 3/3 [00:00<00:00,  6.70it/s]
 Test site-2| Test Acc: 0.7766 | Bacc: 0.7754

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.03it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.33it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.10it/s]
 31%|███       | 4/13 [00:00<00:01,  7.06it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.42it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.63it/s]
 54%|█████▍    | 7/13 [00:00<00:00,  8.07it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.46it/s]
 69%|██████▉   | 9/13 [00:01<00:00,  8.76it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  8.90it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  6.45it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  5.56it/s]
100%|██████████| 13/13 [00:01<00:00,  7.25it/s]
 Test site-3| Test Acc: 0.6269 | Bacc: 0.6119
============ Train epoch 39 ============
0 0
cla loss:  2.7193708803186465 trans loss: 0.8191763384258328
0 0
cla loss:  2.6871790933848625 trans loss: 0.817815539225861
0 0
cla loss:  2.7042823460832914 trans loss: 0.8132481895499493

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.73it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.47it/s]
  8%|▊         | 3/36 [00:00<00:05,  6.57it/s]
 11%|█         | 4/36 [00:00<00:04,  6.53it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.61it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.62it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.65it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.69it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.49it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.58it/s]
 31%|███       | 11/36 [00:01<00:03,  6.72it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.78it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.78it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.68it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.61it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.61it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.71it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.72it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.72it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.63it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.64it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.61it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.66it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.71it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.66it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.74it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.70it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.65it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.78it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.61it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.58it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.62it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.75it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.71it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.76it/s]
100%|██████████| 36/36 [00:05<00:00,  6.67it/s]
100%|██████████| 36/36 [00:05<00:00,  6.66it/s]
 Site-0| Train Acc: 0.8698

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.77it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.80it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.88it/s]
100%|██████████| 4/4 [00:00<00:00,  6.93it/s]
100%|██████████| 4/4 [00:00<00:00,  6.89it/s]
 Site-0| Val  Acc: 0.8203

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  7.18it/s]
 20%|██        | 2/10 [00:00<00:01,  6.75it/s]
 30%|███       | 3/10 [00:00<00:01,  6.80it/s]
 40%|████      | 4/10 [00:00<00:00,  6.74it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.85it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.65it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.64it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.76it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.78it/s]
100%|██████████| 10/10 [00:01<00:00,  6.84it/s]
100%|██████████| 10/10 [00:01<00:00,  6.78it/s]
 Site-1| Train Acc: 0.8812

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  7.05it/s]
100%|██████████| 1/1 [00:00<00:00,  7.03it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  7.00it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.91it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.67it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.60it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.67it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.71it/s]
 30%|███       | 7/23 [00:01<00:02,  6.59it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.75it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.76it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.87it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.88it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.87it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.93it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.87it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.47it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.42it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.54it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.57it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.61it/s]
 87%|████████▋ | 20/23 [00:02<00:00,  6.58it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.62it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.81it/s]
100%|██████████| 23/23 [00:03<00:00,  6.60it/s]
100%|██████████| 23/23 [00:03<00:00,  6.68it/s]
 Site-2| Train Acc: 0.8736

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.87it/s]
100%|██████████| 2/2 [00:00<00:00,  6.79it/s]
100%|██████████| 2/2 [00:00<00:00,  6.79it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.33it/s]
 40%|████      | 2/5 [00:00<00:00,  6.82it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.09it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.43it/s]
100%|██████████| 5/5 [00:00<00:00,  7.02it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8685

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.53it/s]
100%|██████████| 2/2 [00:00<00:00,  9.65it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.50it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.64it/s]
100%|██████████| 3/3 [00:00<00:00,  6.80it/s]
100%|██████████| 3/3 [00:00<00:00,  6.73it/s]
 Test site-2| Test Acc: 0.7660 | Bacc: 0.7527

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.12it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.18it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.98it/s]
 31%|███       | 4/13 [00:00<00:01,  7.03it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.17it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.18it/s]
 54%|█████▍    | 7/13 [00:00<00:00,  7.73it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.18it/s]
 69%|██████▉   | 9/13 [00:01<00:00,  8.52it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  8.77it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  6.21it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  5.25it/s]
100%|██████████| 13/13 [00:01<00:00,  6.99it/s]
 Test site-3| Test Acc: 0.6320 | Bacc: 0.6195
============ Train epoch 40 ============
0 0
cla loss:  2.714953695709382 trans loss: 0.8026382716456849
0 0
cla loss:  2.694675509055056 trans loss: 0.8247254442929024
0 0
cla loss:  2.705755745346223 trans loss: 0.812338545693824

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.28it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.67it/s]
  8%|▊         | 3/36 [00:00<00:05,  6.58it/s]
 11%|█         | 4/36 [00:00<00:04,  6.60it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.69it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.80it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.83it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.68it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.64it/s]
 28%|██▊       | 10/36 [00:01<00:04,  6.33it/s]
 31%|███       | 11/36 [00:01<00:03,  6.38it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.44it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.56it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.43it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.45it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.56it/s]
 47%|████▋     | 17/36 [00:02<00:03,  6.20it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.33it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.42it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.52it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.47it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.62it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.77it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.56it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.62it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.62it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.48it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.33it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.42it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.45it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.47it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.56it/s]
 92%|█████████▏| 33/36 [00:05<00:00,  6.62it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.54it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.51it/s]
100%|██████████| 36/36 [00:05<00:00,  6.55it/s]
100%|██████████| 36/36 [00:05<00:00,  6.53it/s]
 Site-0| Train Acc: 0.8741

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.40it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.62it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.72it/s]
100%|██████████| 4/4 [00:00<00:00,  6.82it/s]
100%|██████████| 4/4 [00:00<00:00,  6.74it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.24it/s]
 20%|██        | 2/10 [00:00<00:01,  6.57it/s]
 30%|███       | 3/10 [00:00<00:01,  6.76it/s]
 40%|████      | 4/10 [00:00<00:00,  6.94it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.81it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.68it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.74it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.81it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.60it/s]
100%|██████████| 10/10 [00:01<00:00,  6.53it/s]
100%|██████████| 10/10 [00:01<00:00,  6.65it/s]
 Site-1| Train Acc: 0.8656

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.81it/s]
100%|██████████| 1/1 [00:00<00:00,  6.79it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.21it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.70it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.42it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.52it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.58it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.48it/s]
 30%|███       | 7/23 [00:01<00:02,  6.42it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.57it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.43it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.55it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.48it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.57it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.77it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.66it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.69it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.80it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.53it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.63it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.74it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.34it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.34it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.51it/s]
100%|██████████| 23/23 [00:03<00:00,  6.38it/s]
100%|██████████| 23/23 [00:03<00:00,  6.52it/s]
 Site-2| Train Acc: 0.8628

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.33it/s]
100%|██████████| 2/2 [00:00<00:00,  6.45it/s]
100%|██████████| 2/2 [00:00<00:00,  6.42it/s]
 Site-2| Val  Acc: 0.8906

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.19it/s]
 40%|████      | 2/5 [00:00<00:00,  6.63it/s]
 60%|██████    | 3/5 [00:00<00:00,  5.99it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.26it/s]
100%|██████████| 5/5 [00:00<00:00,  6.84it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8688

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.06it/s]
100%|██████████| 2/2 [00:00<00:00,  9.36it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.69it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.59it/s]
100%|██████████| 3/3 [00:00<00:00,  6.62it/s]
100%|██████████| 3/3 [00:00<00:00,  6.62it/s]
 Test site-2| Test Acc: 0.8085 | Bacc: 0.8160

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.94it/s]
 15%|█▌        | 2/13 [00:00<00:01,  6.95it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.93it/s]
 31%|███       | 4/13 [00:00<00:01,  6.98it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.36it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.54it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.69it/s]
 69%|██████▉   | 9/13 [00:01<00:00,  8.94it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.05it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  6.67it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  5.71it/s]
100%|██████████| 13/13 [00:01<00:00,  7.27it/s]
 Test site-3| Test Acc: 0.6320 | Bacc: 0.6214
============ Train epoch 41 ============
0 0
cla loss:  2.7192688874862903 trans loss: 0.8180708331079339
0 0
cla loss:  2.686172989744637 trans loss: 0.8237436081296835
0 0
cla loss:  2.701724070400449 trans loss: 0.8116422280594332

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.59it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.71it/s]
  8%|▊         | 3/36 [00:00<00:05,  6.45it/s]
 11%|█         | 4/36 [00:00<00:04,  6.56it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.51it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.59it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.60it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.23it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.15it/s]
 28%|██▊       | 10/36 [00:01<00:04,  6.34it/s]
 31%|███       | 11/36 [00:01<00:03,  6.25it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.21it/s]
 36%|███▌      | 13/36 [00:02<00:03,  6.31it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.37it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.43it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.58it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.65it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.57it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.60it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.59it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.43it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.51it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.63it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.90it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.92it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.92it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.72it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.76it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.79it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.92it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.86it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.77it/s]
 92%|█████████▏| 33/36 [00:05<00:00,  6.78it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.73it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.79it/s]
100%|██████████| 36/36 [00:05<00:00,  6.72it/s]
100%|██████████| 36/36 [00:05<00:00,  6.60it/s]
 Site-0| Train Acc: 0.8707

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.72it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.67it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.69it/s]
100%|██████████| 4/4 [00:00<00:00,  6.82it/s]
100%|██████████| 4/4 [00:00<00:00,  6.76it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.69it/s]
 20%|██        | 2/10 [00:00<00:01,  6.52it/s]
 30%|███       | 3/10 [00:00<00:01,  6.69it/s]
 40%|████      | 4/10 [00:00<00:00,  6.68it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.68it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.61it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.59it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.74it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.86it/s]
100%|██████████| 10/10 [00:01<00:00,  6.83it/s]
100%|██████████| 10/10 [00:01<00:00,  6.73it/s]
 Site-1| Train Acc: 0.8750

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  7.08it/s]
100%|██████████| 1/1 [00:00<00:00,  7.06it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.86it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.81it/s]
 13%|█▎        | 3/23 [00:00<00:02,  7.01it/s]
 17%|█▋        | 4/23 [00:00<00:02,  7.05it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.94it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.84it/s]
 30%|███       | 7/23 [00:01<00:02,  6.85it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.96it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.98it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.83it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.82it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.59it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.40it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.37it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.47it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.55it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.45it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.51it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.58it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.45it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.57it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.61it/s]
100%|██████████| 23/23 [00:03<00:00,  6.64it/s]
100%|██████████| 23/23 [00:03<00:00,  6.67it/s]
 Site-2| Train Acc: 0.8723

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.59it/s]
100%|██████████| 2/2 [00:00<00:00,  6.55it/s]
100%|██████████| 2/2 [00:00<00:00,  6.55it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.23it/s]
 40%|████      | 2/5 [00:00<00:00,  6.75it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.26it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.54it/s]
100%|██████████| 5/5 [00:00<00:00,  7.11it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8745

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.88it/s]
100%|██████████| 2/2 [00:00<00:00, 10.34it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.84it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.63it/s]
100%|██████████| 3/3 [00:00<00:00,  6.80it/s]
100%|██████████| 3/3 [00:00<00:00,  6.76it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7981

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.17it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.35it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.20it/s]
 31%|███       | 4/13 [00:00<00:01,  7.18it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.55it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.74it/s]
 62%|██████▏   | 8/13 [00:00<00:00,  8.84it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.34it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.07it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.10it/s]
100%|██████████| 13/13 [00:01<00:00,  7.45it/s]
 Test site-3| Test Acc: 0.6269 | Bacc: 0.6157
============ Train epoch 42 ============
0 0
cla loss:  2.718840573900309 trans loss: 0.8068913901271533
0 0
cla loss:  2.687154151686472 trans loss: 0.8184487064879145
0 0
cla loss:  2.7042544774673694 trans loss: 0.826086268053582

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.78it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.89it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.92it/s]
 11%|█         | 4/36 [00:00<00:04,  6.77it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.69it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.74it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.70it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.79it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.62it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.54it/s]
 31%|███       | 11/36 [00:01<00:03,  6.62it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.64it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.51it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.53it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.53it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.63it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.58it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.56it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.41it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.48it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.46it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.42it/s]
 64%|██████▍   | 23/36 [00:03<00:02,  6.49it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.62it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.56it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.58it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.74it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.76it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.77it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.74it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.50it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.60it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.70it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.49it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.47it/s]
100%|██████████| 36/36 [00:05<00:00,  6.40it/s]
100%|██████████| 36/36 [00:05<00:00,  6.59it/s]
 Site-0| Train Acc: 0.8733

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.62it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.59it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.53it/s]
100%|██████████| 4/4 [00:00<00:00,  6.62it/s]
100%|██████████| 4/4 [00:00<00:00,  6.60it/s]
 Site-0| Val  Acc: 0.8047

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.72it/s]
 20%|██        | 2/10 [00:00<00:01,  6.79it/s]
 30%|███       | 3/10 [00:00<00:01,  6.92it/s]
 40%|████      | 4/10 [00:00<00:00,  6.72it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.45it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.45it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.44it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.45it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.46it/s]
100%|██████████| 10/10 [00:01<00:00,  6.60it/s]
100%|██████████| 10/10 [00:01<00:00,  6.57it/s]
 Site-1| Train Acc: 0.8844

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.84it/s]
100%|██████████| 1/1 [00:00<00:00,  6.82it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.53it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.71it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.96it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.79it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.56it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.60it/s]
 30%|███       | 7/23 [00:01<00:02,  6.64it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.24it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.35it/s]
 43%|████▎     | 10/23 [00:01<00:02,  6.47it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.46it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.58it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.54it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.62it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.45it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.49it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.32it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.39it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.58it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.62it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.76it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.63it/s]
100%|██████████| 23/23 [00:03<00:00,  6.64it/s]
100%|██████████| 23/23 [00:03<00:00,  6.56it/s]
 Site-2| Train Acc: 0.8668

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.42it/s]
100%|██████████| 2/2 [00:00<00:00,  6.46it/s]
100%|██████████| 2/2 [00:00<00:00,  6.45it/s]
 Site-2| Val  Acc: 0.8906

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.12it/s]
 40%|████      | 2/5 [00:00<00:00,  6.57it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.13it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.40it/s]
100%|██████████| 5/5 [00:00<00:00,  6.92it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8688

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.63it/s]
100%|██████████| 2/2 [00:00<00:00,  9.78it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.55it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.52it/s]
100%|██████████| 3/3 [00:00<00:00,  6.58it/s]
100%|██████████| 3/3 [00:00<00:00,  6.56it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7843

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.87it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.22it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.06it/s]
 31%|███       | 4/13 [00:00<00:01,  6.75it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.17it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.43it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.62it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.32it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.01it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  5.98it/s]
100%|██████████| 13/13 [00:01<00:00,  7.25it/s]
 Test site-3| Test Acc: 0.6320 | Bacc: 0.6190
============ Train epoch 43 ============
0 0
cla loss:  2.720011816551937 trans loss: 0.8091057808554951
0 0
cla loss:  2.6865442625841305 trans loss: 0.8190536750620933
0 0
cla loss:  2.6977929829353062 trans loss: 0.8066012946205523

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:04,  7.21it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.83it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.91it/s]
 11%|█         | 4/36 [00:00<00:04,  6.79it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.59it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.78it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.78it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.78it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.71it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.84it/s]
 31%|███       | 11/36 [00:01<00:03,  6.81it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.74it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.83it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.79it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.73it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.72it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.63it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.56it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.57it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.54it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.68it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.71it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.79it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.87it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.81it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.82it/s]
 75%|███████▌  | 27/36 [00:03<00:01,  6.84it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.64it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.59it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.55it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.66it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.75it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.57it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.61it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.69it/s]
100%|██████████| 36/36 [00:05<00:00,  6.69it/s]
100%|██████████| 36/36 [00:05<00:00,  6.72it/s]
 Site-0| Train Acc: 0.8689

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.75it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.80it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.79it/s]
100%|██████████| 4/4 [00:00<00:00,  6.79it/s]
100%|██████████| 4/4 [00:00<00:00,  6.78it/s]
 Site-0| Val  Acc: 0.8047

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.08it/s]
 20%|██        | 2/10 [00:00<00:01,  6.60it/s]
 30%|███       | 3/10 [00:00<00:01,  6.81it/s]
 40%|████      | 4/10 [00:00<00:00,  6.74it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.74it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.74it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.73it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.82it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.65it/s]
100%|██████████| 10/10 [00:01<00:00,  6.68it/s]
100%|██████████| 10/10 [00:01<00:00,  6.69it/s]
 Site-1| Train Acc: 0.8719

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.82it/s]
100%|██████████| 1/1 [00:00<00:00,  6.81it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.84it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.74it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.74it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.75it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.90it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.86it/s]
 30%|███       | 7/23 [00:01<00:02,  6.64it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.70it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.51it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.66it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.69it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.72it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.72it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.80it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.80it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.73it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.68it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.78it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.73it/s]
 87%|████████▋ | 20/23 [00:02<00:00,  6.72it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.62it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.70it/s]
100%|██████████| 23/23 [00:03<00:00,  6.70it/s]
100%|██████████| 23/23 [00:03<00:00,  6.72it/s]
 Site-2| Train Acc: 0.8723

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  5.86it/s]
100%|██████████| 2/2 [00:00<00:00,  6.20it/s]
100%|██████████| 2/2 [00:00<00:00,  6.14it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.13it/s]
 40%|████      | 2/5 [00:00<00:00,  6.60it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.00it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.33it/s]
100%|██████████| 5/5 [00:00<00:00,  6.91it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8745

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.62it/s]
100%|██████████| 2/2 [00:00<00:00, 10.00it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.64it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.63it/s]
100%|██████████| 3/3 [00:00<00:00,  6.71it/s]
100%|██████████| 3/3 [00:00<00:00,  6.68it/s]
 Test site-2| Test Acc: 0.7979 | Bacc: 0.8070

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.09it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.40it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.23it/s]
 31%|███       | 4/13 [00:00<00:01,  7.16it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.48it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.69it/s]
 62%|██████▏   | 8/13 [00:00<00:00,  8.83it/s]
 69%|██████▉   | 9/13 [00:01<00:00,  9.07it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.17it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  6.81it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  5.84it/s]
100%|██████████| 13/13 [00:01<00:00,  7.46it/s]
 Test site-3| Test Acc: 0.6294 | Bacc: 0.6189
============ Train epoch 44 ============
0 0
cla loss:  2.7180265050437584 trans loss: 0.812660973575247
0 0
cla loss:  2.6882416602954193 trans loss: 0.8174188289810066
0 0
cla loss:  2.7060497430101713 trans loss: 0.8310868144035339

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.49it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.55it/s]
  8%|▊         | 3/36 [00:00<00:05,  6.55it/s]
 11%|█         | 4/36 [00:00<00:04,  6.56it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.64it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.64it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.55it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.63it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.52it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.55it/s]
 31%|███       | 11/36 [00:01<00:03,  6.61it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.72it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.74it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.71it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.80it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.71it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.66it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.65it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.51it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.56it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.65it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.63it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.69it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.69it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.70it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.66it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.69it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.66it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.53it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.57it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.49it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.45it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.53it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.65it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.68it/s]
100%|██████████| 36/36 [00:05<00:00,  6.69it/s]
100%|██████████| 36/36 [00:05<00:00,  6.63it/s]
 Site-0| Train Acc: 0.8715

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.57it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.74it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.83it/s]
100%|██████████| 4/4 [00:00<00:00,  6.85it/s]
100%|██████████| 4/4 [00:00<00:00,  6.81it/s]
 Site-0| Val  Acc: 0.8047

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.47it/s]
 20%|██        | 2/10 [00:00<00:01,  6.81it/s]
 30%|███       | 3/10 [00:00<00:01,  6.76it/s]
 40%|████      | 4/10 [00:00<00:00,  6.80it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.80it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.70it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.71it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.94it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.86it/s]
100%|██████████| 10/10 [00:01<00:00,  6.86it/s]
100%|██████████| 10/10 [00:01<00:00,  6.81it/s]
 Site-1| Train Acc: 0.8812

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  7.10it/s]
100%|██████████| 1/1 [00:00<00:00,  7.08it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.86it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.83it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.85it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.82it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.62it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.47it/s]
 30%|███       | 7/23 [00:01<00:02,  6.59it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.64it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.66it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.67it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.67it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.63it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.57it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.72it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.74it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.71it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.70it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.55it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.57it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.61it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.45it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.47it/s]
100%|██████████| 23/23 [00:03<00:00,  6.50it/s]
100%|██████████| 23/23 [00:03<00:00,  6.62it/s]
 Site-2| Train Acc: 0.8696

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.91it/s]
100%|██████████| 2/2 [00:00<00:00,  6.79it/s]
100%|██████████| 2/2 [00:00<00:00,  6.80it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.24it/s]
 40%|████      | 2/5 [00:00<00:00,  6.67it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.19it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.51it/s]
100%|██████████| 5/5 [00:00<00:00,  7.09it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8685

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.80it/s]
100%|██████████| 2/2 [00:00<00:00, 10.24it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.84it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.76it/s]
100%|██████████| 3/3 [00:00<00:00,  6.86it/s]
100%|██████████| 3/3 [00:00<00:00,  6.84it/s]
 Test site-2| Test Acc: 0.7979 | Bacc: 0.8070

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.14it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.41it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.16it/s]
 31%|███       | 4/13 [00:00<00:01,  7.15it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.49it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.67it/s]
 54%|█████▍    | 7/13 [00:00<00:00,  8.18it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.56it/s]
 69%|██████▉   | 9/13 [00:01<00:00,  8.79it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  8.90it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  6.28it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  5.47it/s]
100%|██████████| 13/13 [00:01<00:00,  7.24it/s]
 Test site-3| Test Acc: 0.6244 | Bacc: 0.6097
============ Train epoch 45 ============
0 0
cla loss:  2.717206886665306 trans loss: 0.8271013597148148
0 0
cla loss:  2.6869930394330814 trans loss: 0.814205764226578
0 0
cla loss:  2.707131777576466 trans loss: 0.8223959057774376

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.68it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.82it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.86it/s]
 11%|█         | 4/36 [00:00<00:04,  6.83it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.83it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.80it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.83it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.89it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.80it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.63it/s]
 31%|███       | 11/36 [00:01<00:03,  6.65it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.73it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.79it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.67it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.64it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.72it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.69it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.58it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.40it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.50it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.50it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.56it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.60it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.61it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.54it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.53it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.65it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.71it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.77it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.55it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.62it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.61it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.75it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.72it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.60it/s]
100%|██████████| 36/36 [00:05<00:00,  6.68it/s]
100%|██████████| 36/36 [00:05<00:00,  6.67it/s]
 Site-0| Train Acc: 0.8698

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.82it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.66it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.76it/s]
100%|██████████| 4/4 [00:00<00:00,  6.70it/s]
100%|██████████| 4/4 [00:00<00:00,  6.71it/s]
 Site-0| Val  Acc: 0.8047

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  7.15it/s]
 20%|██        | 2/10 [00:00<00:01,  7.02it/s]
 30%|███       | 3/10 [00:00<00:01,  6.77it/s]
 40%|████      | 4/10 [00:00<00:00,  6.62it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.72it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.59it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.36it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.45it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.53it/s]
100%|██████████| 10/10 [00:01<00:00,  6.61it/s]
100%|██████████| 10/10 [00:01<00:00,  6.61it/s]
 Site-1| Train Acc: 0.8875

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.79it/s]
100%|██████████| 1/1 [00:00<00:00,  6.77it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.70it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.81it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.54it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.76it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.63it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.65it/s]
 30%|███       | 7/23 [00:01<00:02,  6.43it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.39it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.33it/s]
 43%|████▎     | 10/23 [00:01<00:02,  6.36it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.45it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.59it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.50it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.52it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.47it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.54it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.75it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.87it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.79it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.68it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.79it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.48it/s]
100%|██████████| 23/23 [00:03<00:00,  6.40it/s]
100%|██████████| 23/23 [00:03<00:00,  6.55it/s]
 Site-2| Train Acc: 0.8696

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.57it/s]
100%|██████████| 2/2 [00:00<00:00,  6.52it/s]
100%|██████████| 2/2 [00:00<00:00,  6.52it/s]
 Site-2| Val  Acc: 0.8906

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.21it/s]
 40%|████      | 2/5 [00:00<00:00,  6.74it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.20it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.54it/s]
100%|██████████| 5/5 [00:00<00:00,  7.10it/s]
 Test site-0| Test Acc: 0.8367 | Bacc: 0.8628

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.67it/s]
100%|██████████| 2/2 [00:00<00:00, 10.04it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.67it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.59it/s]
100%|██████████| 3/3 [00:00<00:00,  6.67it/s]
100%|██████████| 3/3 [00:00<00:00,  6.65it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7843

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.32it/s]
 15%|█▌        | 2/13 [00:00<00:01,  6.50it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.25it/s]
 31%|███       | 4/13 [00:00<00:01,  6.24it/s]
 38%|███▊      | 5/13 [00:00<00:01,  6.78it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.17it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.48it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.23it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.14it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.13it/s]
100%|██████████| 13/13 [00:01<00:00,  7.15it/s]
 Test site-3| Test Acc: 0.6244 | Bacc: 0.6097
============ Train epoch 46 ============
0 0
cla loss:  2.7195884067209524 trans loss: 0.817943153069846
0 0
cla loss:  2.6879954206284564 trans loss: 0.8194298696278328
0 0
cla loss:  2.697383644592822 trans loss: 0.7982166565243324

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.87it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.73it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.89it/s]
 11%|█         | 4/36 [00:00<00:04,  6.99it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.88it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.81it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.86it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.77it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.79it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.82it/s]
 31%|███       | 11/36 [00:01<00:03,  6.83it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.64it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.74it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.67it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.80it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.87it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.83it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.85it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.88it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.84it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.93it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.85it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.75it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.62it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.78it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.67it/s]
 75%|███████▌  | 27/36 [00:03<00:01,  6.82it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.82it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.82it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.72it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.60it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.55it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.63it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.74it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.64it/s]
100%|██████████| 36/36 [00:05<00:00,  6.56it/s]
100%|██████████| 36/36 [00:05<00:00,  6.75it/s]
 Site-0| Train Acc: 0.8724

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.85it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.73it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.79it/s]
100%|██████████| 4/4 [00:00<00:00,  6.81it/s]
100%|██████████| 4/4 [00:00<00:00,  6.79it/s]
 Site-0| Val  Acc: 0.8047

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.82it/s]
 20%|██        | 2/10 [00:00<00:01,  6.92it/s]
 30%|███       | 3/10 [00:00<00:01,  6.64it/s]
 40%|████      | 4/10 [00:00<00:00,  6.86it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.97it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.91it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.95it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.89it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.71it/s]
100%|██████████| 10/10 [00:01<00:00,  6.64it/s]
100%|██████████| 10/10 [00:01<00:00,  6.78it/s]
 Site-1| Train Acc: 0.8781

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.76it/s]
100%|██████████| 1/1 [00:00<00:00,  6.74it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.44it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.34it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.65it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.68it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.72it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.73it/s]
 30%|███       | 7/23 [00:01<00:02,  6.81it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.88it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.97it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.92it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.94it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.98it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.97it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.92it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.88it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.75it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.69it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.74it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.69it/s]
 87%|████████▋ | 20/23 [00:02<00:00,  6.81it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.73it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.68it/s]
100%|██████████| 23/23 [00:03<00:00,  6.73it/s]
100%|██████████| 23/23 [00:03<00:00,  6.78it/s]
 Site-2| Train Acc: 0.8709

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.59it/s]
100%|██████████| 2/2 [00:00<00:00,  6.66it/s]
100%|██████████| 2/2 [00:00<00:00,  6.64it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.38it/s]
 40%|████      | 2/5 [00:00<00:00,  6.81it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.28it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.57it/s]
100%|██████████| 5/5 [00:00<00:00,  7.11it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8685

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.85it/s]
100%|██████████| 2/2 [00:00<00:00, 10.33it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.86it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.82it/s]
100%|██████████| 3/3 [00:00<00:00,  6.87it/s]
100%|██████████| 3/3 [00:00<00:00,  6.85it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7981

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.12it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.28it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.01it/s]
 31%|███       | 4/13 [00:00<00:01,  7.06it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.40it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.63it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.75it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.38it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.15it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.12it/s]
100%|██████████| 13/13 [00:01<00:00,  7.43it/s]
 Test site-3| Test Acc: 0.6193 | Bacc: 0.6054
============ Train epoch 47 ============
0 0
cla loss:  2.7131619633142674 trans loss: 0.8068581807553469
0 0
cla loss:  2.6881191323150944 trans loss: 0.8120351652404172
0 0
cla loss:  2.701379470489732 trans loss: 0.8043533102351816

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.95it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.88it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.81it/s]
 11%|█         | 4/36 [00:00<00:04,  6.67it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.70it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.74it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.62it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.66it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.64it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.59it/s]
 31%|███       | 11/36 [00:01<00:03,  6.59it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.65it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.69it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.69it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.63it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.66it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.67it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.71it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.67it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.74it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.87it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.89it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.71it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.68it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.71it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.76it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.69it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.73it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.71it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.65it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.65it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.71it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.75it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.83it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.74it/s]
100%|██████████| 36/36 [00:05<00:00,  6.68it/s]
100%|██████████| 36/36 [00:05<00:00,  6.70it/s]
 Site-0| Train Acc: 0.8741

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.65it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.67it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.76it/s]
100%|██████████| 4/4 [00:00<00:00,  6.83it/s]
100%|██████████| 4/4 [00:00<00:00,  6.78it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.59it/s]
 20%|██        | 2/10 [00:00<00:01,  7.03it/s]
 30%|███       | 3/10 [00:00<00:01,  6.82it/s]
 40%|████      | 4/10 [00:00<00:00,  6.97it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.98it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.96it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.78it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.68it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.56it/s]
100%|██████████| 10/10 [00:01<00:00,  6.42it/s]
100%|██████████| 10/10 [00:01<00:00,  6.68it/s]
 Site-1| Train Acc: 0.8719

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.86it/s]
100%|██████████| 1/1 [00:00<00:00,  6.84it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.97it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.46it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.55it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.65it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.56it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.50it/s]
 30%|███       | 7/23 [00:01<00:02,  6.58it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.63it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.63it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.64it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.70it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.53it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.59it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.76it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.76it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.80it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.58it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.57it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.59it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.61it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.79it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.56it/s]
100%|██████████| 23/23 [00:03<00:00,  6.60it/s]
100%|██████████| 23/23 [00:03<00:00,  6.62it/s]
 Site-2| Train Acc: 0.8723

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  5.82it/s]
100%|██████████| 2/2 [00:00<00:00,  6.24it/s]
100%|██████████| 2/2 [00:00<00:00,  6.17it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.17it/s]
 40%|████      | 2/5 [00:00<00:00,  6.78it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.24it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.49it/s]
100%|██████████| 5/5 [00:00<00:00,  7.09it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8685

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.64it/s]
100%|██████████| 2/2 [00:00<00:00, 10.00it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.65it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.59it/s]
100%|██████████| 3/3 [00:00<00:00,  6.68it/s]
100%|██████████| 3/3 [00:00<00:00,  6.66it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7981

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.60it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.12it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.00it/s]
 31%|███       | 4/13 [00:00<00:01,  7.01it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.37it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.49it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.73it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.39it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.15it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.14it/s]
100%|██████████| 13/13 [00:01<00:00,  7.40it/s]
 Test site-3| Test Acc: 0.6168 | Bacc: 0.6029
============ Train epoch 48 ============
0 0
cla loss:  2.712450912849388 trans loss: 0.7917272781007852
0 0
cla loss:  2.683800735665326 trans loss: 0.8247809847395624
0 0
cla loss:  2.6994110327869203 trans loss: 0.79774066970576

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  7.00it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.95it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.74it/s]
 11%|█         | 4/36 [00:00<00:04,  6.90it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.84it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.77it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.47it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.63it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.57it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.69it/s]
 31%|███       | 11/36 [00:01<00:03,  6.76it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.71it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.68it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.68it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.65it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.58it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.62it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.66it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.56it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.59it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.60it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.58it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.60it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.72it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.65it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.65it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.60it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.68it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.72it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.88it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.76it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.64it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.61it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.63it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.60it/s]
100%|██████████| 36/36 [00:05<00:00,  6.56it/s]
100%|██████████| 36/36 [00:05<00:00,  6.66it/s]
 Site-0| Train Acc: 0.8759

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.81it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.59it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.70it/s]
100%|██████████| 4/4 [00:00<00:00,  6.78it/s]
100%|██████████| 4/4 [00:00<00:00,  6.74it/s]
 Site-0| Val  Acc: 0.8047

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.88it/s]
 20%|██        | 2/10 [00:00<00:01,  6.92it/s]
 30%|███       | 3/10 [00:00<00:01,  6.74it/s]
 40%|████      | 4/10 [00:00<00:00,  6.68it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.42it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.56it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.61it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.70it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.67it/s]
100%|██████████| 10/10 [00:01<00:00,  6.71it/s]
100%|██████████| 10/10 [00:01<00:00,  6.67it/s]
 Site-1| Train Acc: 0.8719

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.85it/s]
100%|██████████| 1/1 [00:00<00:00,  6.84it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.74it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.67it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.55it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.52it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.49it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.53it/s]
 30%|███       | 7/23 [00:01<00:02,  6.65it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.62it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.59it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.65it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.71it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.57it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.61it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.49it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.66it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.66it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.62it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.79it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.65it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.55it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.41it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.38it/s]
100%|██████████| 23/23 [00:03<00:00,  6.54it/s]
100%|██████████| 23/23 [00:03<00:00,  6.58it/s]
 Site-2| Train Acc: 0.8723

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.68it/s]
100%|██████████| 2/2 [00:00<00:00,  6.65it/s]
100%|██████████| 2/2 [00:00<00:00,  6.64it/s]
 Site-2| Val  Acc: 0.9531

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.13it/s]
 40%|████      | 2/5 [00:00<00:00,  6.54it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.11it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.39it/s]
100%|██████████| 5/5 [00:00<00:00,  6.96it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8742

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.61it/s]
100%|██████████| 2/2 [00:00<00:00,  9.95it/s]
 Test site-1| Test Acc: 0.8810 | Bacc: 0.8864

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.64it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.67it/s]
100%|██████████| 3/3 [00:00<00:00,  6.72it/s]
100%|██████████| 3/3 [00:00<00:00,  6.70it/s]
 Test site-2| Test Acc: 0.7979 | Bacc: 0.7954

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.37it/s]
 15%|█▌        | 2/13 [00:00<00:01,  6.98it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.03it/s]
 31%|███       | 4/13 [00:00<00:01,  7.12it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.49it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.72it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.90it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.59it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.33it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.22it/s]
100%|██████████| 13/13 [00:01<00:00,  7.50it/s]
 Test site-3| Test Acc: 0.6193 | Bacc: 0.6037
============ Train epoch 49 ============
0 0
cla loss:  2.716410491933775 trans loss: 0.7947223884376449
0 0
cla loss:  2.684648869624689 trans loss: 0.8070880974357452
0 0
cla loss:  2.6982122857366972 trans loss: 0.8058798768412527

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.49it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.61it/s]
  8%|▊         | 3/36 [00:00<00:05,  6.42it/s]
 11%|█         | 4/36 [00:00<00:04,  6.56it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.72it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.79it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.89it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.79it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.57it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.62it/s]
 31%|███       | 11/36 [00:01<00:03,  6.60it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.66it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.60it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.68it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.77it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.70it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.66it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.70it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.68it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.54it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.47it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.63it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.78it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.67it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.68it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.62it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.67it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.61it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.63it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.70it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.74it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.77it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.83it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.98it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.66it/s]
100%|██████████| 36/36 [00:05<00:00,  6.60it/s]
100%|██████████| 36/36 [00:05<00:00,  6.67it/s]
 Site-0| Train Acc: 0.8733

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.32it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.61it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.75it/s]
100%|██████████| 4/4 [00:00<00:00,  6.79it/s]
100%|██████████| 4/4 [00:00<00:00,  6.72it/s]
 Site-0| Val  Acc: 0.8047

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  7.00it/s]
 20%|██        | 2/10 [00:00<00:01,  6.91it/s]
 30%|███       | 3/10 [00:00<00:01,  6.83it/s]
 40%|████      | 4/10 [00:00<00:00,  6.54it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.43it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.46it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.46it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.53it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.50it/s]
100%|██████████| 10/10 [00:01<00:00,  6.59it/s]
100%|██████████| 10/10 [00:01<00:00,  6.58it/s]
 Site-1| Train Acc: 0.8750

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.80it/s]
100%|██████████| 1/1 [00:00<00:00,  6.78it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.53it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.44it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.47it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.77it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.77it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.83it/s]
 30%|███       | 7/23 [00:01<00:02,  6.82it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.55it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.52it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.59it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.58it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.54it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.64it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.67it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.71it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.83it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.76it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.76it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.76it/s]
 87%|████████▋ | 20/23 [00:02<00:00,  6.88it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.77it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.80it/s]
100%|██████████| 23/23 [00:03<00:00,  6.48it/s]
100%|██████████| 23/23 [00:03<00:00,  6.66it/s]
 Site-2| Train Acc: 0.8736

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.65it/s]
100%|██████████| 2/2 [00:00<00:00,  6.55it/s]
100%|██████████| 2/2 [00:00<00:00,  6.55it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.14it/s]
 40%|████      | 2/5 [00:00<00:00,  6.64it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.13it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.40it/s]
100%|██████████| 5/5 [00:00<00:00,  6.98it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8685

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.60it/s]
100%|██████████| 2/2 [00:00<00:00,  9.95it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.66it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.58it/s]
100%|██████████| 3/3 [00:00<00:00,  6.69it/s]
100%|██████████| 3/3 [00:00<00:00,  6.66it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7981

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.04it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.32it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.10it/s]
 31%|███       | 4/13 [00:00<00:01,  7.06it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.15it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.17it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.50it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.28it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.10it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.09it/s]
100%|██████████| 13/13 [00:01<00:00,  7.34it/s]
 Test site-3| Test Acc: 0.6193 | Bacc: 0.6044
============ Train epoch 50 ============
0 0
cla loss:  2.7107169100986654 trans loss: 0.8055010330137895
0 0
cla loss:  2.6799570723394655 trans loss: 0.8047162764635517
0 0
cla loss:  2.6996038978423305 trans loss: 0.8227597175531052

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:04,  7.12it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.87it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.84it/s]
 11%|█         | 4/36 [00:00<00:04,  6.89it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.80it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.95it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.78it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.81it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.86it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.88it/s]
 31%|███       | 11/36 [00:01<00:03,  6.80it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.75it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.57it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.55it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.56it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.45it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.53it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.50it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.42it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.43it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.41it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.53it/s]
 64%|██████▍   | 23/36 [00:03<00:02,  6.40it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.40it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.22it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.25it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.41it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.46it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.61it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.65it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.64it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.50it/s]
 92%|█████████▏| 33/36 [00:05<00:00,  6.44it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.43it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.36it/s]
100%|██████████| 36/36 [00:05<00:00,  6.27it/s]
100%|██████████| 36/36 [00:05<00:00,  6.54it/s]
 Site-0| Train Acc: 0.8767

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.71it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.75it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.81it/s]
100%|██████████| 4/4 [00:00<00:00,  6.88it/s]
100%|██████████| 4/4 [00:00<00:00,  6.83it/s]
 Site-0| Val  Acc: 0.8047

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.66it/s]
 20%|██        | 2/10 [00:00<00:01,  6.76it/s]
 30%|███       | 3/10 [00:00<00:01,  6.60it/s]
 40%|████      | 4/10 [00:00<00:00,  6.60it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.65it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.45it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.44it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.60it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.62it/s]
100%|██████████| 10/10 [00:01<00:00,  6.54it/s]
100%|██████████| 10/10 [00:01<00:00,  6.57it/s]
 Site-1| Train Acc: 0.8812

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.54it/s]
100%|██████████| 1/1 [00:00<00:00,  6.53it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  7.06it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.93it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.89it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.68it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.74it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.48it/s]
 30%|███       | 7/23 [00:01<00:02,  6.51it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.56it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.67it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.63it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.41it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.37it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.52it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.51it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.51it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.61it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.53it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.48it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.45it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.46it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.50it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.58it/s]
100%|██████████| 23/23 [00:03<00:00,  6.58it/s]
100%|██████████| 23/23 [00:03<00:00,  6.56it/s]
 Site-2| Train Acc: 0.8723

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.81it/s]
100%|██████████| 2/2 [00:00<00:00,  6.50it/s]
100%|██████████| 2/2 [00:00<00:00,  6.54it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  5.78it/s]
 40%|████      | 2/5 [00:00<00:00,  6.44it/s]
 60%|██████    | 3/5 [00:00<00:00,  5.75it/s]
 80%|████████  | 4/5 [00:00<00:00,  5.99it/s]
100%|██████████| 5/5 [00:00<00:00,  6.58it/s]
 Test site-0| Test Acc: 0.8571 | Bacc: 0.8801

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.83it/s]
100%|██████████| 2/2 [00:00<00:00, 10.32it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.77it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.76it/s]
100%|██████████| 3/3 [00:00<00:00,  6.87it/s]
100%|██████████| 3/3 [00:00<00:00,  6.84it/s]
 Test site-2| Test Acc: 0.7979 | Bacc: 0.8081

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.84it/s]
 15%|█▌        | 2/13 [00:00<00:01,  6.95it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.92it/s]
 31%|███       | 4/13 [00:00<00:01,  6.72it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.11it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.35it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.53it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.26it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.14it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.09it/s]
100%|██████████| 13/13 [00:01<00:00,  7.30it/s]
 Test site-3| Test Acc: 0.6371 | Bacc: 0.6280
============ Train epoch 51 ============
0 0
cla loss:  2.714038554148458 trans loss: 0.8166088932123615
0 0
cla loss:  2.687495384983082 trans loss: 0.8169952439303374
0 0
cla loss:  2.7003073644398445 trans loss: 0.8148628844687688

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.87it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.62it/s]
  8%|▊         | 3/36 [00:00<00:05,  6.59it/s]
 11%|█         | 4/36 [00:00<00:04,  6.76it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.80it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.64it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.79it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.78it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.78it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.86it/s]
 31%|███       | 11/36 [00:01<00:03,  6.86it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.91it/s]
 36%|███▌      | 13/36 [00:01<00:03,  7.07it/s]
 39%|███▉      | 14/36 [00:02<00:03,  7.02it/s]
 42%|████▏     | 15/36 [00:02<00:02,  7.07it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.95it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.95it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.81it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.90it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.90it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.88it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.86it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.79it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.66it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.69it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.70it/s]
 75%|███████▌  | 27/36 [00:03<00:01,  6.74it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.71it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.65it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.82it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.85it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.87it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.78it/s]
 94%|█████████▍| 34/36 [00:04<00:00,  6.64it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.64it/s]
100%|██████████| 36/36 [00:05<00:00,  6.69it/s]
100%|██████████| 36/36 [00:05<00:00,  6.80it/s]
 Site-0| Train Acc: 0.8724

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.42it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.55it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.76it/s]
100%|██████████| 4/4 [00:00<00:00,  6.74it/s]
100%|██████████| 4/4 [00:00<00:00,  6.69it/s]
 Site-0| Val  Acc: 0.8047

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.63it/s]
 20%|██        | 2/10 [00:00<00:01,  6.61it/s]
 30%|███       | 3/10 [00:00<00:01,  6.76it/s]
 40%|████      | 4/10 [00:00<00:00,  6.69it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.57it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.43it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.60it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.64it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.62it/s]
100%|██████████| 10/10 [00:01<00:00,  6.47it/s]
100%|██████████| 10/10 [00:01<00:00,  6.56it/s]
 Site-1| Train Acc: 0.8750

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  7.01it/s]
100%|██████████| 1/1 [00:00<00:00,  6.99it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.86it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.31it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.50it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.47it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.67it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.64it/s]
 30%|███       | 7/23 [00:01<00:02,  6.60it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.71it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.50it/s]
 43%|████▎     | 10/23 [00:01<00:02,  6.41it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.39it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.12it/s]
 57%|█████▋    | 13/23 [00:02<00:01,  6.18it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.37it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.42it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.53it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.53it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.65it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.53it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.69it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.72it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.84it/s]
100%|██████████| 23/23 [00:03<00:00,  6.78it/s]
100%|██████████| 23/23 [00:03<00:00,  6.55it/s]
 Site-2| Train Acc: 0.8682

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.90it/s]
100%|██████████| 2/2 [00:00<00:00,  6.68it/s]
100%|██████████| 2/2 [00:00<00:00,  6.70it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.17it/s]
 40%|████      | 2/5 [00:00<00:00,  6.63it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.12it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.44it/s]
100%|██████████| 5/5 [00:00<00:00,  7.02it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8688

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.74it/s]
100%|██████████| 2/2 [00:00<00:00, 10.16it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.82it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.72it/s]
100%|██████████| 3/3 [00:00<00:00,  6.82it/s]
100%|██████████| 3/3 [00:00<00:00,  6.79it/s]
 Test site-2| Test Acc: 0.7979 | Bacc: 0.8064

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.08it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.35it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.14it/s]
 31%|███       | 4/13 [00:00<00:01,  7.12it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.45it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.61it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.69it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.11it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.06it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.05it/s]
100%|██████████| 13/13 [00:01<00:00,  7.38it/s]
 Test site-3| Test Acc: 0.6345 | Bacc: 0.6259
============ Train epoch 52 ============
0 0
cla loss:  2.71394379893739 trans loss: 0.7992611901843967
0 0
cla loss:  2.6814651537181144 trans loss: 0.8006095164385273
0 0
cla loss:  2.698479455919122 trans loss: 0.8097659412340902

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.21it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.38it/s]
  8%|▊         | 3/36 [00:00<00:05,  6.40it/s]
 11%|█         | 4/36 [00:00<00:05,  6.39it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.49it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.38it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.38it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.45it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.31it/s]
 28%|██▊       | 10/36 [00:01<00:04,  6.41it/s]
 31%|███       | 11/36 [00:01<00:03,  6.42it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.50it/s]
 36%|███▌      | 13/36 [00:02<00:03,  6.45it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.58it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.58it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.41it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.58it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.70it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.72it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.70it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.74it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.73it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.74it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.72it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.78it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.75it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.92it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.90it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.79it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.75it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.68it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.84it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.84it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.85it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.87it/s]
100%|██████████| 36/36 [00:05<00:00,  6.87it/s]
100%|██████████| 36/36 [00:05<00:00,  6.65it/s]
 Site-0| Train Acc: 0.8811

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.56it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.56it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.46it/s]
100%|██████████| 4/4 [00:00<00:00,  6.62it/s]
100%|██████████| 4/4 [00:00<00:00,  6.57it/s]
 Site-0| Val  Acc: 0.7891

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.42it/s]
 20%|██        | 2/10 [00:00<00:01,  6.58it/s]
 30%|███       | 3/10 [00:00<00:01,  6.62it/s]
 40%|████      | 4/10 [00:00<00:00,  6.70it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.66it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.75it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.56it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.40it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.40it/s]
100%|██████████| 10/10 [00:01<00:00,  6.42it/s]
100%|██████████| 10/10 [00:01<00:00,  6.51it/s]
 Site-1| Train Acc: 0.8656

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.82it/s]
100%|██████████| 1/1 [00:00<00:00,  6.80it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.00it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.53it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.54it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.57it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.65it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.64it/s]
 30%|███       | 7/23 [00:01<00:02,  6.59it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.63it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.41it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.62it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.66it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.49it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.37it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.33it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.34it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.38it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.56it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.62it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.71it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.74it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.75it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.80it/s]
100%|██████████| 23/23 [00:03<00:00,  6.98it/s]
100%|██████████| 23/23 [00:03<00:00,  6.61it/s]
 Site-2| Train Acc: 0.8750

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.90it/s]
100%|██████████| 2/2 [00:00<00:00,  6.71it/s]
100%|██████████| 2/2 [00:00<00:00,  6.73it/s]
 Site-2| Val  Acc: 0.9219

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.18it/s]
 40%|████      | 2/5 [00:00<00:00,  6.67it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.18it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.43it/s]
100%|██████████| 5/5 [00:00<00:00,  7.01it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8742

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.60it/s]
100%|██████████| 2/2 [00:00<00:00,  9.97it/s]
 Test site-1| Test Acc: 0.8810 | Bacc: 0.8864

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.62it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.61it/s]
100%|██████████| 3/3 [00:00<00:00,  6.67it/s]
100%|██████████| 3/3 [00:00<00:00,  6.65it/s]
 Test site-2| Test Acc: 0.7979 | Bacc: 0.8081

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.35it/s]
 15%|█▌        | 2/13 [00:00<00:01,  6.99it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.90it/s]
 31%|███       | 4/13 [00:00<00:01,  7.01it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.39it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.64it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.81it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.43it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.32it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.28it/s]
100%|██████████| 13/13 [00:01<00:00,  7.48it/s]
 Test site-3| Test Acc: 0.6244 | Bacc: 0.6117
============ Train epoch 53 ============
0 0
cla loss:  2.7198226284142115 trans loss: 0.8355798367878899
0 0
cla loss:  2.6848332258924166 trans loss: 0.8178790939513163
0 0
cla loss:  2.7000845532920494 trans loss: 0.8170982173938847

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.77it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.59it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.81it/s]
 11%|█         | 4/36 [00:00<00:04,  6.81it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.78it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.76it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.82it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.89it/s]
 25%|██▌       | 9/36 [00:01<00:03,  7.02it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.86it/s]
 31%|███       | 11/36 [00:01<00:03,  6.91it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.87it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.90it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.83it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.69it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.69it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.76it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.72it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.74it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.72it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.51it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.71it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.78it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.84it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.79it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.70it/s]
 75%|███████▌  | 27/36 [00:03<00:01,  6.76it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.78it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.74it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.73it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.75it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.73it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.67it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.46it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.52it/s]
100%|██████████| 36/36 [00:05<00:00,  6.58it/s]
100%|██████████| 36/36 [00:05<00:00,  6.74it/s]
 Site-0| Train Acc: 0.8724

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.66it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.66it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.77it/s]
100%|██████████| 4/4 [00:00<00:00,  6.82it/s]
100%|██████████| 4/4 [00:00<00:00,  6.77it/s]
 Site-0| Val  Acc: 0.8047

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.91it/s]
 20%|██        | 2/10 [00:00<00:01,  6.64it/s]
 30%|███       | 3/10 [00:00<00:01,  6.66it/s]
 40%|████      | 4/10 [00:00<00:00,  6.63it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.57it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.68it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.57it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.59it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.61it/s]
100%|██████████| 10/10 [00:01<00:00,  6.70it/s]
100%|██████████| 10/10 [00:01<00:00,  6.65it/s]
 Site-1| Train Acc: 0.8750

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.91it/s]
100%|██████████| 1/1 [00:00<00:00,  6.89it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.85it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.73it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.75it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.64it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.49it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.58it/s]
 30%|███       | 7/23 [00:01<00:02,  6.68it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.70it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.84it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.82it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.87it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.90it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.80it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.63it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.66it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.49it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.62it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.63it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.55it/s]
 87%|████████▋ | 20/23 [00:02<00:00,  6.65it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.49it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.57it/s]
100%|██████████| 23/23 [00:03<00:00,  6.31it/s]
100%|██████████| 23/23 [00:03<00:00,  6.62it/s]
 Site-2| Train Acc: 0.8736

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.90it/s]
100%|██████████| 2/2 [00:00<00:00,  6.62it/s]
100%|██████████| 2/2 [00:00<00:00,  6.65it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  5.99it/s]
 40%|████      | 2/5 [00:00<00:00,  6.55it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.10it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.30it/s]
100%|██████████| 5/5 [00:00<00:00,  6.90it/s]
 Test site-0| Test Acc: 0.8367 | Bacc: 0.8628

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.59it/s]
100%|██████████| 2/2 [00:00<00:00,  9.99it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.29it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.44it/s]
100%|██████████| 3/3 [00:00<00:00,  6.59it/s]
100%|██████████| 3/3 [00:00<00:00,  6.52it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7843

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.64it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.12it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.00it/s]
 31%|███       | 4/13 [00:00<00:01,  7.01it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.39it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.60it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.79it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.41it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.21it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.16it/s]
100%|██████████| 13/13 [00:01<00:00,  7.42it/s]
 Test site-3| Test Acc: 0.6244 | Bacc: 0.6097
============ Train epoch 54 ============
0 0
cla loss:  2.7090453167057515 trans loss: 0.8004529545055562
0 0
cla loss:  2.6841471806243438 trans loss: 0.8157161782734358
0 0
cla loss:  2.7029056884535594 trans loss: 0.8128658101786321

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.94it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.99it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.84it/s]
 11%|█         | 4/36 [00:00<00:04,  6.62it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.64it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.76it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.78it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.66it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.57it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.51it/s]
 31%|███       | 11/36 [00:01<00:03,  6.51it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.61it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.51it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.55it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.59it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.71it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.60it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.42it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.37it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.36it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.53it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.68it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.74it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.69it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.71it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.77it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.78it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.76it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.83it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.64it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.54it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.60it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.59it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.63it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.74it/s]
100%|██████████| 36/36 [00:05<00:00,  6.68it/s]
100%|██████████| 36/36 [00:05<00:00,  6.64it/s]
 Site-0| Train Acc: 0.8741

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.76it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.78it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.87it/s]
100%|██████████| 4/4 [00:00<00:00,  6.85it/s]
100%|██████████| 4/4 [00:00<00:00,  6.83it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  7.05it/s]
 20%|██        | 2/10 [00:00<00:01,  6.69it/s]
 30%|███       | 3/10 [00:00<00:01,  6.70it/s]
 40%|████      | 4/10 [00:00<00:00,  6.74it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.57it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.71it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.75it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.80it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.86it/s]
100%|██████████| 10/10 [00:01<00:00,  6.76it/s]
100%|██████████| 10/10 [00:01<00:00,  6.75it/s]
 Site-1| Train Acc: 0.8719

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  7.02it/s]
100%|██████████| 1/1 [00:00<00:00,  7.00it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.17it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.45it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.61it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.71it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.75it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.68it/s]
 30%|███       | 7/23 [00:01<00:02,  6.78it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.80it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.73it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.80it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.76it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.83it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.68it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.72it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.80it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.82it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.85it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.77it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.77it/s]
 87%|████████▋ | 20/23 [00:02<00:00,  6.53it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.43it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.51it/s]
100%|██████████| 23/23 [00:03<00:00,  6.64it/s]
100%|██████████| 23/23 [00:03<00:00,  6.69it/s]
 Site-2| Train Acc: 0.8601

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.90it/s]
100%|██████████| 2/2 [00:00<00:00,  6.75it/s]
100%|██████████| 2/2 [00:00<00:00,  6.77it/s]
 Site-2| Val  Acc: 0.8906

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  5.86it/s]
 40%|████      | 2/5 [00:00<00:00,  6.59it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.16it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.49it/s]
100%|██████████| 5/5 [00:00<00:00,  7.01it/s]
 Test site-0| Test Acc: 0.8367 | Bacc: 0.8631

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.56it/s]
100%|██████████| 2/2 [00:00<00:00, 10.00it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.78it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.60it/s]
100%|██████████| 3/3 [00:00<00:00,  6.76it/s]
100%|██████████| 3/3 [00:00<00:00,  6.73it/s]
 Test site-2| Test Acc: 0.7979 | Bacc: 0.8070

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.68it/s]
 15%|█▌        | 2/13 [00:00<00:01,  6.95it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.82it/s]
 31%|███       | 4/13 [00:00<00:01,  6.83it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.28it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.55it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.72it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.40it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.27it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.22it/s]
100%|██████████| 13/13 [00:01<00:00,  7.43it/s]
 Test site-3| Test Acc: 0.6269 | Bacc: 0.6164
============ Train epoch 55 ============
0 0
cla loss:  2.7176536291687934 trans loss: 0.8143416448454162
0 0
cla loss:  2.6803317956588977 trans loss: 0.813607433033948
0 0
cla loss:  2.6963800617198848 trans loss: 0.8103665523792631

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:04,  7.08it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.80it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.80it/s]
 11%|█         | 4/36 [00:00<00:04,  6.84it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.71it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.73it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.72it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.67it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.67it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.74it/s]
 31%|███       | 11/36 [00:01<00:03,  6.69it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.59it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.48it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.41it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.45it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.34it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.48it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.47it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.63it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.57it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.63it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.58it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.65it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.64it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.66it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.63it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.72it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.78it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.75it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.67it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.60it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.57it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.46it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.51it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.73it/s]
100%|██████████| 36/36 [00:05<00:00,  6.71it/s]
100%|██████████| 36/36 [00:05<00:00,  6.63it/s]
 Site-0| Train Acc: 0.8741

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.60it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.73it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.74it/s]
100%|██████████| 4/4 [00:00<00:00,  6.76it/s]
100%|██████████| 4/4 [00:00<00:00,  6.74it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.02it/s]
 20%|██        | 2/10 [00:00<00:01,  6.47it/s]
 30%|███       | 3/10 [00:00<00:01,  6.34it/s]
 40%|████      | 4/10 [00:00<00:00,  6.62it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.68it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.63it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.47it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.28it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.52it/s]
100%|██████████| 10/10 [00:01<00:00,  6.63it/s]
100%|██████████| 10/10 [00:01<00:00,  6.52it/s]
 Site-1| Train Acc: 0.8781

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.81it/s]
100%|██████████| 1/1 [00:00<00:00,  6.79it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.21it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.57it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.51it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.40it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.17it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.09it/s]
 30%|███       | 7/23 [00:01<00:02,  6.24it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.37it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.37it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.58it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.70it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.58it/s]
 57%|█████▋    | 13/23 [00:02<00:01,  6.64it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.54it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.63it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.30it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.39it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.40it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.41it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.57it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.46it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.65it/s]
100%|██████████| 23/23 [00:03<00:00,  6.68it/s]
100%|██████████| 23/23 [00:03<00:00,  6.48it/s]
 Site-2| Train Acc: 0.8628

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.77it/s]
100%|██████████| 2/2 [00:00<00:00,  6.78it/s]
100%|██████████| 2/2 [00:00<00:00,  6.77it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.21it/s]
 40%|████      | 2/5 [00:00<00:00,  6.66it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.16it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.34it/s]
100%|██████████| 5/5 [00:00<00:00,  6.94it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8688

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.55it/s]
100%|██████████| 2/2 [00:00<00:00,  9.89it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.60it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.54it/s]
100%|██████████| 3/3 [00:00<00:00,  6.63it/s]
100%|██████████| 3/3 [00:00<00:00,  6.61it/s]
 Test site-2| Test Acc: 0.7979 | Bacc: 0.8070

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.97it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.29it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.99it/s]
 31%|███       | 4/13 [00:00<00:01,  7.01it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.36it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.52it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.73it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.19it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  6.95it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  5.86it/s]
100%|██████████| 13/13 [00:01<00:00,  7.25it/s]
 Test site-3| Test Acc: 0.6294 | Bacc: 0.6182
============ Train epoch 56 ============
0 0
cla loss:  2.71942458440311 trans loss: 0.8094569264943875
0 0
cla loss:  2.682792169963894 trans loss: 0.8052548601399714
0 0
cla loss:  2.6987568409598652 trans loss: 0.7955186064518875

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.71it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.61it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.65it/s]
 11%|█         | 4/36 [00:00<00:04,  6.68it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.85it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.73it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.68it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.72it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.79it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.78it/s]
 31%|███       | 11/36 [00:01<00:03,  6.67it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.61it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.51it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.59it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.65it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.62it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.68it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.55it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.49it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.48it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.55it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.46it/s]
 64%|██████▍   | 23/36 [00:03<00:02,  6.47it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.55it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.53it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.51it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.54it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.60it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.64it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.67it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.64it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.75it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.71it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.73it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.80it/s]
100%|██████████| 36/36 [00:05<00:00,  6.76it/s]
100%|██████████| 36/36 [00:05<00:00,  6.64it/s]
 Site-0| Train Acc: 0.8767

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.60it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.52it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.63it/s]
100%|██████████| 4/4 [00:00<00:00,  6.70it/s]
100%|██████████| 4/4 [00:00<00:00,  6.65it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.77it/s]
 20%|██        | 2/10 [00:00<00:01,  6.49it/s]
 30%|███       | 3/10 [00:00<00:01,  6.34it/s]
 40%|████      | 4/10 [00:00<00:00,  6.49it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.60it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.70it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.66it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.55it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.66it/s]
100%|██████████| 10/10 [00:01<00:00,  6.61it/s]
100%|██████████| 10/10 [00:01<00:00,  6.59it/s]
 Site-1| Train Acc: 0.8719

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.60it/s]
100%|██████████| 1/1 [00:00<00:00,  6.58it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.65it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.75it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.86it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.80it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.80it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.45it/s]
 30%|███       | 7/23 [00:01<00:02,  6.64it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.64it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.66it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.68it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.73it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.77it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.64it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.61it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.66it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.66it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.65it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.70it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.68it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.52it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.59it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.37it/s]
100%|██████████| 23/23 [00:03<00:00,  6.51it/s]
100%|██████████| 23/23 [00:03<00:00,  6.63it/s]
 Site-2| Train Acc: 0.8668

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.82it/s]
100%|██████████| 2/2 [00:00<00:00,  6.63it/s]
100%|██████████| 2/2 [00:00<00:00,  6.65it/s]
 Site-2| Val  Acc: 0.8906

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.36it/s]
 40%|████      | 2/5 [00:00<00:00,  6.83it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.24it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.53it/s]
100%|██████████| 5/5 [00:00<00:00,  7.13it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8745

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.77it/s]
100%|██████████| 2/2 [00:00<00:00, 10.22it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.69it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.68it/s]
100%|██████████| 3/3 [00:00<00:00,  6.80it/s]
100%|██████████| 3/3 [00:00<00:00,  6.76it/s]
 Test site-2| Test Acc: 0.7979 | Bacc: 0.8070

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.86it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.23it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.10it/s]
 31%|███       | 4/13 [00:00<00:01,  7.12it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.45it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.63it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.76it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.30it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.23it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.12it/s]
100%|██████████| 13/13 [00:01<00:00,  7.43it/s]
 Test site-3| Test Acc: 0.6244 | Bacc: 0.6121
============ Train epoch 57 ============
0 0
cla loss:  2.719129579151096 trans loss: 0.8156179402341794
0 0
cla loss:  2.680560708645001 trans loss: 0.8127682882936755
0 0
cla loss:  2.703578444581535 trans loss: 0.8059374740974388

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.85it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.71it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.74it/s]
 11%|█         | 4/36 [00:00<00:04,  6.62it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.68it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.55it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.74it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.88it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.78it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.75it/s]
 31%|███       | 11/36 [00:01<00:03,  6.64it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.57it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.61it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.66it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.64it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.73it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.73it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.64it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.59it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.67it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.55it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.48it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.52it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.35it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.47it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.50it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.43it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.48it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.55it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.55it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.53it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.60it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.73it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.63it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.68it/s]
100%|██████████| 36/36 [00:05<00:00,  6.42it/s]
100%|██████████| 36/36 [00:05<00:00,  6.59it/s]
 Site-0| Train Acc: 0.8741

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.87it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.86it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.91it/s]
100%|██████████| 4/4 [00:00<00:00,  6.97it/s]
100%|██████████| 4/4 [00:00<00:00,  6.94it/s]
 Site-0| Val  Acc: 0.8125

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.66it/s]
 20%|██        | 2/10 [00:00<00:01,  6.57it/s]
 30%|███       | 3/10 [00:00<00:01,  6.88it/s]
 40%|████      | 4/10 [00:00<00:00,  6.80it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.64it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.71it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.72it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.75it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.89it/s]
100%|██████████| 10/10 [00:01<00:00,  6.90it/s]
100%|██████████| 10/10 [00:01<00:00,  6.79it/s]
 Site-1| Train Acc: 0.8719

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.77it/s]
100%|██████████| 1/1 [00:00<00:00,  6.75it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.71it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.61it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.56it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.73it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.66it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.61it/s]
 30%|███       | 7/23 [00:01<00:02,  6.48it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.40it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.57it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.65it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.76it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.74it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.68it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.62it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.71it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.74it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.46it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.56it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.50it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.52it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.57it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.60it/s]
100%|██████████| 23/23 [00:03<00:00,  6.68it/s]
100%|██████████| 23/23 [00:03<00:00,  6.62it/s]
 Site-2| Train Acc: 0.8736

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.71it/s]
100%|██████████| 2/2 [00:00<00:00,  6.58it/s]
100%|██████████| 2/2 [00:00<00:00,  6.59it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.21it/s]
 40%|████      | 2/5 [00:00<00:00,  6.66it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.22it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.53it/s]
100%|██████████| 5/5 [00:00<00:00,  7.08it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8745

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.88it/s]
100%|██████████| 2/2 [00:00<00:00, 10.29it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.31it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.38it/s]
100%|██████████| 3/3 [00:00<00:00,  6.53it/s]
100%|██████████| 3/3 [00:00<00:00,  6.48it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7981

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.01it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.33it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.11it/s]
 31%|███       | 4/13 [00:00<00:01,  7.06it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.40it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.60it/s]
 54%|█████▍    | 7/13 [00:00<00:00,  8.03it/s]
 69%|██████▉   | 9/13 [00:01<00:00,  8.77it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  8.89it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  6.57it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  5.64it/s]
100%|██████████| 13/13 [00:01<00:00,  7.21it/s]
 Test site-3| Test Acc: 0.6396 | Bacc: 0.6326
============ Train epoch 58 ============
0 0
cla loss:  2.722764123025252 trans loss: 0.8119728646086688
0 0
cla loss:  2.683225128518876 trans loss: 0.804029512944533
0 0
cla loss:  2.6980217952824117 trans loss: 0.8044898465051123

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.96it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.02it/s]
  8%|▊         | 3/36 [00:00<00:05,  6.23it/s]
 11%|█         | 4/36 [00:00<00:04,  6.57it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.64it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.72it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.67it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.56it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.50it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.57it/s]
 31%|███       | 11/36 [00:01<00:03,  6.54it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.62it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.70it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.61it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.66it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.70it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.69it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.75it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.83it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.85it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.82it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.88it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.69it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.71it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.73it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.61it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.52it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.68it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.73it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.75it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.69it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.87it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.79it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.57it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.66it/s]
100%|██████████| 36/36 [00:05<00:00,  6.68it/s]
100%|██████████| 36/36 [00:05<00:00,  6.67it/s]
 Site-0| Train Acc: 0.8785

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.53it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.61it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.62it/s]
100%|██████████| 4/4 [00:00<00:00,  6.66it/s]
100%|██████████| 4/4 [00:00<00:00,  6.63it/s]
 Site-0| Val  Acc: 0.7891

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.30it/s]
 20%|██        | 2/10 [00:00<00:01,  6.52it/s]
 30%|███       | 3/10 [00:00<00:01,  6.48it/s]
 40%|████      | 4/10 [00:00<00:00,  6.49it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.46it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.65it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.72it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.68it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.70it/s]
100%|██████████| 10/10 [00:01<00:00,  6.65it/s]
100%|██████████| 10/10 [00:01<00:00,  6.60it/s]
 Site-1| Train Acc: 0.8812

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.92it/s]
100%|██████████| 1/1 [00:00<00:00,  6.90it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.62it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.61it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.45it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.57it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.59it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.68it/s]
 30%|███       | 7/23 [00:01<00:02,  6.59it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.51it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.61it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.63it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.77it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.60it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.50it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.63it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.69it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.66it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.63it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.40it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.50it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.57it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.69it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.70it/s]
100%|██████████| 23/23 [00:03<00:00,  6.36it/s]
100%|██████████| 23/23 [00:03<00:00,  6.56it/s]
 Site-2| Train Acc: 0.8736

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.80it/s]
100%|██████████| 2/2 [00:00<00:00,  6.68it/s]
100%|██████████| 2/2 [00:00<00:00,  6.69it/s]
 Site-2| Val  Acc: 0.9375

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.24it/s]
 40%|████      | 2/5 [00:00<00:00,  6.71it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.24it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.50it/s]
100%|██████████| 5/5 [00:00<00:00,  6.96it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8742

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.57it/s]
100%|██████████| 2/2 [00:00<00:00,  9.97it/s]
 Test site-1| Test Acc: 0.8810 | Bacc: 0.8864

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.12it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.42it/s]
100%|██████████| 3/3 [00:00<00:00,  6.61it/s]
100%|██████████| 3/3 [00:00<00:00,  6.52it/s]
 Test site-2| Test Acc: 0.8085 | Bacc: 0.8181

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.06it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.37it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.16it/s]
 31%|███       | 4/13 [00:00<00:01,  7.11it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.37it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.41it/s]
 54%|█████▍    | 7/13 [00:00<00:00,  7.89it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.35it/s]
 69%|██████▉   | 9/13 [00:01<00:00,  8.68it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  8.88it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  6.49it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  5.58it/s]
100%|██████████| 13/13 [00:01<00:00,  7.23it/s]
 Test site-3| Test Acc: 0.6244 | Bacc: 0.6117
============ Train epoch 59 ============
0 0
cla loss:  2.7143947754673023 trans loss: 0.8150982530272786
0 0
cla loss:  2.6875412727720174 trans loss: 0.8223566475825094
0 0
cla loss:  2.704330512626686 trans loss: 0.8139597797513607

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.62it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.56it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.73it/s]
 11%|█         | 4/36 [00:00<00:04,  6.69it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.80it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.63it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.69it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.83it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.79it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.73it/s]
 31%|███       | 11/36 [00:01<00:03,  6.70it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.75it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.70it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.82it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.75it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.80it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.88it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.84it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.86it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.87it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.61it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.49it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.59it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.55it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.70it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.66it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.73it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.59it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.60it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.56it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.50it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.41it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.57it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.68it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.66it/s]
100%|██████████| 36/36 [00:05<00:00,  6.77it/s]
100%|██████████| 36/36 [00:05<00:00,  6.69it/s]
 Site-0| Train Acc: 0.8724

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.66it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.58it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.73it/s]
100%|██████████| 4/4 [00:00<00:00,  6.77it/s]
100%|██████████| 4/4 [00:00<00:00,  6.73it/s]
 Site-0| Val  Acc: 0.8203

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.66it/s]
 20%|██        | 2/10 [00:00<00:01,  6.68it/s]
 30%|███       | 3/10 [00:00<00:01,  6.65it/s]
 40%|████      | 4/10 [00:00<00:00,  6.72it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.73it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.65it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.49it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.58it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.55it/s]
100%|██████████| 10/10 [00:01<00:00,  6.65it/s]
100%|██████████| 10/10 [00:01<00:00,  6.63it/s]
 Site-1| Train Acc: 0.8781

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.84it/s]
100%|██████████| 1/1 [00:00<00:00,  6.82it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.56it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.61it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.56it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.42it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.34it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.46it/s]
 30%|███       | 7/23 [00:01<00:02,  6.51it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.60it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.36it/s]
 43%|████▎     | 10/23 [00:01<00:02,  6.40it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.50it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.54it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.57it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.62it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.59it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.56it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.52it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.40it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.53it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.54it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.68it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.73it/s]
100%|██████████| 23/23 [00:03<00:00,  6.73it/s]
100%|██████████| 23/23 [00:03<00:00,  6.55it/s]
 Site-2| Train Acc: 0.8736

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.61it/s]
100%|██████████| 2/2 [00:00<00:00,  6.53it/s]
100%|██████████| 2/2 [00:00<00:00,  6.53it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.13it/s]
 40%|████      | 2/5 [00:00<00:00,  6.67it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.16it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.46it/s]
100%|██████████| 5/5 [00:00<00:00,  7.03it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8685

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.66it/s]
100%|██████████| 2/2 [00:00<00:00, 10.05it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.56it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.53it/s]
100%|██████████| 3/3 [00:00<00:00,  6.63it/s]
100%|██████████| 3/3 [00:00<00:00,  6.60it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7981

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.95it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.33it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.12it/s]
 31%|███       | 4/13 [00:00<00:01,  7.11it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.46it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.68it/s]
 62%|██████▏   | 8/13 [00:00<00:00,  8.84it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.51it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.20it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.02it/s]
100%|██████████| 13/13 [00:01<00:00,  7.42it/s]
 Test site-3| Test Acc: 0.6320 | Bacc: 0.6195
============ Train epoch 60 ============
0 0
cla loss:  2.7152605512034356 trans loss: 0.8118589205957537
0 0
cla loss:  2.6830137554724613 trans loss: 0.8134655149737794
0 0
cla loss:  2.7028752176006834 trans loss: 0.8059884387644092

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:04,  7.01it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.93it/s]
  8%|▊         | 3/36 [00:00<00:04,  7.11it/s]
 11%|█         | 4/36 [00:00<00:04,  7.01it/s]
 14%|█▍        | 5/36 [00:00<00:04,  7.08it/s]
 17%|█▋        | 6/36 [00:00<00:04,  7.11it/s]
 19%|█▉        | 7/36 [00:00<00:04,  6.95it/s]
 22%|██▏       | 8/36 [00:01<00:03,  7.02it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.98it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.90it/s]
 31%|███       | 11/36 [00:01<00:03,  6.80it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.55it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.54it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.58it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.62it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.61it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.55it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.60it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.63it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.56it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.69it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.65it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.67it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.68it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.59it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.54it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.55it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.64it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.67it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.62it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.64it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.69it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.74it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.80it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.80it/s]
100%|██████████| 36/36 [00:05<00:00,  6.71it/s]
100%|██████████| 36/36 [00:05<00:00,  6.72it/s]
 Site-0| Train Acc: 0.8724

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.38it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.48it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.65it/s]
100%|██████████| 4/4 [00:00<00:00,  6.76it/s]
100%|██████████| 4/4 [00:00<00:00,  6.67it/s]
 Site-0| Val  Acc: 0.8047

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.26it/s]
 20%|██        | 2/10 [00:00<00:01,  6.63it/s]
 30%|███       | 3/10 [00:00<00:01,  6.59it/s]
 40%|████      | 4/10 [00:00<00:00,  6.73it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.57it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.63it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.72it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.91it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.93it/s]
100%|██████████| 10/10 [00:01<00:00,  6.84it/s]
100%|██████████| 10/10 [00:01<00:00,  6.74it/s]
 Site-1| Train Acc: 0.8750

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.79it/s]
100%|██████████| 1/1 [00:00<00:00,  6.77it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.57it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.69it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.37it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.57it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.58it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.63it/s]
 30%|███       | 7/23 [00:01<00:02,  6.58it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.48it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.46it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.55it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.49it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.63it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.73it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.81it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.65it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.66it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.61it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.64it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.44it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.64it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.62it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.67it/s]
100%|██████████| 23/23 [00:03<00:00,  6.73it/s]
100%|██████████| 23/23 [00:03<00:00,  6.61it/s]
 Site-2| Train Acc: 0.8696

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.87it/s]
100%|██████████| 2/2 [00:00<00:00,  6.68it/s]
100%|██████████| 2/2 [00:00<00:00,  6.70it/s]
 Site-2| Val  Acc: 0.8906

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.17it/s]
 40%|████      | 2/5 [00:00<00:00,  6.68it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.10it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.38it/s]
100%|██████████| 5/5 [00:00<00:00,  7.00it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8685

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.86it/s]
100%|██████████| 2/2 [00:00<00:00, 10.29it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.86it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.80it/s]
100%|██████████| 3/3 [00:00<00:00,  6.89it/s]
100%|██████████| 3/3 [00:00<00:00,  6.87it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7843

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.30it/s]
 15%|█▌        | 2/13 [00:00<00:01,  6.98it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.80it/s]
 31%|███       | 4/13 [00:00<00:01,  6.53it/s]
 38%|███▊      | 5/13 [00:00<00:01,  6.74it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.08it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.37it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.14it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.10it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.10it/s]
100%|██████████| 13/13 [00:01<00:00,  7.20it/s]
 Test site-3| Test Acc: 0.6244 | Bacc: 0.6097
============ Train epoch 61 ============
0 0
cla loss:  2.7142889295990145 trans loss: 0.8185080247907782
0 0
cla loss:  2.683521951263274 trans loss: 0.8258627913705069
0 0
cla loss:  2.701938753751055 trans loss: 0.808138034451547

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.55it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.60it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.81it/s]
 11%|█         | 4/36 [00:00<00:04,  6.76it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.82it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.66it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.72it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.70it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.82it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.89it/s]
 31%|███       | 11/36 [00:01<00:03,  6.80it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.70it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.65it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.55it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.56it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.55it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.50it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.53it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.47it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.53it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.57it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.72it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.73it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.77it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.61it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.51it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.52it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.52it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.61it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.59it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.70it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.72it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.82it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.81it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.92it/s]
100%|██████████| 36/36 [00:05<00:00,  6.85it/s]
100%|██████████| 36/36 [00:05<00:00,  6.68it/s]
 Site-0| Train Acc: 0.8715

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.63it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.68it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.79it/s]
100%|██████████| 4/4 [00:00<00:00,  6.75it/s]
100%|██████████| 4/4 [00:00<00:00,  6.74it/s]
 Site-0| Val  Acc: 0.8047

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.94it/s]
 20%|██        | 2/10 [00:00<00:01,  6.99it/s]
 30%|███       | 3/10 [00:00<00:01,  6.42it/s]
 40%|████      | 4/10 [00:00<00:00,  6.55it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.68it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.57it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.53it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.61it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.68it/s]
100%|██████████| 10/10 [00:01<00:00,  6.71it/s]
100%|██████████| 10/10 [00:01<00:00,  6.65it/s]
 Site-1| Train Acc: 0.8812

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.76it/s]
100%|██████████| 1/1 [00:00<00:00,  6.74it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  7.19it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.87it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.90it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.82it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.84it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.62it/s]
 30%|███       | 7/23 [00:01<00:02,  6.64it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.60it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.40it/s]
 43%|████▎     | 10/23 [00:01<00:02,  6.43it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.41it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.32it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.43it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.42it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.51it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.53it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.60it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.52it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.58it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.62it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.39it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.53it/s]
100%|██████████| 23/23 [00:03<00:00,  6.57it/s]
100%|██████████| 23/23 [00:03<00:00,  6.56it/s]
 Site-2| Train Acc: 0.8655

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.83it/s]
100%|██████████| 2/2 [00:00<00:00,  6.52it/s]
100%|██████████| 2/2 [00:00<00:00,  6.56it/s]
 Site-2| Val  Acc: 0.8906

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.10it/s]
 40%|████      | 2/5 [00:00<00:00,  6.66it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.11it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.37it/s]
100%|██████████| 5/5 [00:00<00:00,  6.97it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8685

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.56it/s]
100%|██████████| 2/2 [00:00<00:00,  9.90it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.75it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.67it/s]
100%|██████████| 3/3 [00:00<00:00,  6.69it/s]
100%|██████████| 3/3 [00:00<00:00,  6.69it/s]
 Test site-2| Test Acc: 0.7979 | Bacc: 0.8070

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.97it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.31it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.09it/s]
 31%|███       | 4/13 [00:00<00:01,  7.04it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.40it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.62it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.80it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.46it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.31it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.20it/s]
100%|██████████| 13/13 [00:01<00:00,  7.49it/s]
 Test site-3| Test Acc: 0.6244 | Bacc: 0.6097
============ Train epoch 62 ============
0 0
cla loss:  2.7154090644127162 trans loss: 0.8125613262904948
0 0
cla loss:  2.6866382330506293 trans loss: 0.81943941475758
0 0
cla loss:  2.6964693440863834 trans loss: 0.8036909864176458

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.49it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.63it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.73it/s]
 11%|█         | 4/36 [00:00<00:04,  6.79it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.75it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.88it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.79it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.72it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.81it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.67it/s]
 31%|███       | 11/36 [00:01<00:03,  6.64it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.59it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.67it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.80it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.79it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.78it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.76it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.70it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.69it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.63it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.75it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.71it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.72it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.70it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.61it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.59it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.62it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.68it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.68it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.75it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.82it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.78it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.81it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.83it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.82it/s]
100%|██████████| 36/36 [00:05<00:00,  6.76it/s]
100%|██████████| 36/36 [00:05<00:00,  6.73it/s]
 Site-0| Train Acc: 0.8715

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.78it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.62it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.73it/s]
100%|██████████| 4/4 [00:00<00:00,  6.83it/s]
100%|██████████| 4/4 [00:00<00:00,  6.77it/s]
 Site-0| Val  Acc: 0.8047

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.82it/s]
 20%|██        | 2/10 [00:00<00:01,  7.08it/s]
 30%|███       | 3/10 [00:00<00:01,  6.88it/s]
 40%|████      | 4/10 [00:00<00:00,  6.86it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.70it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.77it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.57it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.56it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.47it/s]
100%|██████████| 10/10 [00:01<00:00,  6.60it/s]
100%|██████████| 10/10 [00:01<00:00,  6.67it/s]
 Site-1| Train Acc: 0.8844

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.96it/s]
100%|██████████| 1/1 [00:00<00:00,  6.94it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.72it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.62it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.73it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.75it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.79it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.80it/s]
 30%|███       | 7/23 [00:01<00:02,  6.74it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.71it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.66it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.58it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.66it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.68it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.69it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.73it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.45it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.48it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.60it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.59it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.62it/s]
 87%|████████▋ | 20/23 [00:02<00:00,  6.74it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.72it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.64it/s]
100%|██████████| 23/23 [00:03<00:00,  6.54it/s]
100%|██████████| 23/23 [00:03<00:00,  6.64it/s]
 Site-2| Train Acc: 0.8736

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.70it/s]
100%|██████████| 2/2 [00:00<00:00,  6.41it/s]
100%|██████████| 2/2 [00:00<00:00,  6.44it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.20it/s]
 40%|████      | 2/5 [00:00<00:00,  6.54it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.11it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.39it/s]
100%|██████████| 5/5 [00:00<00:00,  6.98it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8685

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.79it/s]
100%|██████████| 2/2 [00:00<00:00, 10.24it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.77it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.68it/s]
100%|██████████| 3/3 [00:00<00:00,  6.75it/s]
100%|██████████| 3/3 [00:00<00:00,  6.73it/s]
 Test site-2| Test Acc: 0.7766 | Bacc: 0.7754

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.86it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.21it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.06it/s]
 31%|███       | 4/13 [00:00<00:01,  7.06it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.33it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.51it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.65it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.23it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.22it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.21it/s]
100%|██████████| 13/13 [00:01<00:00,  7.44it/s]
 Test site-3| Test Acc: 0.6294 | Bacc: 0.6174
============ Train epoch 63 ============
0 0
cla loss:  2.712822916519702 trans loss: 0.8117943876352741
0 0
cla loss:  2.6825192981029873 trans loss: 0.8043126409976327
0 0
cla loss:  2.7038645612534564 trans loss: 0.822655079053275

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.58it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.74it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.86it/s]
 11%|█         | 4/36 [00:00<00:04,  6.83it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.91it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.89it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.92it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.86it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.91it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.88it/s]
 31%|███       | 11/36 [00:01<00:03,  6.91it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.93it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.93it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.75it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.68it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.71it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.79it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.82it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.82it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.79it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.75it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.70it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.79it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.90it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.64it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.68it/s]
 75%|███████▌  | 27/36 [00:03<00:01,  6.71it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.74it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.72it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.73it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.79it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.66it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.60it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.75it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.78it/s]
100%|██████████| 36/36 [00:05<00:00,  6.73it/s]
100%|██████████| 36/36 [00:05<00:00,  6.78it/s]
 Site-0| Train Acc: 0.8715

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.80it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.70it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.75it/s]
100%|██████████| 4/4 [00:00<00:00,  6.76it/s]
100%|██████████| 4/4 [00:00<00:00,  6.75it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.44it/s]
 20%|██        | 2/10 [00:00<00:01,  6.43it/s]
 30%|███       | 3/10 [00:00<00:01,  6.51it/s]
 40%|████      | 4/10 [00:00<00:00,  6.55it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.44it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.45it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.46it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.64it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.65it/s]
100%|██████████| 10/10 [00:01<00:00,  6.62it/s]
100%|██████████| 10/10 [00:01<00:00,  6.55it/s]
 Site-1| Train Acc: 0.8750

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.85it/s]
100%|██████████| 1/1 [00:00<00:00,  6.83it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.67it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.75it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.71it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.81it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.84it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.66it/s]
 30%|███       | 7/23 [00:01<00:02,  6.77it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.86it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.76it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.72it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.76it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.79it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.66it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.77it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.66it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.50it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.49it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.56it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.72it/s]
 87%|████████▋ | 20/23 [00:02<00:00,  6.83it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.71it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.68it/s]
100%|██████████| 23/23 [00:03<00:00,  6.75it/s]
100%|██████████| 23/23 [00:03<00:00,  6.71it/s]
 Site-2| Train Acc: 0.8682

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.64it/s]
100%|██████████| 2/2 [00:00<00:00,  6.67it/s]
100%|██████████| 2/2 [00:00<00:00,  6.66it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.35it/s]
 40%|████      | 2/5 [00:00<00:00,  6.82it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.26it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.54it/s]
100%|██████████| 5/5 [00:00<00:00,  7.13it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8745

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.79it/s]
100%|██████████| 2/2 [00:00<00:00, 10.23it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.75it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.74it/s]
100%|██████████| 3/3 [00:00<00:00,  6.83it/s]
100%|██████████| 3/3 [00:00<00:00,  6.80it/s]
 Test site-2| Test Acc: 0.7979 | Bacc: 0.8070

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.44it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.00it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.52it/s]
 31%|███       | 4/13 [00:00<00:01,  6.39it/s]
 38%|███▊      | 5/13 [00:00<00:01,  6.86it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.22it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.46it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.15it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.12it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.12it/s]
100%|██████████| 13/13 [00:01<00:00,  7.22it/s]
 Test site-3| Test Acc: 0.6244 | Bacc: 0.6115
============ Train epoch 64 ============
0 0
cla loss:  2.7143427606803088 trans loss: 0.8113937593584684
0 0
cla loss:  2.683212615736765 trans loss: 0.8139655341455085
0 0
cla loss:  2.7004604818832934 trans loss: 0.8163734884118315

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:04,  7.00it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.83it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.71it/s]
 11%|█         | 4/36 [00:00<00:04,  6.74it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.58it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.58it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.62it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.48it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.53it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.61it/s]
 31%|███       | 11/36 [00:01<00:03,  6.54it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.58it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.63it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.67it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.69it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.57it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.58it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.56it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.66it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.60it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.65it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.72it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.66it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.67it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.64it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.65it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.74it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.72it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.72it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.65it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.65it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.64it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.65it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.63it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.61it/s]
100%|██████████| 36/36 [00:05<00:00,  6.67it/s]
100%|██████████| 36/36 [00:05<00:00,  6.64it/s]
 Site-0| Train Acc: 0.8707

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.76it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.75it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.84it/s]
100%|██████████| 4/4 [00:00<00:00,  6.93it/s]
100%|██████████| 4/4 [00:00<00:00,  6.87it/s]
 Site-0| Val  Acc: 0.8047

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.71it/s]
 20%|██        | 2/10 [00:00<00:01,  6.72it/s]
 30%|███       | 3/10 [00:00<00:01,  6.96it/s]
 40%|████      | 4/10 [00:00<00:00,  6.81it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.78it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.60it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.47it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.41it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.47it/s]
100%|██████████| 10/10 [00:01<00:00,  6.59it/s]
100%|██████████| 10/10 [00:01<00:00,  6.61it/s]
 Site-1| Train Acc: 0.8719

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.89it/s]
100%|██████████| 1/1 [00:00<00:00,  6.88it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.83it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.30it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.53it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.41it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.40it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.60it/s]
 30%|███       | 7/23 [00:01<00:02,  6.67it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.63it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.60it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.62it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.64it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.61it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.65it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.69it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.63it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.60it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.59it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.55it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.52it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.57it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.70it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.66it/s]
100%|██████████| 23/23 [00:03<00:00,  6.76it/s]
100%|██████████| 23/23 [00:03<00:00,  6.62it/s]
 Site-2| Train Acc: 0.8709

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.75it/s]
100%|██████████| 2/2 [00:00<00:00,  6.60it/s]
100%|██████████| 2/2 [00:00<00:00,  6.61it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.16it/s]
 40%|████      | 2/5 [00:00<00:00,  6.63it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.19it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.45it/s]
100%|██████████| 5/5 [00:00<00:00,  7.03it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8745

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.68it/s]
100%|██████████| 2/2 [00:00<00:00, 10.08it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.69it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.62it/s]
100%|██████████| 3/3 [00:00<00:00,  6.71it/s]
100%|██████████| 3/3 [00:00<00:00,  6.69it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7981

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.04it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.36it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.12it/s]
 31%|███       | 4/13 [00:00<00:01,  6.95it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.34it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.58it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.75it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.38it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.30it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.25it/s]
100%|██████████| 13/13 [00:01<00:00,  7.49it/s]
 Test site-3| Test Acc: 0.6168 | Bacc: 0.6046
============ Train epoch 65 ============
0 0
cla loss:  2.7168595024089717 trans loss: 0.8250488593949744
0 0
cla loss:  2.682063123089584 trans loss: 0.8098945578738074
0 0
cla loss:  2.697791337966919 trans loss: 0.8135657711843749

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:04,  7.02it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.88it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.75it/s]
 11%|█         | 4/36 [00:00<00:04,  6.55it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.67it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.62it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.57it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.61it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.55it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.64it/s]
 31%|███       | 11/36 [00:01<00:03,  6.59it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.64it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.67it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.56it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.48it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.54it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.43it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.44it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.48it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.50it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.57it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.71it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.76it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.73it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.71it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.73it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.81it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.74it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.57it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.54it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.47it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.53it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.56it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.56it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.57it/s]
100%|██████████| 36/36 [00:05<00:00,  6.63it/s]
100%|██████████| 36/36 [00:05<00:00,  6.61it/s]
 Site-0| Train Acc: 0.8715

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.73it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.66it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.73it/s]
100%|██████████| 4/4 [00:00<00:00,  6.77it/s]
100%|██████████| 4/4 [00:00<00:00,  6.74it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.99it/s]
 20%|██        | 2/10 [00:00<00:01,  6.94it/s]
 30%|███       | 3/10 [00:00<00:01,  6.82it/s]
 40%|████      | 4/10 [00:00<00:00,  6.67it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.66it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.70it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.71it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.65it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.60it/s]
100%|██████████| 10/10 [00:01<00:00,  6.57it/s]
100%|██████████| 10/10 [00:01<00:00,  6.66it/s]
 Site-1| Train Acc: 0.8812

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.85it/s]
100%|██████████| 1/1 [00:00<00:00,  6.84it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.87it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.68it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.63it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.36it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.40it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.54it/s]
 30%|███       | 7/23 [00:01<00:02,  6.54it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.47it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.47it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.61it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.54it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.54it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.55it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.47it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.62it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.73it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.71it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.74it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.57it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.60it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.72it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.69it/s]
100%|██████████| 23/23 [00:03<00:00,  6.48it/s]
100%|██████████| 23/23 [00:03<00:00,  6.57it/s]
 Site-2| Train Acc: 0.8750

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.59it/s]
100%|██████████| 2/2 [00:00<00:00,  6.48it/s]
100%|██████████| 2/2 [00:00<00:00,  6.49it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.09it/s]
 40%|████      | 2/5 [00:00<00:00,  6.58it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.12it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.38it/s]
100%|██████████| 5/5 [00:00<00:00,  6.95it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8745

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.62it/s]
100%|██████████| 2/2 [00:00<00:00,  9.98it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.61it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.54it/s]
100%|██████████| 3/3 [00:00<00:00,  6.64it/s]
100%|██████████| 3/3 [00:00<00:00,  6.61it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7981

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.93it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.24it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.04it/s]
 31%|███       | 4/13 [00:00<00:01,  7.02it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.36it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.56it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.69it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.35it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.19it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.13it/s]
100%|██████████| 13/13 [00:01<00:00,  7.42it/s]
 Test site-3| Test Acc: 0.6320 | Bacc: 0.6213
============ Train epoch 66 ============
0 0
cla loss:  2.716485357763779 trans loss: 0.8110264461843213
0 0
cla loss:  2.686278986571422 trans loss: 0.828235460885206
0 0
cla loss:  2.7014738902374726 trans loss: 0.8137566998376319

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.66it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.83it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.79it/s]
 11%|█         | 4/36 [00:00<00:04,  6.74it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.79it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.87it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.83it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.83it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.85it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.89it/s]
 31%|███       | 11/36 [00:01<00:03,  6.70it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.76it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.64it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.62it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.57it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.46it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.60it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.58it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.68it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.64it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.56it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.41it/s]
 64%|██████▍   | 23/36 [00:03<00:02,  6.45it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.38it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.51it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.40it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.58it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.56it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.51it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.60it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.73it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.66it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.66it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.68it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.65it/s]
100%|██████████| 36/36 [00:05<00:00,  6.64it/s]
100%|██████████| 36/36 [00:05<00:00,  6.64it/s]
 Site-0| Train Acc: 0.8733

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.76it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.74it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.83it/s]
100%|██████████| 4/4 [00:00<00:00,  6.94it/s]
100%|██████████| 4/4 [00:00<00:00,  6.88it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.51it/s]
 20%|██        | 2/10 [00:00<00:01,  6.69it/s]
 30%|███       | 3/10 [00:00<00:01,  6.62it/s]
 40%|████      | 4/10 [00:00<00:00,  6.78it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.72it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.73it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.67it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.76it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.66it/s]
100%|██████████| 10/10 [00:01<00:00,  6.68it/s]
100%|██████████| 10/10 [00:01<00:00,  6.69it/s]
 Site-1| Train Acc: 0.8719

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  7.08it/s]
100%|██████████| 1/1 [00:00<00:00,  7.06it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.43it/s]
  9%|▊         | 2/23 [00:00<00:02,  7.08it/s]
 13%|█▎        | 3/23 [00:00<00:02,  7.01it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.95it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.64it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.54it/s]
 30%|███       | 7/23 [00:01<00:02,  6.53it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.62it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.49it/s]
 43%|████▎     | 10/23 [00:01<00:02,  6.48it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.43it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.55it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.52it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.52it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.50it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.72it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.63it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.68it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.74it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.74it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.71it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.68it/s]
100%|██████████| 23/23 [00:03<00:00,  6.65it/s]
100%|██████████| 23/23 [00:03<00:00,  6.63it/s]
 Site-2| Train Acc: 0.8723

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.85it/s]
100%|██████████| 2/2 [00:00<00:00,  6.61it/s]
100%|██████████| 2/2 [00:00<00:00,  6.64it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.27it/s]
 40%|████      | 2/5 [00:00<00:00,  6.77it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.20it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.50it/s]
100%|██████████| 5/5 [00:00<00:00,  7.11it/s]
 Test site-0| Test Acc: 0.8571 | Bacc: 0.8801

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.77it/s]
100%|██████████| 2/2 [00:00<00:00, 10.22it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.66it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.65it/s]
100%|██████████| 3/3 [00:00<00:00,  6.77it/s]
100%|██████████| 3/3 [00:00<00:00,  6.74it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7854

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.08it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.36it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.17it/s]
 31%|███       | 4/13 [00:00<00:01,  7.15it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.48it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.68it/s]
 62%|██████▏   | 8/13 [00:00<00:00,  8.84it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.45it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.10it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  5.93it/s]
100%|██████████| 13/13 [00:01<00:00,  7.34it/s]
 Test site-3| Test Acc: 0.6345 | Bacc: 0.6252
============ Train epoch 67 ============
0 0
cla loss:  2.7110680838925156 trans loss: 0.8087719801682324
0 0
cla loss:  2.6854162036474025 trans loss: 0.81733299469828
0 0
cla loss:  2.700000611980956 trans loss: 0.8220414534286039

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.33it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.39it/s]
  8%|▊         | 3/36 [00:00<00:05,  6.52it/s]
 11%|█         | 4/36 [00:00<00:04,  6.60it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.38it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.46it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.60it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.63it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.58it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.69it/s]
 31%|███       | 11/36 [00:01<00:03,  6.72it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.37it/s]
 36%|███▌      | 13/36 [00:02<00:03,  6.21it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.29it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.33it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.34it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.41it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.61it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.70it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.74it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.68it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.74it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.78it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.83it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.74it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.61it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.63it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.60it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.56it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.53it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.33it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.42it/s]
 92%|█████████▏| 33/36 [00:05<00:00,  6.60it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.62it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.60it/s]
100%|██████████| 36/36 [00:05<00:00,  6.44it/s]
100%|██████████| 36/36 [00:05<00:00,  6.54it/s]
 Site-0| Train Acc: 0.8733

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.49it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.53it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.64it/s]
100%|██████████| 4/4 [00:00<00:00,  6.64it/s]
100%|██████████| 4/4 [00:00<00:00,  6.61it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.93it/s]
 20%|██        | 2/10 [00:00<00:01,  6.72it/s]
 30%|███       | 3/10 [00:00<00:01,  6.54it/s]
 40%|████      | 4/10 [00:00<00:00,  6.58it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.60it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.54it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.78it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.71it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.55it/s]
100%|██████████| 10/10 [00:01<00:00,  6.57it/s]
100%|██████████| 10/10 [00:01<00:00,  6.61it/s]
 Site-1| Train Acc: 0.8656

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.65it/s]
100%|██████████| 1/1 [00:00<00:00,  6.63it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.63it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.50it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.63it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.49it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.67it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.65it/s]
 30%|███       | 7/23 [00:01<00:02,  6.61it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.55it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.37it/s]
 43%|████▎     | 10/23 [00:01<00:02,  6.48it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.41it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.57it/s]
 57%|█████▋    | 13/23 [00:02<00:01,  6.38it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.47it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.64it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.64it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.76it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.79it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.70it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.65it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.24it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.34it/s]
100%|██████████| 23/23 [00:03<00:00,  6.57it/s]
100%|██████████| 23/23 [00:03<00:00,  6.55it/s]
 Site-2| Train Acc: 0.8614

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.68it/s]
100%|██████████| 2/2 [00:00<00:00,  6.53it/s]
100%|██████████| 2/2 [00:00<00:00,  6.55it/s]
 Site-2| Val  Acc: 0.8906

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.14it/s]
 40%|████      | 2/5 [00:00<00:00,  6.64it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.04it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.27it/s]
100%|██████████| 5/5 [00:00<00:00,  6.88it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8745

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.58it/s]
100%|██████████| 2/2 [00:00<00:00,  9.91it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.54it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.39it/s]
100%|██████████| 3/3 [00:00<00:00,  6.53it/s]
100%|██████████| 3/3 [00:00<00:00,  6.50it/s]
 Test site-2| Test Acc: 0.7979 | Bacc: 0.8070

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.87it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.07it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.61it/s]
 31%|███       | 4/13 [00:00<00:01,  6.52it/s]
 38%|███▊      | 5/13 [00:00<00:01,  6.89it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.21it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.45it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.16it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.08it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.10it/s]
100%|██████████| 13/13 [00:01<00:00,  7.24it/s]
 Test site-3| Test Acc: 0.6244 | Bacc: 0.6139
============ Train epoch 68 ============
0 0
cla loss:  2.716907593473118 trans loss: 0.8087695261940884
0 0
cla loss:  2.6841340112925773 trans loss: 0.8233196606588125
0 0
cla loss:  2.7043905557699537 trans loss: 0.8078460345915215

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.49it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.59it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.76it/s]
 11%|█         | 4/36 [00:00<00:04,  6.83it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.98it/s]
 17%|█▋        | 6/36 [00:00<00:04,  7.08it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.89it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.90it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.75it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.86it/s]
 31%|███       | 11/36 [00:01<00:03,  6.90it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.84it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.82it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.68it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.56it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.68it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.72it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.68it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.69it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.59it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.65it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.63it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.68it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.54it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.43it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.38it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.31it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.42it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.51it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.53it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.67it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.71it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.68it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.44it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.52it/s]
100%|██████████| 36/36 [00:05<00:00,  6.54it/s]
100%|██████████| 36/36 [00:05<00:00,  6.65it/s]
 Site-0| Train Acc: 0.8715

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.56it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.45it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.60it/s]
100%|██████████| 4/4 [00:00<00:00,  6.71it/s]
100%|██████████| 4/4 [00:00<00:00,  6.64it/s]
 Site-0| Val  Acc: 0.8125

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.61it/s]
 20%|██        | 2/10 [00:00<00:01,  6.73it/s]
 30%|███       | 3/10 [00:00<00:01,  6.72it/s]
 40%|████      | 4/10 [00:00<00:00,  6.71it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.69it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.68it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.80it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.74it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.70it/s]
100%|██████████| 10/10 [00:01<00:00,  6.69it/s]
100%|██████████| 10/10 [00:01<00:00,  6.70it/s]
 Site-1| Train Acc: 0.8781

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.99it/s]
100%|██████████| 1/1 [00:00<00:00,  6.97it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.52it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.80it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.81it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.94it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.74it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.44it/s]
 30%|███       | 7/23 [00:01<00:02,  6.50it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.67it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.54it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.54it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.63it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.60it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.61it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.61it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.65it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.54it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.63it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.37it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.51it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.62it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.60it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.61it/s]
100%|██████████| 23/23 [00:03<00:00,  6.71it/s]
100%|██████████| 23/23 [00:03<00:00,  6.62it/s]
 Site-2| Train Acc: 0.8682

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.65it/s]
100%|██████████| 2/2 [00:00<00:00,  6.46it/s]
100%|██████████| 2/2 [00:00<00:00,  6.48it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.33it/s]
 40%|████      | 2/5 [00:00<00:00,  6.80it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.23it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.52it/s]
100%|██████████| 5/5 [00:00<00:00,  7.08it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8688

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.62it/s]
100%|██████████| 2/2 [00:00<00:00,  9.93it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.76it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.67it/s]
100%|██████████| 3/3 [00:00<00:00,  6.78it/s]
100%|██████████| 3/3 [00:00<00:00,  6.76it/s]
 Test site-2| Test Acc: 0.7766 | Bacc: 0.7754

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.06it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.38it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.18it/s]
 31%|███       | 4/13 [00:00<00:01,  7.02it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.13it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.24it/s]
 54%|█████▍    | 7/13 [00:00<00:00,  7.75it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.20it/s]
 69%|██████▉   | 9/13 [00:01<00:00,  8.53it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  8.75it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  6.29it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  5.49it/s]
100%|██████████| 13/13 [00:01<00:00,  7.12it/s]
 Test site-3| Test Acc: 0.6396 | Bacc: 0.6326
============ Train epoch 69 ============
0 0
cla loss:  2.714567156892326 trans loss: 0.8158557121478134
0 0
cla loss:  2.682310618347858 trans loss: 0.8092431156479534
0 0
cla loss:  2.699119987200253 trans loss: 0.8054524135949025

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.65it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.63it/s]
  8%|▊         | 3/36 [00:00<00:05,  6.60it/s]
 11%|█         | 4/36 [00:00<00:04,  6.50it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.56it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.75it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.65it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.70it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.61it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.66it/s]
 31%|███       | 11/36 [00:01<00:03,  6.34it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.36it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.36it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.36it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.32it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.40it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.43it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.46it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.62it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.67it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.54it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.59it/s]
 64%|██████▍   | 23/36 [00:03<00:02,  6.42it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.47it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.06it/s]
 72%|███████▏  | 26/36 [00:04<00:01,  6.22it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.27it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.44it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.45it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.35it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.39it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.44it/s]
 92%|█████████▏| 33/36 [00:05<00:00,  6.38it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.45it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.49it/s]
100%|██████████| 36/36 [00:05<00:00,  6.63it/s]
100%|██████████| 36/36 [00:05<00:00,  6.47it/s]
 Site-0| Train Acc: 0.8741

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.37it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.20it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.45it/s]
100%|██████████| 4/4 [00:00<00:00,  5.99it/s]
100%|██████████| 4/4 [00:00<00:00,  6.11it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.80it/s]
 20%|██        | 2/10 [00:00<00:01,  6.77it/s]
 30%|███       | 3/10 [00:00<00:01,  6.77it/s]
 40%|████      | 4/10 [00:00<00:00,  6.73it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.67it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.63it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.69it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.69it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.55it/s]
100%|██████████| 10/10 [00:01<00:00,  6.65it/s]
100%|██████████| 10/10 [00:01<00:00,  6.67it/s]
 Site-1| Train Acc: 0.8688

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.77it/s]
100%|██████████| 1/1 [00:00<00:00,  6.75it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.60it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.81it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.62it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.62it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.70it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.67it/s]
 30%|███       | 7/23 [00:01<00:02,  6.46it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.61it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.47it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.56it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.40it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.51it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.55it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.60it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.61it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.57it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.40it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.46it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.46it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.54it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.64it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.50it/s]
100%|██████████| 23/23 [00:03<00:00,  6.58it/s]
100%|██████████| 23/23 [00:03<00:00,  6.55it/s]
 Site-2| Train Acc: 0.8709

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.74it/s]
100%|██████████| 2/2 [00:00<00:00,  6.52it/s]
100%|██████████| 2/2 [00:00<00:00,  6.55it/s]
 Site-2| Val  Acc: 0.8906

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  5.76it/s]
 40%|████      | 2/5 [00:00<00:00,  6.53it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.15it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.31it/s]
100%|██████████| 5/5 [00:00<00:00,  6.84it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8688

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.33it/s]
100%|██████████| 2/2 [00:00<00:00,  9.68it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.67it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.49it/s]
100%|██████████| 3/3 [00:00<00:00,  6.55it/s]
100%|██████████| 3/3 [00:00<00:00,  6.54it/s]
 Test site-2| Test Acc: 0.7979 | Bacc: 0.8070

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.72it/s]
 15%|█▌        | 2/13 [00:00<00:01,  6.62it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.65it/s]
 31%|███       | 4/13 [00:00<00:01,  6.46it/s]
 38%|███▊      | 5/13 [00:00<00:01,  6.93it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.27it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.51it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.18it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.18it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.12it/s]
100%|██████████| 13/13 [00:01<00:00,  7.22it/s]
 Test site-3| Test Acc: 0.6244 | Bacc: 0.6121
============ Train epoch 70 ============
0 0
cla loss:  2.7169727524321283 trans loss: 0.8218313901867699
0 0
cla loss:  2.6825814714383838 trans loss: 0.8101668414758079
0 0
cla loss:  2.7030538745860957 trans loss: 0.8144280158694664

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:04,  7.04it/s]
  6%|▌         | 2/36 [00:00<00:04,  7.04it/s]
  8%|▊         | 3/36 [00:00<00:04,  7.02it/s]
 11%|█         | 4/36 [00:00<00:04,  6.89it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.79it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.80it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.55it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.61it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.67it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.69it/s]
 31%|███       | 11/36 [00:01<00:03,  6.65it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.65it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.65it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.51it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.56it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.49it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.47it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.47it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.57it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.56it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.57it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.77it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.66it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.57it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.55it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.54it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.46it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.54it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.58it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.56it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.53it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.54it/s]
 92%|█████████▏| 33/36 [00:05<00:00,  6.41it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.51it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.32it/s]
100%|██████████| 36/36 [00:05<00:00,  6.36it/s]
100%|██████████| 36/36 [00:05<00:00,  6.57it/s]
 Site-0| Train Acc: 0.8724

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.44it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.53it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.74it/s]
100%|██████████| 4/4 [00:00<00:00,  6.81it/s]
100%|██████████| 4/4 [00:00<00:00,  6.73it/s]
 Site-0| Val  Acc: 0.8125

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  5.79it/s]
 20%|██        | 2/10 [00:00<00:01,  6.19it/s]
 30%|███       | 3/10 [00:00<00:01,  6.32it/s]
 40%|████      | 4/10 [00:00<00:00,  6.44it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.46it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.58it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.65it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.51it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.57it/s]
100%|██████████| 10/10 [00:01<00:00,  6.62it/s]
100%|██████████| 10/10 [00:01<00:00,  6.50it/s]
 Site-1| Train Acc: 0.8750

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  7.04it/s]
100%|██████████| 1/1 [00:00<00:00,  7.03it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.31it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.56it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.68it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.52it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.61it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.53it/s]
 30%|███       | 7/23 [00:01<00:02,  6.64it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.60it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.51it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.58it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.43it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.42it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.46it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.25it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.45it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.53it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.57it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.56it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.68it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.76it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.71it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.49it/s]
100%|██████████| 23/23 [00:03<00:00,  6.44it/s]
100%|██████████| 23/23 [00:03<00:00,  6.52it/s]
 Site-2| Train Acc: 0.8709

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.51it/s]
100%|██████████| 2/2 [00:00<00:00,  6.33it/s]
100%|██████████| 2/2 [00:00<00:00,  6.35it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.21it/s]
 40%|████      | 2/5 [00:00<00:00,  6.75it/s]
 60%|██████    | 3/5 [00:00<00:00,  5.85it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.13it/s]
100%|██████████| 5/5 [00:00<00:00,  6.70it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8745

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.63it/s]
100%|██████████| 2/2 [00:00<00:00,  9.95it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.16it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.33it/s]
100%|██████████| 3/3 [00:00<00:00,  6.57it/s]
100%|██████████| 3/3 [00:00<00:00,  6.48it/s]
 Test site-2| Test Acc: 0.7766 | Bacc: 0.7754

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.91it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.16it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.97it/s]
 31%|███       | 4/13 [00:00<00:01,  6.79it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.21it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.26it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.50it/s]
 69%|██████▉   | 9/13 [00:01<00:00,  8.70it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  8.84it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  6.47it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  5.49it/s]
100%|██████████| 13/13 [00:01<00:00,  7.11it/s]
 Test site-3| Test Acc: 0.6345 | Bacc: 0.6276
============ Train epoch 71 ============
0 0
cla loss:  2.7191929182215553 trans loss: 0.8309386630154135
0 0
cla loss:  2.6821939010715963 trans loss: 0.8187824784211777
0 0
cla loss:  2.7040631615336816 trans loss: 0.8115230355430488

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.05it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.00it/s]
  8%|▊         | 3/36 [00:00<00:05,  6.31it/s]
 11%|█         | 4/36 [00:00<00:04,  6.44it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.28it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.33it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.08it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.08it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.18it/s]
 28%|██▊       | 10/36 [00:01<00:04,  6.33it/s]
 31%|███       | 11/36 [00:01<00:03,  6.33it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.44it/s]
 36%|███▌      | 13/36 [00:02<00:03,  6.40it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.36it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.47it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.30it/s]
 47%|████▋     | 17/36 [00:02<00:03,  6.32it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.26it/s]
 53%|█████▎    | 19/36 [00:03<00:02,  6.41it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.32it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.31it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.35it/s]
 64%|██████▍   | 23/36 [00:03<00:02,  6.18it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.16it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.28it/s]
 72%|███████▏  | 26/36 [00:04<00:01,  6.33it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.29it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.33it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.49it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.34it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.32it/s]
 89%|████████▉ | 32/36 [00:05<00:00,  6.47it/s]
 92%|█████████▏| 33/36 [00:05<00:00,  6.44it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.51it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.55it/s]
100%|██████████| 36/36 [00:05<00:00,  6.58it/s]
100%|██████████| 36/36 [00:05<00:00,  6.35it/s]
 Site-0| Train Acc: 0.8741

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.08it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.31it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.41it/s]
100%|██████████| 4/4 [00:00<00:00,  6.49it/s]
100%|██████████| 4/4 [00:00<00:00,  6.42it/s]
 Site-0| Val  Acc: 0.8047

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.31it/s]
 20%|██        | 2/10 [00:00<00:01,  6.16it/s]
 30%|███       | 3/10 [00:00<00:01,  6.34it/s]
 40%|████      | 4/10 [00:00<00:00,  6.39it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.37it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.52it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.55it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.51it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.22it/s]
100%|██████████| 10/10 [00:01<00:00,  6.27it/s]
100%|██████████| 10/10 [00:01<00:00,  6.35it/s]
 Site-1| Train Acc: 0.8875

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.73it/s]
100%|██████████| 1/1 [00:00<00:00,  6.71it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.66it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.09it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.20it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.39it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.42it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.35it/s]
 30%|███       | 7/23 [00:01<00:02,  6.23it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.37it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.48it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.59it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.65it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.81it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.90it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.72it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.55it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.63it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.57it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.49it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.52it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.55it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.67it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.70it/s]
100%|██████████| 23/23 [00:03<00:00,  6.59it/s]
100%|██████████| 23/23 [00:03<00:00,  6.54it/s]
 Site-2| Train Acc: 0.8764

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.73it/s]
100%|██████████| 2/2 [00:00<00:00,  6.73it/s]
100%|██████████| 2/2 [00:00<00:00,  6.72it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.30it/s]
 40%|████      | 2/5 [00:00<00:00,  6.78it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.20it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.46it/s]
100%|██████████| 5/5 [00:00<00:00,  7.08it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8742

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.82it/s]
100%|██████████| 2/2 [00:00<00:00, 10.23it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.84it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.78it/s]
100%|██████████| 3/3 [00:00<00:00,  6.70it/s]
100%|██████████| 3/3 [00:00<00:00,  6.72it/s]
 Test site-2| Test Acc: 0.7766 | Bacc: 0.7754

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.05it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.34it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.10it/s]
 31%|███       | 4/13 [00:00<00:01,  6.92it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.29it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.49it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.72it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.43it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.21it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.16it/s]
100%|██████████| 13/13 [00:01<00:00,  7.42it/s]
 Test site-3| Test Acc: 0.6371 | Bacc: 0.6263
============ Train epoch 72 ============
0 0
cla loss:  2.712217826939108 trans loss: 0.8045859947875517
0 0
cla loss:  2.6841310232727973 trans loss: 0.8132546052860854
0 0
cla loss:  2.6986155485987062 trans loss: 0.8144999026653156

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.22it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.32it/s]
  8%|▊         | 3/36 [00:00<00:05,  6.44it/s]
 11%|█         | 4/36 [00:00<00:05,  6.34it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.41it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.55it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.47it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.36it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.47it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.55it/s]
 31%|███       | 11/36 [00:01<00:03,  6.64it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.67it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.76it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.76it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.60it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.72it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.65it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.66it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.55it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.45it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.46it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.40it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.51it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.33it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.36it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.40it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.52it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.53it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.61it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.66it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.54it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.49it/s]
 92%|█████████▏| 33/36 [00:05<00:00,  6.41it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.48it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.58it/s]
100%|██████████| 36/36 [00:05<00:00,  6.59it/s]
100%|██████████| 36/36 [00:05<00:00,  6.53it/s]
 Site-0| Train Acc: 0.8733

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.15it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.13it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.37it/s]
100%|██████████| 4/4 [00:00<00:00,  6.23it/s]
100%|██████████| 4/4 [00:00<00:00,  6.23it/s]
 Site-0| Val  Acc: 0.8047

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.53it/s]
 20%|██        | 2/10 [00:00<00:01,  6.63it/s]
 30%|███       | 3/10 [00:00<00:01,  6.73it/s]
 40%|████      | 4/10 [00:00<00:00,  6.54it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.35it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.38it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.46it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.46it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.47it/s]
100%|██████████| 10/10 [00:01<00:00,  6.51it/s]
100%|██████████| 10/10 [00:01<00:00,  6.49it/s]
 Site-1| Train Acc: 0.8781

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.80it/s]
100%|██████████| 1/1 [00:00<00:00,  6.78it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  7.31it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.60it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.62it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.60it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.56it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.59it/s]
 30%|███       | 7/23 [00:01<00:02,  6.61it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.49it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.53it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.61it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.54it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.54it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.28it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.37it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.44it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.52it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.48it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.52it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.61it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.41it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.38it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.46it/s]
100%|██████████| 23/23 [00:03<00:00,  6.42it/s]
100%|██████████| 23/23 [00:03<00:00,  6.50it/s]
 Site-2| Train Acc: 0.8709

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.72it/s]
100%|██████████| 2/2 [00:00<00:00,  6.61it/s]
100%|██████████| 2/2 [00:00<00:00,  6.62it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.25it/s]
 40%|████      | 2/5 [00:00<00:00,  6.58it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.19it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.50it/s]
100%|██████████| 5/5 [00:00<00:00,  7.04it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8745

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.68it/s]
100%|██████████| 2/2 [00:00<00:00, 10.06it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.57it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.50it/s]
100%|██████████| 3/3 [00:00<00:00,  6.59it/s]
100%|██████████| 3/3 [00:00<00:00,  6.57it/s]
 Test site-2| Test Acc: 0.7979 | Bacc: 0.8070

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.62it/s]
 15%|█▌        | 2/13 [00:00<00:01,  6.86it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.80it/s]
 31%|███       | 4/13 [00:00<00:01,  6.71it/s]
 38%|███▊      | 5/13 [00:00<00:01,  6.85it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.25it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.55it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.29it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.18it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.15it/s]
100%|██████████| 13/13 [00:01<00:00,  7.29it/s]
 Test site-3| Test Acc: 0.6320 | Bacc: 0.6240
============ Train epoch 73 ============
0 0
cla loss:  2.7147689153201617 trans loss: 0.8164138108042617
0 0
cla loss:  2.6820670827549304 trans loss: 0.818601180261104
0 0
cla loss:  2.702129510179836 trans loss: 0.7964918038353848

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.62it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.54it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.72it/s]
 11%|█         | 4/36 [00:00<00:04,  6.70it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.75it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.71it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.58it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.56it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.60it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.68it/s]
 31%|███       | 11/36 [00:01<00:03,  6.56it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.56it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.54it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.53it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.42it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.36it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.51it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.65it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.68it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.65it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.64it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.61it/s]
 64%|██████▍   | 23/36 [00:03<00:02,  6.47it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.55it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.68it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.48it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.57it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.60it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.57it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.34it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.45it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.50it/s]
 92%|█████████▏| 33/36 [00:05<00:00,  6.43it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.40it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.55it/s]
100%|██████████| 36/36 [00:05<00:00,  6.61it/s]
100%|██████████| 36/36 [00:05<00:00,  6.56it/s]
 Site-0| Train Acc: 0.8707

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.44it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.67it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.79it/s]
100%|██████████| 4/4 [00:00<00:00,  6.83it/s]
100%|██████████| 4/4 [00:00<00:00,  6.76it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.14it/s]
 20%|██        | 2/10 [00:00<00:01,  6.49it/s]
 30%|███       | 3/10 [00:00<00:01,  6.40it/s]
 40%|████      | 4/10 [00:00<00:00,  6.37it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.53it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.55it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.56it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.57it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.45it/s]
100%|██████████| 10/10 [00:01<00:00,  6.53it/s]
100%|██████████| 10/10 [00:01<00:00,  6.49it/s]
 Site-1| Train Acc: 0.8875

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.92it/s]
100%|██████████| 1/1 [00:00<00:00,  6.90it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.35it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.37it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.53it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.54it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.40it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.58it/s]
 30%|███       | 7/23 [00:01<00:02,  6.62it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.43it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.57it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.71it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.73it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.82it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.67it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.76it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.77it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.69it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.72it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.51it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.43it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.43it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.49it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.64it/s]
100%|██████████| 23/23 [00:03<00:00,  6.53it/s]
100%|██████████| 23/23 [00:03<00:00,  6.58it/s]
 Site-2| Train Acc: 0.8696

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.60it/s]
100%|██████████| 2/2 [00:00<00:00,  6.39it/s]
100%|██████████| 2/2 [00:00<00:00,  6.41it/s]
 Site-2| Val  Acc: 0.8906

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  5.73it/s]
 40%|████      | 2/5 [00:00<00:00,  6.41it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.04it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.35it/s]
100%|██████████| 5/5 [00:00<00:00,  6.82it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8685

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.45it/s]
100%|██████████| 2/2 [00:00<00:00,  9.87it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.85it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.52it/s]
100%|██████████| 3/3 [00:00<00:00,  6.75it/s]
100%|██████████| 3/3 [00:00<00:00,  6.72it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7981

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.14it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.44it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.25it/s]
 31%|███       | 4/13 [00:00<00:01,  6.92it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.36it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.60it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.73it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.31it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.26it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.22it/s]
100%|██████████| 13/13 [00:01<00:00,  7.49it/s]
 Test site-3| Test Acc: 0.6244 | Bacc: 0.6097
============ Train epoch 74 ============
0 0
cla loss:  2.717505233371677 trans loss: 0.8127177136028232
0 0
cla loss:  2.6816413953675697 trans loss: 0.810055652155948
0 0
cla loss:  2.6966723089841143 trans loss: 0.8171844746000204

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:04,  7.09it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.58it/s]
  8%|▊         | 3/36 [00:00<00:05,  6.53it/s]
 11%|█         | 4/36 [00:00<00:04,  6.58it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.64it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.69it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.65it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.52it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.35it/s]
 28%|██▊       | 10/36 [00:01<00:04,  6.40it/s]
 31%|███       | 11/36 [00:01<00:03,  6.35it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.26it/s]
 36%|███▌      | 13/36 [00:02<00:03,  6.22it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.29it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.33it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.29it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.47it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.61it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.42it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.51it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.64it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.49it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.58it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.61it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.77it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.60it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.64it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.72it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.83it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.75it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.79it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.79it/s]
 92%|█████████▏| 33/36 [00:05<00:00,  6.89it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.86it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.93it/s]
100%|██████████| 36/36 [00:05<00:00,  6.94it/s]
100%|██████████| 36/36 [00:05<00:00,  6.61it/s]
 Site-0| Train Acc: 0.8724

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.79it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.70it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.75it/s]
100%|██████████| 4/4 [00:00<00:00,  6.87it/s]
100%|██████████| 4/4 [00:00<00:00,  6.82it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.64it/s]
 20%|██        | 2/10 [00:00<00:01,  6.79it/s]
 30%|███       | 3/10 [00:00<00:01,  6.64it/s]
 40%|████      | 4/10 [00:00<00:00,  6.56it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.80it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.84it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.89it/s]
 80%|████████  | 8/10 [00:01<00:00,  7.01it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.92it/s]
100%|██████████| 10/10 [00:01<00:00,  6.93it/s]
100%|██████████| 10/10 [00:01<00:00,  6.85it/s]
 Site-1| Train Acc: 0.8688

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.46it/s]
100%|██████████| 1/1 [00:00<00:00,  6.45it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.85it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.79it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.91it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.90it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.88it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.74it/s]
 30%|███       | 7/23 [00:01<00:02,  6.76it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.55it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.56it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.77it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.77it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.72it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.71it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.86it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.85it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.79it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.64it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.49it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.45it/s]
 87%|████████▋ | 20/23 [00:02<00:00,  6.58it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.61it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.56it/s]
100%|██████████| 23/23 [00:03<00:00,  6.64it/s]
100%|██████████| 23/23 [00:03<00:00,  6.69it/s]
 Site-2| Train Acc: 0.8682

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.65it/s]
100%|██████████| 2/2 [00:00<00:00,  6.65it/s]
100%|██████████| 2/2 [00:00<00:00,  6.64it/s]
 Site-2| Val  Acc: 0.8906

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.13it/s]
 40%|████      | 2/5 [00:00<00:00,  6.62it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.12it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.36it/s]
100%|██████████| 5/5 [00:00<00:00,  6.95it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8688

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.58it/s]
100%|██████████| 2/2 [00:00<00:00,  9.95it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.57it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.57it/s]
100%|██████████| 3/3 [00:00<00:00,  6.50it/s]
100%|██████████| 3/3 [00:00<00:00,  6.51it/s]
 Test site-2| Test Acc: 0.7979 | Bacc: 0.8070

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.11it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.42it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.18it/s]
 31%|███       | 4/13 [00:00<00:01,  6.95it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.36it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.62it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.82it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.47it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.35it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.31it/s]
100%|██████████| 13/13 [00:01<00:00,  7.55it/s]
 Test site-3| Test Acc: 0.6269 | Bacc: 0.6146
============ Train epoch 75 ============
0 0
cla loss:  2.7152944833189996 trans loss: 0.8056215850552123
0 0
cla loss:  2.6814965806414732 trans loss: 0.8166197918767306
0 0
cla loss:  2.699794717769527 trans loss: 0.8045966757002787

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.32it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.73it/s]
  8%|▊         | 3/36 [00:00<00:05,  6.59it/s]
 11%|█         | 4/36 [00:00<00:04,  6.64it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.64it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.66it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.85it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.80it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.76it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.85it/s]
 31%|███       | 11/36 [00:01<00:03,  6.80it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.59it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.57it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.59it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.58it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.61it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.77it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.72it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.82it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.87it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.81it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.73it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.76it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.64it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.55it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.70it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.72it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.80it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.82it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.76it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.68it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.80it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.77it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.80it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.76it/s]
100%|██████████| 36/36 [00:05<00:00,  6.72it/s]
100%|██████████| 36/36 [00:05<00:00,  6.72it/s]
 Site-0| Train Acc: 0.8802

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.67it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.69it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.83it/s]
100%|██████████| 4/4 [00:00<00:00,  6.85it/s]
100%|██████████| 4/4 [00:00<00:00,  6.81it/s]
 Site-0| Val  Acc: 0.7891

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.98it/s]
 20%|██        | 2/10 [00:00<00:01,  7.03it/s]
 30%|███       | 3/10 [00:00<00:01,  6.84it/s]
 40%|████      | 4/10 [00:00<00:00,  6.84it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.94it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.88it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.86it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.94it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.93it/s]
100%|██████████| 10/10 [00:01<00:00,  6.80it/s]
100%|██████████| 10/10 [00:01<00:00,  6.87it/s]
 Site-1| Train Acc: 0.8750

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.88it/s]
100%|██████████| 1/1 [00:00<00:00,  6.86it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  7.29it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.53it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.57it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.57it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.63it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.67it/s]
 30%|███       | 7/23 [00:01<00:02,  6.69it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.88it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.75it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.80it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.62it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.47it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.48it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.67it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.83it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.89it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.98it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.64it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.61it/s]
 87%|████████▋ | 20/23 [00:02<00:00,  6.70it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.69it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.86it/s]
100%|██████████| 23/23 [00:03<00:00,  6.70it/s]
100%|██████████| 23/23 [00:03<00:00,  6.70it/s]
 Site-2| Train Acc: 0.8736

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.72it/s]
100%|██████████| 2/2 [00:00<00:00,  6.74it/s]
100%|██████████| 2/2 [00:00<00:00,  6.73it/s]
 Site-2| Val  Acc: 0.9219

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.39it/s]
 40%|████      | 2/5 [00:00<00:00,  6.78it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.30it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.57it/s]
100%|██████████| 5/5 [00:00<00:00,  7.13it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8742

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.67it/s]
100%|██████████| 2/2 [00:00<00:00, 10.06it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.69it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.51it/s]
100%|██████████| 3/3 [00:00<00:00,  6.64it/s]
100%|██████████| 3/3 [00:00<00:00,  6.62it/s]
 Test site-2| Test Acc: 0.7766 | Bacc: 0.7754

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.09it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.34it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.13it/s]
 31%|███       | 4/13 [00:00<00:01,  7.11it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.47it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.65it/s]
 62%|██████▏   | 8/13 [00:00<00:00,  8.79it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.38it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.22it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.15it/s]
100%|██████████| 13/13 [00:01<00:00,  7.46it/s]
 Test site-3| Test Acc: 0.6218 | Bacc: 0.6095
============ Train epoch 76 ============
0 0
cla loss:  2.7162300881428934 trans loss: 0.8076783820013305
0 0
cla loss:  2.685153434024983 trans loss: 0.8133310097545835
0 0
cla loss:  2.7012261625510363 trans loss: 0.8032332706691032

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:04,  7.18it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.95it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.91it/s]
 11%|█         | 4/36 [00:00<00:04,  6.74it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.82it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.78it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.76it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.75it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.79it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.75it/s]
 31%|███       | 11/36 [00:01<00:03,  6.73it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.77it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.75it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.81it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.65it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.72it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.73it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.77it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.71it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.74it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.73it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.67it/s]
 64%|██████▍   | 23/36 [00:03<00:02,  6.50it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.62it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.59it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.71it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.68it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.58it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.65it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.68it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.72it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.74it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.84it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.70it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.58it/s]
100%|██████████| 36/36 [00:05<00:00,  6.55it/s]
100%|██████████| 36/36 [00:05<00:00,  6.70it/s]
 Site-0| Train Acc: 0.8715

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.70it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.70it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.78it/s]
100%|██████████| 4/4 [00:00<00:00,  6.83it/s]
100%|██████████| 4/4 [00:00<00:00,  6.79it/s]
 Site-0| Val  Acc: 0.8203

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  7.15it/s]
 20%|██        | 2/10 [00:00<00:01,  6.53it/s]
 30%|███       | 3/10 [00:00<00:01,  6.78it/s]
 40%|████      | 4/10 [00:00<00:00,  7.00it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.89it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.86it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.93it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.97it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.87it/s]
100%|██████████| 10/10 [00:01<00:00,  6.84it/s]
100%|██████████| 10/10 [00:01<00:00,  6.87it/s]
 Site-1| Train Acc: 0.8781

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.89it/s]
100%|██████████| 1/1 [00:00<00:00,  6.88it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.20it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.53it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.81it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.69it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.66it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.69it/s]
 30%|███       | 7/23 [00:01<00:02,  6.70it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.59it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.66it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.70it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.68it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.60it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.44it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.35it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.43it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.55it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.66it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.75it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.68it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.85it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.56it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.73it/s]
100%|██████████| 23/23 [00:03<00:00,  6.75it/s]
100%|██████████| 23/23 [00:03<00:00,  6.64it/s]
 Site-2| Train Acc: 0.8736

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.62it/s]
100%|██████████| 2/2 [00:00<00:00,  6.51it/s]
100%|██████████| 2/2 [00:00<00:00,  6.52it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.12it/s]
 40%|████      | 2/5 [00:00<00:00,  6.60it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.10it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.35it/s]
100%|██████████| 5/5 [00:00<00:00,  6.93it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8685

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.59it/s]
100%|██████████| 2/2 [00:00<00:00,  9.59it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  5.81it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.18it/s]
100%|██████████| 3/3 [00:00<00:00,  6.43it/s]
100%|██████████| 3/3 [00:00<00:00,  6.32it/s]
 Test site-2| Test Acc: 0.7766 | Bacc: 0.7754

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.98it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.29it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.08it/s]
 31%|███       | 4/13 [00:00<00:01,  6.73it/s]
 38%|███▊      | 5/13 [00:00<00:01,  6.88it/s]
 46%|████▌     | 6/13 [00:00<00:01,  7.00it/s]
 54%|█████▍    | 7/13 [00:00<00:00,  7.59it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.12it/s]
 69%|██████▉   | 9/13 [00:01<00:00,  8.47it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  8.72it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  6.42it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  5.59it/s]
100%|██████████| 13/13 [00:01<00:00,  7.09it/s]
 Test site-3| Test Acc: 0.6320 | Bacc: 0.6195
============ Train epoch 77 ============
0 0
cla loss:  2.71442008138302 trans loss: 0.8302987514428757
0 0
cla loss:  2.685003309393648 trans loss: 0.8189470255794238
0 0
cla loss:  2.7015993223717465 trans loss: 0.8248414034819483

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.52it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.58it/s]
  8%|▊         | 3/36 [00:00<00:05,  6.56it/s]
 11%|█         | 4/36 [00:00<00:04,  6.59it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.55it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.65it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.74it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.65it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.81it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.79it/s]
 31%|███       | 11/36 [00:01<00:03,  6.74it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.78it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.88it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.83it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.78it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.75it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.78it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.76it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.77it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.93it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.67it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.68it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.57it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.60it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.65it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.72it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.71it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.73it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.87it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.72it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.75it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.67it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.70it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.70it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.55it/s]
100%|██████████| 36/36 [00:05<00:00,  6.60it/s]
100%|██████████| 36/36 [00:05<00:00,  6.70it/s]
 Site-0| Train Acc: 0.8715

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.39it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.62it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.76it/s]
100%|██████████| 4/4 [00:00<00:00,  6.87it/s]
100%|██████████| 4/4 [00:00<00:00,  6.77it/s]
 Site-0| Val  Acc: 0.8047

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.69it/s]
 20%|██        | 2/10 [00:00<00:01,  6.81it/s]
 30%|███       | 3/10 [00:00<00:01,  6.88it/s]
 40%|████      | 4/10 [00:00<00:00,  6.92it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.87it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.58it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.62it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.65it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.70it/s]
100%|██████████| 10/10 [00:01<00:00,  6.67it/s]
100%|██████████| 10/10 [00:01<00:00,  6.71it/s]
 Site-1| Train Acc: 0.8750

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.62it/s]
100%|██████████| 1/1 [00:00<00:00,  6.61it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.46it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.50it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.57it/s]
 17%|█▋        | 4/23 [00:00<00:03,  6.29it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.57it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.53it/s]
 30%|███       | 7/23 [00:01<00:02,  6.60it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.66it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.67it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.87it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.73it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.78it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.89it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.86it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.89it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.85it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.83it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.81it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.66it/s]
 87%|████████▋ | 20/23 [00:02<00:00,  6.73it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.79it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.77it/s]
100%|██████████| 23/23 [00:03<00:00,  6.89it/s]
100%|██████████| 23/23 [00:03<00:00,  6.74it/s]
 Site-2| Train Acc: 0.8723

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.76it/s]
100%|██████████| 2/2 [00:00<00:00,  6.66it/s]
100%|██████████| 2/2 [00:00<00:00,  6.66it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.19it/s]
 40%|████      | 2/5 [00:00<00:00,  6.69it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.24it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.48it/s]
100%|██████████| 5/5 [00:00<00:00,  7.06it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8685

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.75it/s]
100%|██████████| 2/2 [00:00<00:00, 10.15it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.65it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.75it/s]
100%|██████████| 3/3 [00:00<00:00,  6.80it/s]
100%|██████████| 3/3 [00:00<00:00,  6.77it/s]
 Test site-2| Test Acc: 0.7766 | Bacc: 0.7754

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.04it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.37it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.15it/s]
 31%|███       | 4/13 [00:00<00:01,  7.13it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.47it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.67it/s]
 62%|██████▏   | 8/13 [00:00<00:00,  8.84it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.49it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.27it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.19it/s]
100%|██████████| 13/13 [00:01<00:00,  7.51it/s]
 Test site-3| Test Acc: 0.6320 | Bacc: 0.6199
============ Train epoch 78 ============
0 0
cla loss:  2.715578064846633 trans loss: 0.833388262657664
0 0
cla loss:  2.688245428267436 trans loss: 0.8320127680673072
0 0
cla loss:  2.69703915131152 trans loss: 0.807199807322804

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:04,  7.01it/s]
  6%|▌         | 2/36 [00:00<00:04,  7.10it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.97it/s]
 11%|█         | 4/36 [00:00<00:04,  6.71it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.61it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.70it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.78it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.68it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.82it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.79it/s]
 31%|███       | 11/36 [00:01<00:03,  6.71it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.65it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.77it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.71it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.77it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.83it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.85it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.81it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.78it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.90it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.84it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.77it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.78it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.73it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.70it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.82it/s]
 75%|███████▌  | 27/36 [00:03<00:01,  6.81it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.66it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.65it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.64it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.57it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.66it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.76it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.75it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.66it/s]
100%|██████████| 36/36 [00:05<00:00,  6.67it/s]
100%|██████████| 36/36 [00:05<00:00,  6.74it/s]
 Site-0| Train Acc: 0.8767

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.84it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.87it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.95it/s]
100%|██████████| 4/4 [00:00<00:00,  7.00it/s]
100%|██████████| 4/4 [00:00<00:00,  6.96it/s]
 Site-0| Val  Acc: 0.8047

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.86it/s]
 20%|██        | 2/10 [00:00<00:01,  6.54it/s]
 30%|███       | 3/10 [00:00<00:01,  6.52it/s]
 40%|████      | 4/10 [00:00<00:00,  6.65it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.74it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.73it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.83it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.69it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.71it/s]
100%|██████████| 10/10 [00:01<00:00,  6.81it/s]
100%|██████████| 10/10 [00:01<00:00,  6.73it/s]
 Site-1| Train Acc: 0.8844

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  7.01it/s]
100%|██████████| 1/1 [00:00<00:00,  6.99it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.66it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.31it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.55it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.59it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.68it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.62it/s]
 30%|███       | 7/23 [00:01<00:02,  6.79it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.89it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.92it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.85it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.62it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.69it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.50it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.66it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.69it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.64it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.81it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.80it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.82it/s]
 87%|████████▋ | 20/23 [00:02<00:00,  6.75it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.66it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.65it/s]
100%|██████████| 23/23 [00:03<00:00,  6.66it/s]
100%|██████████| 23/23 [00:03<00:00,  6.69it/s]
 Site-2| Train Acc: 0.8750

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.83it/s]
100%|██████████| 2/2 [00:00<00:00,  6.78it/s]
100%|██████████| 2/2 [00:00<00:00,  6.78it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.44it/s]
 40%|████      | 2/5 [00:00<00:00,  6.91it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.35it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.63it/s]
100%|██████████| 5/5 [00:00<00:00,  7.24it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8742

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.79it/s]
100%|██████████| 2/2 [00:00<00:00, 10.28it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.90it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.84it/s]
100%|██████████| 3/3 [00:00<00:00,  6.93it/s]
100%|██████████| 3/3 [00:00<00:00,  6.91it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7854

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.09it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.42it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.22it/s]
 31%|███       | 4/13 [00:00<00:01,  7.16it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.51it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.72it/s]
 62%|██████▏   | 8/13 [00:00<00:00,  8.88it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.50it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.36it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.30it/s]
100%|██████████| 13/13 [00:01<00:00,  7.59it/s]
 Test site-3| Test Acc: 0.6218 | Bacc: 0.6095
============ Train epoch 79 ============
0 0
cla loss:  2.7176850501017356 trans loss: 0.8034043506761293
0 0
cla loss:  2.6830014164124303 trans loss: 0.8055231978545836
0 0
cla loss:  2.6982511299938414 trans loss: 0.8167104059128306

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.99it/s]
  6%|▌         | 2/36 [00:00<00:04,  7.09it/s]
  8%|▊         | 3/36 [00:00<00:04,  7.04it/s]
 11%|█         | 4/36 [00:00<00:04,  7.08it/s]
 14%|█▍        | 5/36 [00:00<00:04,  7.08it/s]
 17%|█▋        | 6/36 [00:00<00:04,  7.01it/s]
 19%|█▉        | 7/36 [00:00<00:04,  7.06it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.98it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.92it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.95it/s]
 31%|███       | 11/36 [00:01<00:03,  6.87it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.95it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.89it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.92it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.80it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.74it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.83it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.85it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.80it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.77it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.60it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.61it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.77it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.78it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.81it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.57it/s]
 75%|███████▌  | 27/36 [00:03<00:01,  6.68it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.63it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.66it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.37it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.19it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.18it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.21it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.42it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.53it/s]
100%|██████████| 36/36 [00:05<00:00,  6.58it/s]
100%|██████████| 36/36 [00:05<00:00,  6.72it/s]
 Site-0| Train Acc: 0.8785

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.77it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.76it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.80it/s]
100%|██████████| 4/4 [00:00<00:00,  6.90it/s]
100%|██████████| 4/4 [00:00<00:00,  6.85it/s]
 Site-0| Val  Acc: 0.8047

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.86it/s]
 20%|██        | 2/10 [00:00<00:01,  6.69it/s]
 30%|███       | 3/10 [00:00<00:01,  6.37it/s]
 40%|████      | 4/10 [00:00<00:00,  6.67it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.75it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.81it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.86it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.85it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.88it/s]
100%|██████████| 10/10 [00:01<00:00,  6.89it/s]
100%|██████████| 10/10 [00:01<00:00,  6.80it/s]
 Site-1| Train Acc: 0.8719

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  7.03it/s]
100%|██████████| 1/1 [00:00<00:00,  7.01it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  7.04it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.82it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.48it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.57it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.75it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.66it/s]
 30%|███       | 7/23 [00:01<00:02,  6.57it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.61it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.73it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.86it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.56it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.66it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.75it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.78it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.91it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.95it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.95it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.83it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.72it/s]
 87%|████████▋ | 20/23 [00:02<00:00,  6.71it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.45it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.55it/s]
100%|██████████| 23/23 [00:03<00:00,  6.64it/s]
100%|██████████| 23/23 [00:03<00:00,  6.70it/s]
 Site-2| Train Acc: 0.8587

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.88it/s]
100%|██████████| 2/2 [00:00<00:00,  6.65it/s]
100%|██████████| 2/2 [00:00<00:00,  6.67it/s]
 Site-2| Val  Acc: 0.8906

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.07it/s]
 40%|████      | 2/5 [00:00<00:00,  6.67it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.24it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.52it/s]
100%|██████████| 5/5 [00:00<00:00,  7.06it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8688

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.67it/s]
100%|██████████| 2/2 [00:00<00:00, 10.10it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.77it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.66it/s]
100%|██████████| 3/3 [00:00<00:00,  6.80it/s]
100%|██████████| 3/3 [00:00<00:00,  6.77it/s]
 Test site-2| Test Acc: 0.8085 | Bacc: 0.8160

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.00it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.31it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.13it/s]
 31%|███       | 4/13 [00:00<00:01,  7.10it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.44it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.64it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.78it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.42it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.27it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.15it/s]
100%|██████████| 13/13 [00:01<00:00,  7.48it/s]
 Test site-3| Test Acc: 0.6320 | Bacc: 0.6214
============ Train epoch 80 ============
0 0
cla loss:  2.716488293067894 trans loss: 0.8139407362171154
0 0
cla loss:  2.684579119610427 trans loss: 0.8130958969868607
0 0
cla loss:  2.698489644419608 trans loss: 0.8103255851184903

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.69it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.53it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.70it/s]
 11%|█         | 4/36 [00:00<00:04,  6.77it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.75it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.76it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.59it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.57it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.59it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.71it/s]
 31%|███       | 11/36 [00:01<00:03,  6.61it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.60it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.58it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.55it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.64it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.59it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.67it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.63it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.61it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.50it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.57it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.58it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.52it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.64it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.57it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.65it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.60it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.67it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.73it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.69it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.84it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.70it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.69it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.74it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.63it/s]
100%|██████████| 36/36 [00:05<00:00,  6.67it/s]
100%|██████████| 36/36 [00:05<00:00,  6.64it/s]
 Site-0| Train Acc: 0.8741

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.51it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.74it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.80it/s]
100%|██████████| 4/4 [00:00<00:00,  6.81it/s]
100%|██████████| 4/4 [00:00<00:00,  6.77it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.61it/s]
 20%|██        | 2/10 [00:00<00:01,  6.69it/s]
 30%|███       | 3/10 [00:00<00:01,  6.52it/s]
 40%|████      | 4/10 [00:00<00:00,  6.56it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.64it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.58it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.69it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.93it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.76it/s]
100%|██████████| 10/10 [00:01<00:00,  6.68it/s]
100%|██████████| 10/10 [00:01<00:00,  6.68it/s]
 Site-1| Train Acc: 0.8750

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.86it/s]
100%|██████████| 1/1 [00:00<00:00,  6.84it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.30it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.84it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.90it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.83it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.84it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.77it/s]
 30%|███       | 7/23 [00:01<00:02,  6.81it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.73it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.50it/s]
 43%|████▎     | 10/23 [00:01<00:02,  6.42it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.38it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.42it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.44it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.49it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.33it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.23it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.28it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.34it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.40it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.48it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.55it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.67it/s]
100%|██████████| 23/23 [00:03<00:00,  6.84it/s]
100%|██████████| 23/23 [00:03<00:00,  6.57it/s]
 Site-2| Train Acc: 0.8709

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.93it/s]
100%|██████████| 2/2 [00:00<00:00,  6.73it/s]
100%|██████████| 2/2 [00:00<00:00,  6.75it/s]
 Site-2| Val  Acc: 0.8906

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.18it/s]
 40%|████      | 2/5 [00:00<00:00,  6.71it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.07it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.36it/s]
100%|██████████| 5/5 [00:00<00:00,  6.98it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8745

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.57it/s]
100%|██████████| 2/2 [00:00<00:00,  9.75it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.08it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.46it/s]
100%|██████████| 3/3 [00:00<00:00,  6.59it/s]
100%|██████████| 3/3 [00:00<00:00,  6.51it/s]
 Test site-2| Test Acc: 0.7979 | Bacc: 0.8070

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.15it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.35it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.16it/s]
 31%|███       | 4/13 [00:00<00:01,  7.13it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.47it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.66it/s]
 62%|██████▏   | 8/13 [00:00<00:00,  8.79it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.44it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.24it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.18it/s]
100%|██████████| 13/13 [00:01<00:00,  7.50it/s]
 Test site-3| Test Acc: 0.6244 | Bacc: 0.6121
============ Train epoch 81 ============
0 0
cla loss:  2.7136890756424945 trans loss: 0.799328724343573
0 0
cla loss:  2.6855459524758496 trans loss: 0.821148456640579
0 0
cla loss:  2.700022772927979 trans loss: 0.8189401710452746

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.84it/s]
  6%|▌         | 2/36 [00:00<00:04,  7.05it/s]
  8%|▊         | 3/36 [00:00<00:04,  7.07it/s]
 11%|█         | 4/36 [00:00<00:04,  6.82it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.77it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.83it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.73it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.63it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.75it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.76it/s]
 31%|███       | 11/36 [00:01<00:03,  6.78it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.88it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.70it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.66it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.60it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.71it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.67it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.67it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.80it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.71it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.63it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.55it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.63it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.80it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.73it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.75it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.70it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.68it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.62it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.67it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.67it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.77it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.87it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.82it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.84it/s]
100%|██████████| 36/36 [00:05<00:00,  6.77it/s]
100%|██████████| 36/36 [00:05<00:00,  6.74it/s]
 Site-0| Train Acc: 0.8733

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.68it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.71it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.88it/s]
100%|██████████| 4/4 [00:00<00:00,  6.97it/s]
100%|██████████| 4/4 [00:00<00:00,  6.89it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  7.00it/s]
 20%|██        | 2/10 [00:00<00:01,  6.99it/s]
 30%|███       | 3/10 [00:00<00:00,  7.08it/s]
 40%|████      | 4/10 [00:00<00:00,  6.95it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.87it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.86it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.68it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.62it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.79it/s]
100%|██████████| 10/10 [00:01<00:00,  6.79it/s]
100%|██████████| 10/10 [00:01<00:00,  6.82it/s]
 Site-1| Train Acc: 0.8750

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  7.11it/s]
100%|██████████| 1/1 [00:00<00:00,  7.09it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.87it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.83it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.97it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.97it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.86it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.70it/s]
 30%|███       | 7/23 [00:01<00:02,  6.76it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.57it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.57it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.63it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.77it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.90it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.96it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.78it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.78it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.76it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.82it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.85it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.78it/s]
 87%|████████▋ | 20/23 [00:02<00:00,  6.77it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.83it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.83it/s]
100%|██████████| 23/23 [00:03<00:00,  6.83it/s]
100%|██████████| 23/23 [00:03<00:00,  6.80it/s]
 Site-2| Train Acc: 0.8614

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.83it/s]
100%|██████████| 2/2 [00:00<00:00,  6.76it/s]
100%|██████████| 2/2 [00:00<00:00,  6.76it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.27it/s]
 40%|████      | 2/5 [00:00<00:00,  6.80it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.31it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.59it/s]
100%|██████████| 5/5 [00:00<00:00,  7.17it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8688

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.89it/s]
100%|██████████| 2/2 [00:00<00:00, 10.39it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.87it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.83it/s]
100%|██████████| 3/3 [00:00<00:00,  6.94it/s]
100%|██████████| 3/3 [00:00<00:00,  6.91it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7981

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.67it/s]
 15%|█▌        | 2/13 [00:00<00:01,  6.85it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.94it/s]
 31%|███       | 4/13 [00:00<00:01,  7.04it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.43it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.43it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.67it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.39it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.14it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.12it/s]
100%|██████████| 13/13 [00:01<00:00,  7.38it/s]
 Test site-3| Test Acc: 0.6421 | Bacc: 0.6351
============ Train epoch 82 ============
0 0
cla loss:  2.712044790162513 trans loss: 0.8063666281388633
0 0
cla loss:  2.6887920334111506 trans loss: 0.818891496814076
0 0
cla loss:  2.7020635173548406 trans loss: 0.8202877302265646

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:04,  7.08it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.80it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.79it/s]
 11%|█         | 4/36 [00:00<00:04,  6.83it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.86it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.78it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.79it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.57it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.67it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.70it/s]
 31%|███       | 11/36 [00:01<00:03,  6.73it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.84it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.94it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.88it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.90it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.84it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.86it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.82it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.84it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.80it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.82it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.79it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.70it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.80it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.88it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.81it/s]
 75%|███████▌  | 27/36 [00:03<00:01,  6.66it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.44it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.56it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.75it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.79it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.79it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.80it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.61it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.71it/s]
100%|██████████| 36/36 [00:05<00:00,  6.71it/s]
100%|██████████| 36/36 [00:05<00:00,  6.76it/s]
 Site-0| Train Acc: 0.8741

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.86it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.89it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.91it/s]
100%|██████████| 4/4 [00:00<00:00,  6.99it/s]
100%|██████████| 4/4 [00:00<00:00,  6.95it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.28it/s]
 20%|██        | 2/10 [00:00<00:01,  6.77it/s]
 30%|███       | 3/10 [00:00<00:01,  6.75it/s]
 40%|████      | 4/10 [00:00<00:00,  6.86it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.86it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.73it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.78it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.52it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.65it/s]
100%|██████████| 10/10 [00:01<00:00,  6.80it/s]
100%|██████████| 10/10 [00:01<00:00,  6.74it/s]
 Site-1| Train Acc: 0.8750

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  7.01it/s]
100%|██████████| 1/1 [00:00<00:00,  6.99it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.23it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.49it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.64it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.65it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.71it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.70it/s]
 30%|███       | 7/23 [00:01<00:02,  6.65it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.54it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.58it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.73it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.76it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.92it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.99it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.98it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.97it/s]
 70%|██████▉   | 16/23 [00:02<00:00,  7.05it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  7.00it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.93it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.92it/s]
 87%|████████▋ | 20/23 [00:02<00:00,  6.88it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.88it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.97it/s]
100%|██████████| 23/23 [00:03<00:00,  6.53it/s]
100%|██████████| 23/23 [00:03<00:00,  6.77it/s]
 Site-2| Train Acc: 0.8709

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.85it/s]
100%|██████████| 2/2 [00:00<00:00,  6.75it/s]
100%|██████████| 2/2 [00:00<00:00,  6.76it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.34it/s]
 40%|████      | 2/5 [00:00<00:00,  6.83it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.30it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.48it/s]
100%|██████████| 5/5 [00:00<00:00,  7.11it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8745

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.81it/s]
100%|██████████| 2/2 [00:00<00:00, 10.28it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.86it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.82it/s]
100%|██████████| 3/3 [00:00<00:00,  6.91it/s]
100%|██████████| 3/3 [00:00<00:00,  6.89it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7981

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.19it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.49it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.30it/s]
 31%|███       | 4/13 [00:00<00:01,  7.26it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.59it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.76it/s]
 62%|██████▏   | 8/13 [00:00<00:00,  8.88it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.47it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.36it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.18it/s]
100%|██████████| 13/13 [00:01<00:00,  7.52it/s]
 Test site-3| Test Acc: 0.6294 | Bacc: 0.6191
============ Train epoch 83 ============
0 0
cla loss:  2.717371679430631 trans loss: 0.8226417479802616
0 0
cla loss:  2.6862883280270062 trans loss: 0.8221615448069932
0 0
cla loss:  2.7037006742391156 trans loss: 0.8279903665858896

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.85it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.66it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.76it/s]
 11%|█         | 4/36 [00:00<00:04,  6.65it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.75it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.83it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.64it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.60it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.74it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.69it/s]
 31%|███       | 11/36 [00:01<00:03,  6.76it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.74it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.77it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.81it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.76it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.71it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.68it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.86it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.81it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.79it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.91it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.80it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.74it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.71it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.69it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.75it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.69it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.68it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.77it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.57it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.70it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.72it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.76it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.72it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.73it/s]
100%|██████████| 36/36 [00:05<00:00,  6.56it/s]
100%|██████████| 36/36 [00:05<00:00,  6.72it/s]
 Site-0| Train Acc: 0.8767

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.66it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.75it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.79it/s]
100%|██████████| 4/4 [00:00<00:00,  6.81it/s]
100%|██████████| 4/4 [00:00<00:00,  6.78it/s]
 Site-0| Val  Acc: 0.7891

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.51it/s]
 20%|██        | 2/10 [00:00<00:01,  6.51it/s]
 30%|███       | 3/10 [00:00<00:01,  6.52it/s]
 40%|████      | 4/10 [00:00<00:00,  6.61it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.60it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.63it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.69it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.53it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.58it/s]
100%|██████████| 10/10 [00:01<00:00,  6.57it/s]
100%|██████████| 10/10 [00:01<00:00,  6.58it/s]
 Site-1| Train Acc: 0.8781

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.79it/s]
100%|██████████| 1/1 [00:00<00:00,  6.77it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.78it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.44it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.48it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.48it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.67it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.29it/s]
 30%|███       | 7/23 [00:01<00:02,  6.48it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.53it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.68it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.69it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.62it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.56it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.48it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.65it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.64it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.67it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.68it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.73it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.80it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.76it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.77it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.86it/s]
100%|██████████| 23/23 [00:03<00:00,  6.81it/s]
100%|██████████| 23/23 [00:03<00:00,  6.65it/s]
 Site-2| Train Acc: 0.8709

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.91it/s]
100%|██████████| 2/2 [00:00<00:00,  6.81it/s]
100%|██████████| 2/2 [00:00<00:00,  6.82it/s]
 Site-2| Val  Acc: 0.9219

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.33it/s]
 40%|████      | 2/5 [00:00<00:00,  6.87it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.25it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.52it/s]
100%|██████████| 5/5 [00:00<00:00,  7.10it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8742

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.85it/s]
100%|██████████| 2/2 [00:00<00:00, 10.27it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.80it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.54it/s]
100%|██████████| 3/3 [00:00<00:00,  6.70it/s]
100%|██████████| 3/3 [00:00<00:00,  6.68it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7981

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.10it/s]
 15%|█▌        | 2/13 [00:00<00:01,  6.67it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.76it/s]
 31%|███       | 4/13 [00:00<00:01,  6.89it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.31it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.53it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.75it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.39it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.25it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.19it/s]
100%|██████████| 13/13 [00:01<00:00,  7.41it/s]
 Test site-3| Test Acc: 0.6320 | Bacc: 0.6195
============ Train epoch 84 ============
0 0
cla loss:  2.7155799398470166 trans loss: 0.8141844886631223
0 0
cla loss:  2.6871575434603283 trans loss: 0.8126308648430522
0 0
cla loss:  2.699371088689296 trans loss: 0.8099588874596447

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.62it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.58it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.73it/s]
 11%|█         | 4/36 [00:00<00:04,  6.43it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.40it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.58it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.60it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.70it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.52it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.65it/s]
 31%|███       | 11/36 [00:01<00:03,  6.55it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.65it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.66it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.60it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.61it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.52it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.69it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.74it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.65it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.71it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.72it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.74it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.72it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.75it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.85it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.87it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.71it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.77it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.64it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.60it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.66it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.73it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.73it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.77it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.80it/s]
100%|██████████| 36/36 [00:05<00:00,  6.69it/s]
100%|██████████| 36/36 [00:05<00:00,  6.67it/s]
 Site-0| Train Acc: 0.8750

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.61it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.56it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.67it/s]
100%|██████████| 4/4 [00:00<00:00,  6.72it/s]
100%|██████████| 4/4 [00:00<00:00,  6.68it/s]
 Site-0| Val  Acc: 0.8047

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.56it/s]
 20%|██        | 2/10 [00:00<00:01,  6.52it/s]
 30%|███       | 3/10 [00:00<00:01,  6.30it/s]
 40%|████      | 4/10 [00:00<00:00,  6.46it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.60it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.61it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.58it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.65it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.65it/s]
100%|██████████| 10/10 [00:01<00:00,  6.68it/s]
100%|██████████| 10/10 [00:01<00:00,  6.60it/s]
 Site-1| Train Acc: 0.8781

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.91it/s]
100%|██████████| 1/1 [00:00<00:00,  6.89it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.59it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.74it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.94it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.71it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.74it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.48it/s]
 30%|███       | 7/23 [00:01<00:02,  6.34it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.43it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.28it/s]
 43%|████▎     | 10/23 [00:01<00:02,  6.33it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.46it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.13it/s]
 57%|█████▋    | 13/23 [00:02<00:01,  6.36it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.39it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.40it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.48it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.50it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.57it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.60it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.63it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.75it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.77it/s]
100%|██████████| 23/23 [00:03<00:00,  6.76it/s]
100%|██████████| 23/23 [00:03<00:00,  6.54it/s]
 Site-2| Train Acc: 0.8764

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.84it/s]
100%|██████████| 2/2 [00:00<00:00,  6.69it/s]
100%|██████████| 2/2 [00:00<00:00,  6.70it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.22it/s]
 40%|████      | 2/5 [00:00<00:00,  6.69it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.15it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.39it/s]
100%|██████████| 5/5 [00:00<00:00,  6.98it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8742

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.59it/s]
100%|██████████| 2/2 [00:00<00:00,  9.95it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.66it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.51it/s]
100%|██████████| 3/3 [00:00<00:00,  6.54it/s]
100%|██████████| 3/3 [00:00<00:00,  6.54it/s]
 Test site-2| Test Acc: 0.7766 | Bacc: 0.7754

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.91it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.27it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.09it/s]
 31%|███       | 4/13 [00:00<00:01,  7.09it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.45it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.70it/s]
 62%|██████▏   | 8/13 [00:00<00:00,  8.87it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.50it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.34it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.27it/s]
100%|██████████| 13/13 [00:01<00:00,  7.52it/s]
 Test site-3| Test Acc: 0.6320 | Bacc: 0.6195
============ Train epoch 85 ============
0 0
cla loss:  2.7178983400814496 trans loss: 0.8147577598466346
0 0
cla loss:  2.6827113029345795 trans loss: 0.8167645080604745
0 0
cla loss:  2.7010424891907965 trans loss: 0.8215327948781114

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.98it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.81it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.81it/s]
 11%|█         | 4/36 [00:00<00:04,  6.81it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.71it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.93it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.80it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.93it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.85it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.84it/s]
 31%|███       | 11/36 [00:01<00:03,  6.83it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.74it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.85it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.78it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.78it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.73it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.73it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.78it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.81it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.81it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.80it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.87it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.73it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.67it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.50it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.60it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.53it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.64it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.65it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.52it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.65it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.61it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.73it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.74it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.79it/s]
100%|██████████| 36/36 [00:05<00:00,  6.71it/s]
100%|██████████| 36/36 [00:05<00:00,  6.74it/s]
 Site-0| Train Acc: 0.8715

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.89it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.90it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.98it/s]
100%|██████████| 4/4 [00:00<00:00,  7.02it/s]
100%|██████████| 4/4 [00:00<00:00,  6.98it/s]
 Site-0| Val  Acc: 0.8047

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  7.05it/s]
 20%|██        | 2/10 [00:00<00:01,  6.74it/s]
 30%|███       | 3/10 [00:00<00:01,  6.79it/s]
 40%|████      | 4/10 [00:00<00:00,  6.79it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.68it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.74it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.71it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.78it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.64it/s]
100%|██████████| 10/10 [00:01<00:00,  6.54it/s]
100%|██████████| 10/10 [00:01<00:00,  6.67it/s]
 Site-1| Train Acc: 0.8688

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.83it/s]
100%|██████████| 1/1 [00:00<00:00,  6.82it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.04it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.53it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.68it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.72it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.78it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.62it/s]
 30%|███       | 7/23 [00:01<00:02,  6.68it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.78it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.85it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.88it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.84it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.97it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.99it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.90it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.76it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.75it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.79it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.64it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.59it/s]
 87%|████████▋ | 20/23 [00:02<00:00,  6.67it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.64it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.64it/s]
100%|██████████| 23/23 [00:03<00:00,  6.55it/s]
100%|██████████| 23/23 [00:03<00:00,  6.71it/s]
 Site-2| Train Acc: 0.8709

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.67it/s]
100%|██████████| 2/2 [00:00<00:00,  6.43it/s]
100%|██████████| 2/2 [00:00<00:00,  6.45it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.17it/s]
 40%|████      | 2/5 [00:00<00:00,  6.66it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.16it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.40it/s]
100%|██████████| 5/5 [00:00<00:00,  6.99it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8745

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.61it/s]
100%|██████████| 2/2 [00:00<00:00,  9.96it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.58it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.56it/s]
100%|██████████| 3/3 [00:00<00:00,  6.68it/s]
100%|██████████| 3/3 [00:00<00:00,  6.64it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7981

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.02it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.30it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.07it/s]
 31%|███       | 4/13 [00:00<00:01,  7.04it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.38it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.58it/s]
 54%|█████▍    | 7/13 [00:00<00:00,  8.14it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.53it/s]
 69%|██████▉   | 9/13 [00:01<00:00,  8.78it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.16it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.15it/s]
100%|██████████| 13/13 [00:01<00:00,  7.37it/s]
 Test site-3| Test Acc: 0.6218 | Bacc: 0.6114
============ Train epoch 86 ============
0 0
cla loss:  2.7141480733401813 trans loss: 0.8238987757932001
0 0
cla loss:  2.6822492884631135 trans loss: 0.8186216932445315
0 0
cla loss:  2.7070845095955547 trans loss: 0.8160862146909512

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:04,  7.23it/s]
  6%|▌         | 2/36 [00:00<00:04,  7.10it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.94it/s]
 11%|█         | 4/36 [00:00<00:04,  6.86it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.82it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.55it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.57it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.62it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.69it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.79it/s]
 31%|███       | 11/36 [00:01<00:03,  6.83it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.82it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.77it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.72it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.64it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.62it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.67it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.70it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.71it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.75it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.70it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.68it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.74it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.78it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.72it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.74it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.73it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.70it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.58it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.71it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.71it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.65it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.63it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.56it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.54it/s]
100%|██████████| 36/36 [00:05<00:00,  6.55it/s]
100%|██████████| 36/36 [00:05<00:00,  6.69it/s]
 Site-0| Train Acc: 0.8698

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.64it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.57it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.68it/s]
100%|██████████| 4/4 [00:00<00:00,  6.74it/s]
100%|██████████| 4/4 [00:00<00:00,  6.70it/s]
 Site-0| Val  Acc: 0.8047

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.61it/s]
 20%|██        | 2/10 [00:00<00:01,  5.97it/s]
 30%|███       | 3/10 [00:00<00:01,  6.34it/s]
 40%|████      | 4/10 [00:00<00:00,  6.56it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.48it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.49it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.55it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.52it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.59it/s]
100%|██████████| 10/10 [00:01<00:00,  6.62it/s]
100%|██████████| 10/10 [00:01<00:00,  6.52it/s]
 Site-1| Train Acc: 0.8781

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  7.06it/s]
100%|██████████| 1/1 [00:00<00:00,  7.05it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  7.30it/s]
  9%|▊         | 2/23 [00:00<00:02,  7.20it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.86it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.87it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.67it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.72it/s]
 30%|███       | 7/23 [00:01<00:02,  6.84it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.82it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.66it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.68it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.71it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.75it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.77it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.73it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.81it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.70it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.80it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.61it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.64it/s]
 87%|████████▋ | 20/23 [00:02<00:00,  6.71it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.71it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.76it/s]
100%|██████████| 23/23 [00:03<00:00,  6.88it/s]
100%|██████████| 23/23 [00:03<00:00,  6.77it/s]
 Site-2| Train Acc: 0.8655

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.87it/s]
100%|██████████| 2/2 [00:00<00:00,  6.77it/s]
100%|██████████| 2/2 [00:00<00:00,  6.77it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.37it/s]
 40%|████      | 2/5 [00:00<00:00,  6.84it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.35it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.62it/s]
100%|██████████| 5/5 [00:00<00:00,  7.22it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8745

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.86it/s]
100%|██████████| 2/2 [00:00<00:00, 10.35it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.85it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.81it/s]
100%|██████████| 3/3 [00:00<00:00,  6.90it/s]
100%|██████████| 3/3 [00:00<00:00,  6.88it/s]
 Test site-2| Test Acc: 0.7766 | Bacc: 0.7754

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.17it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.42it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.24it/s]
 31%|███       | 4/13 [00:00<00:01,  7.21it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.54it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.72it/s]
 62%|██████▏   | 8/13 [00:00<00:00,  8.88it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.49it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.36it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.28it/s]
100%|██████████| 13/13 [00:01<00:00,  7.57it/s]
 Test site-3| Test Acc: 0.6421 | Bacc: 0.6348
============ Train epoch 87 ============
0 0
cla loss:  2.717371679430631 trans loss: 0.8226417479802616
0 0
cla loss:  2.6862883280270062 trans loss: 0.8221615448069932
0 0
cla loss:  2.7037006742391156 trans loss: 0.8279903665858896

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.85it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.66it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.76it/s]
 11%|█         | 4/36 [00:00<00:04,  6.65it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.75it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.83it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.64it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.60it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.74it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.69it/s]
 31%|███       | 11/36 [00:01<00:03,  6.76it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.74it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.77it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.81it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.76it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.71it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.68it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.86it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.81it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.79it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.91it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.80it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.74it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.71it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.69it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.75it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.69it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.68it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.77it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.57it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.70it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.72it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.76it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.72it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.73it/s]
100%|██████████| 36/36 [00:05<00:00,  6.56it/s]
100%|██████████| 36/36 [00:05<00:00,  6.72it/s]
 Site-0| Train Acc: 0.8767

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.66it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.75it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.79it/s]
100%|██████████| 4/4 [00:00<00:00,  6.81it/s]
100%|██████████| 4/4 [00:00<00:00,  6.78it/s]
 Site-0| Val  Acc: 0.7891

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.51it/s]
 20%|██        | 2/10 [00:00<00:01,  6.51it/s]
 30%|███       | 3/10 [00:00<00:01,  6.52it/s]
 40%|████      | 4/10 [00:00<00:00,  6.61it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.60it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.63it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.69it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.53it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.58it/s]
100%|██████████| 10/10 [00:01<00:00,  6.57it/s]
100%|██████████| 10/10 [00:01<00:00,  6.58it/s]
 Site-1| Train Acc: 0.8781

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.79it/s]
100%|██████████| 1/1 [00:00<00:00,  6.77it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.78it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.44it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.48it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.48it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.67it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.29it/s]
 30%|███       | 7/23 [00:01<00:02,  6.48it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.53it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.68it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.69it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.62it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.56it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.48it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.65it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.64it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.67it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.68it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.73it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.80it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.76it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.77it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.86it/s]
100%|██████████| 23/23 [00:03<00:00,  6.81it/s]
100%|██████████| 23/23 [00:03<00:00,  6.65it/s]
 Site-2| Train Acc: 0.8709

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.91it/s]
100%|██████████| 2/2 [00:00<00:00,  6.81it/s]
100%|██████████| 2/2 [00:00<00:00,  6.82it/s]
 Site-2| Val  Acc: 0.9219

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.33it/s]
 40%|████      | 2/5 [00:00<00:00,  6.87it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.25it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.52it/s]
100%|██████████| 5/5 [00:00<00:00,  7.10it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8742

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.85it/s]
100%|██████████| 2/2 [00:00<00:00, 10.27it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.80it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.54it/s]
100%|██████████| 3/3 [00:00<00:00,  6.70it/s]
100%|██████████| 3/3 [00:00<00:00,  6.68it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7981

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.10it/s]
 15%|█▌        | 2/13 [00:00<00:01,  6.67it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.76it/s]
 31%|███       | 4/13 [00:00<00:01,  6.89it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.31it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.53it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.75it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.39it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.25it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.19it/s]
100%|██████████| 13/13 [00:01<00:00,  7.41it/s]
 Test site-3| Test Acc: 0.6320 | Bacc: 0.6195
============ Train epoch 88 ============
0 0
cla loss:  2.712044790162513 trans loss: 0.8063666281388633
0 0
cla loss:  2.6887920334111506 trans loss: 0.818891496814076
0 0
cla loss:  2.7020635173548406 trans loss: 0.8202877302265646

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:04,  7.08it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.80it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.79it/s]
 11%|█         | 4/36 [00:00<00:04,  6.83it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.86it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.78it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.79it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.57it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.67it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.70it/s]
 31%|███       | 11/36 [00:01<00:03,  6.73it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.84it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.94it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.88it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.90it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.84it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.86it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.82it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.84it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.80it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.82it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.79it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.70it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.80it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.88it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.81it/s]
 75%|███████▌  | 27/36 [00:03<00:01,  6.66it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.44it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.56it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.75it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.79it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.79it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.80it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.61it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.71it/s]
100%|██████████| 36/36 [00:05<00:00,  6.71it/s]
100%|██████████| 36/36 [00:05<00:00,  6.76it/s]
 Site-0| Train Acc: 0.8741

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.86it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.89it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.91it/s]
100%|██████████| 4/4 [00:00<00:00,  6.99it/s]
100%|██████████| 4/4 [00:00<00:00,  6.95it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.28it/s]
 20%|██        | 2/10 [00:00<00:01,  6.77it/s]
 30%|███       | 3/10 [00:00<00:01,  6.75it/s]
 40%|████      | 4/10 [00:00<00:00,  6.86it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.86it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.73it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.78it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.52it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.65it/s]
100%|██████████| 10/10 [00:01<00:00,  6.80it/s]
100%|██████████| 10/10 [00:01<00:00,  6.74it/s]
 Site-1| Train Acc: 0.8750

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  7.01it/s]
100%|██████████| 1/1 [00:00<00:00,  6.99it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.23it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.49it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.64it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.65it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.71it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.70it/s]
 30%|███       | 7/23 [00:01<00:02,  6.65it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.54it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.58it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.73it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.76it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.92it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.99it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.98it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.97it/s]
 70%|██████▉   | 16/23 [00:02<00:00,  7.05it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  7.00it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.93it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.92it/s]
 87%|████████▋ | 20/23 [00:02<00:00,  6.88it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.88it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.97it/s]
100%|██████████| 23/23 [00:03<00:00,  6.53it/s]
100%|██████████| 23/23 [00:03<00:00,  6.77it/s]
 Site-2| Train Acc: 0.8709

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.85it/s]
100%|██████████| 2/2 [00:00<00:00,  6.75it/s]
100%|██████████| 2/2 [00:00<00:00,  6.76it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.34it/s]
 40%|████      | 2/5 [00:00<00:00,  6.83it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.30it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.48it/s]
100%|██████████| 5/5 [00:00<00:00,  7.11it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8745

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.81it/s]
100%|██████████| 2/2 [00:00<00:00, 10.28it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.86it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.82it/s]
100%|██████████| 3/3 [00:00<00:00,  6.91it/s]
100%|██████████| 3/3 [00:00<00:00,  6.89it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7981

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.19it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.49it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.30it/s]
 31%|███       | 4/13 [00:00<00:01,  7.26it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.59it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.76it/s]
 62%|██████▏   | 8/13 [00:00<00:00,  8.88it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.47it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.36it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.18it/s]
100%|██████████| 13/13 [00:01<00:00,  7.52it/s]
 Test site-3| Test Acc: 0.6294 | Bacc: 0.6191
============ Train epoch 89 ============
0 0
cla loss:  2.711006904966268 trans loss: 0.7940654694734506
0 0
cla loss:  2.6836754532914666 trans loss: 0.8284162543526846
0 0
cla loss:  2.7027042606967178 trans loss: 0.8052009718501987

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.73it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.89it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.77it/s]
 11%|█         | 4/36 [00:00<00:04,  6.64it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.71it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.78it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.88it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.88it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.92it/s]
 28%|██▊       | 10/36 [00:01<00:03,  7.01it/s]
 31%|███       | 11/36 [00:01<00:03,  6.95it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.88it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.90it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.88it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.87it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.85it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.88it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.74it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.72it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.67it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.62it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.64it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.62it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.67it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.71it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.50it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.43it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.55it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.65it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.69it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.76it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.78it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.79it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.84it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.88it/s]
100%|██████████| 36/36 [00:05<00:00,  6.88it/s]
100%|██████████| 36/36 [00:05<00:00,  6.77it/s]
 Site-0| Train Acc: 0.8698

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.59it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.67it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.71it/s]
100%|██████████| 4/4 [00:00<00:00,  6.85it/s]
100%|██████████| 4/4 [00:00<00:00,  6.78it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.70it/s]
 20%|██        | 2/10 [00:00<00:01,  6.87it/s]
 30%|███       | 3/10 [00:00<00:01,  6.78it/s]
 40%|████      | 4/10 [00:00<00:00,  6.76it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.85it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.79it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.80it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.72it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.70it/s]
100%|██████████| 10/10 [00:01<00:00,  6.81it/s]
100%|██████████| 10/10 [00:01<00:00,  6.78it/s]
 Site-1| Train Acc: 0.8812

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.62it/s]
100%|██████████| 1/1 [00:00<00:00,  6.60it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.51it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.28it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.56it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.60it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.36it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.29it/s]
 30%|███       | 7/23 [00:01<00:02,  6.47it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.58it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.57it/s]
 43%|████▎     | 10/23 [00:01<00:02,  6.48it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.53it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.55it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.59it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.59it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.65it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.62it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.67it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.56it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.64it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.80it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.77it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.73it/s]
100%|██████████| 23/23 [00:03<00:00,  6.58it/s]
100%|██████████| 23/23 [00:03<00:00,  6.57it/s]
 Site-2| Train Acc: 0.8736

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.86it/s]
100%|██████████| 2/2 [00:00<00:00,  6.68it/s]
100%|██████████| 2/2 [00:00<00:00,  6.70it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.07it/s]
 40%|████      | 2/5 [00:00<00:00,  6.40it/s]
 60%|██████    | 3/5 [00:00<00:00,  5.87it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.20it/s]
100%|██████████| 5/5 [00:00<00:00,  6.81it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8745

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.65it/s]
100%|██████████| 2/2 [00:00<00:00, 10.04it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.62it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.57it/s]
100%|██████████| 3/3 [00:00<00:00,  6.72it/s]
100%|██████████| 3/3 [00:00<00:00,  6.68it/s]
 Test site-2| Test Acc: 0.7766 | Bacc: 0.7754

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.55it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.09it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.06it/s]
 31%|███       | 4/13 [00:00<00:01,  7.07it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.44it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.66it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.85it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.45it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.26it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.19it/s]
100%|██████████| 13/13 [00:01<00:00,  7.47it/s]
 Test site-3| Test Acc: 0.6345 | Bacc: 0.6259
============ Train epoch 90 ============
0 0
cla loss:  2.7187652504024795 trans loss: 0.8057974612892572
0 0
cla loss:  2.6849779064331822 trans loss: 0.8225013970130652
0 0
cla loss:  2.7021753764032717 trans loss: 0.8129744562671413

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.94it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.76it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.78it/s]
 11%|█         | 4/36 [00:00<00:04,  6.57it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.59it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.46it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.58it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.62it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.60it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.58it/s]
 31%|███       | 11/36 [00:01<00:03,  6.47it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.46it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.61it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.63it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.60it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.61it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.68it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.61it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.66it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.60it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.64it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.58it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.62it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.60it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.73it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.66it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.71it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.58it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.68it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.60it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.59it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.64it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.71it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.77it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.82it/s]
100%|██████████| 36/36 [00:05<00:00,  6.77it/s]
100%|██████████| 36/36 [00:05<00:00,  6.64it/s]
 Site-0| Train Acc: 0.8767

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.60it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.32it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.56it/s]
100%|██████████| 4/4 [00:00<00:00,  6.68it/s]
100%|██████████| 4/4 [00:00<00:00,  6.60it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.62it/s]
 20%|██        | 2/10 [00:00<00:01,  6.70it/s]
 30%|███       | 3/10 [00:00<00:01,  6.55it/s]
 40%|████      | 4/10 [00:00<00:00,  6.61it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.54it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.61it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.77it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.69it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.52it/s]
100%|██████████| 10/10 [00:01<00:00,  6.60it/s]
100%|██████████| 10/10 [00:01<00:00,  6.61it/s]
 Site-1| Train Acc: 0.8781

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.83it/s]
100%|██████████| 1/1 [00:00<00:00,  6.81it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.09it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.41it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.28it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.55it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.58it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.69it/s]
 30%|███       | 7/23 [00:01<00:02,  6.67it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.62it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.65it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.65it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.69it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.74it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.70it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.65it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.65it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.66it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.54it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.59it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.57it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.59it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.66it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.78it/s]
100%|██████████| 23/23 [00:03<00:00,  6.79it/s]
100%|██████████| 23/23 [00:03<00:00,  6.64it/s]
 Site-2| Train Acc: 0.8709

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.73it/s]
100%|██████████| 2/2 [00:00<00:00,  6.59it/s]
100%|██████████| 2/2 [00:00<00:00,  6.60it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.16it/s]
 40%|████      | 2/5 [00:00<00:00,  6.66it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.14it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.40it/s]
100%|██████████| 5/5 [00:00<00:00,  6.99it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8685

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.64it/s]
100%|██████████| 2/2 [00:00<00:00, 10.01it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.63it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.54it/s]
100%|██████████| 3/3 [00:00<00:00,  6.65it/s]
100%|██████████| 3/3 [00:00<00:00,  6.62it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7981

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.05it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.03it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.96it/s]
 31%|███       | 4/13 [00:00<00:01,  7.02it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.41it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.64it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.81it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.30it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.24it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.20it/s]
100%|██████████| 13/13 [00:01<00:00,  7.46it/s]
 Test site-3| Test Acc: 0.6244 | Bacc: 0.6097
============ Train epoch 91 ============
0 0
cla loss:  2.717371679430631 trans loss: 0.8226417479802616
0 0
cla loss:  2.6862883280270062 trans loss: 0.8221615448069932
0 0
cla loss:  2.7037006742391156 trans loss: 0.8279903665858896

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.85it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.66it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.76it/s]
 11%|█         | 4/36 [00:00<00:04,  6.65it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.75it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.83it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.64it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.60it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.74it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.69it/s]
 31%|███       | 11/36 [00:01<00:03,  6.76it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.74it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.77it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.81it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.76it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.71it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.68it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.86it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.81it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.79it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.91it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.80it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.74it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.71it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.69it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.75it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.69it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.68it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.77it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.57it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.70it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.72it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.76it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.72it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.73it/s]
100%|██████████| 36/36 [00:05<00:00,  6.56it/s]
100%|██████████| 36/36 [00:05<00:00,  6.72it/s]
 Site-0| Train Acc: 0.8767

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.66it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.75it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.79it/s]
100%|██████████| 4/4 [00:00<00:00,  6.81it/s]
100%|██████████| 4/4 [00:00<00:00,  6.78it/s]
 Site-0| Val  Acc: 0.7891

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.51it/s]
 20%|██        | 2/10 [00:00<00:01,  6.51it/s]
 30%|███       | 3/10 [00:00<00:01,  6.52it/s]
 40%|████      | 4/10 [00:00<00:00,  6.61it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.60it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.63it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.69it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.53it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.58it/s]
100%|██████████| 10/10 [00:01<00:00,  6.57it/s]
100%|██████████| 10/10 [00:01<00:00,  6.58it/s]
 Site-1| Train Acc: 0.8781

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.79it/s]
100%|██████████| 1/1 [00:00<00:00,  6.77it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.78it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.44it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.48it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.48it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.67it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.29it/s]
 30%|███       | 7/23 [00:01<00:02,  6.48it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.53it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.68it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.69it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.62it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.56it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.48it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.65it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.64it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.67it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.68it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.73it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.80it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.76it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.77it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.86it/s]
100%|██████████| 23/23 [00:03<00:00,  6.81it/s]
100%|██████████| 23/23 [00:03<00:00,  6.65it/s]
 Site-2| Train Acc: 0.8709

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.91it/s]
100%|██████████| 2/2 [00:00<00:00,  6.81it/s]
100%|██████████| 2/2 [00:00<00:00,  6.82it/s]
 Site-2| Val  Acc: 0.9219

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.33it/s]
 40%|████      | 2/5 [00:00<00:00,  6.87it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.25it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.52it/s]
100%|██████████| 5/5 [00:00<00:00,  7.10it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8742

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.85it/s]
100%|██████████| 2/2 [00:00<00:00, 10.27it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.80it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.54it/s]
100%|██████████| 3/3 [00:00<00:00,  6.70it/s]
100%|██████████| 3/3 [00:00<00:00,  6.68it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7981

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.10it/s]
 15%|█▌        | 2/13 [00:00<00:01,  6.67it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.76it/s]
 31%|███       | 4/13 [00:00<00:01,  6.89it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.31it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.53it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.75it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.39it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.25it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.19it/s]
100%|██████████| 13/13 [00:01<00:00,  7.41it/s]
 Test site-3| Test Acc: 0.6320 | Bacc: 0.6195
============ Train epoch 92 ============
0 0
cla loss:  2.712044790162513 trans loss: 0.8063666281388633
0 0
cla loss:  2.6887920334111506 trans loss: 0.818891496814076
0 0
cla loss:  2.7020635173548406 trans loss: 0.8202877302265646

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:04,  7.08it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.80it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.79it/s]
 11%|█         | 4/36 [00:00<00:04,  6.83it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.86it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.78it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.79it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.57it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.67it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.70it/s]
 31%|███       | 11/36 [00:01<00:03,  6.73it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.84it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.94it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.88it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.90it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.84it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.86it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.82it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.84it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.80it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.82it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.79it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.70it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.80it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.88it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.81it/s]
 75%|███████▌  | 27/36 [00:03<00:01,  6.66it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.44it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.56it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.75it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.79it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.79it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.80it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.61it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.71it/s]
100%|██████████| 36/36 [00:05<00:00,  6.71it/s]
100%|██████████| 36/36 [00:05<00:00,  6.76it/s]
 Site-0| Train Acc: 0.8741

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.86it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.89it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.91it/s]
100%|██████████| 4/4 [00:00<00:00,  6.99it/s]
100%|██████████| 4/4 [00:00<00:00,  6.95it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.28it/s]
 20%|██        | 2/10 [00:00<00:01,  6.77it/s]
 30%|███       | 3/10 [00:00<00:01,  6.75it/s]
 40%|████      | 4/10 [00:00<00:00,  6.86it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.86it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.73it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.78it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.52it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.65it/s]
100%|██████████| 10/10 [00:01<00:00,  6.80it/s]
100%|██████████| 10/10 [00:01<00:00,  6.74it/s]
 Site-1| Train Acc: 0.8750

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  7.01it/s]
100%|██████████| 1/1 [00:00<00:00,  6.99it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.23it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.49it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.64it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.65it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.71it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.70it/s]
 30%|███       | 7/23 [00:01<00:02,  6.65it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.54it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.58it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.73it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.76it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.92it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.99it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.98it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.97it/s]
 70%|██████▉   | 16/23 [00:02<00:00,  7.05it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  7.00it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.93it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.92it/s]
 87%|████████▋ | 20/23 [00:02<00:00,  6.88it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.88it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.97it/s]
100%|██████████| 23/23 [00:03<00:00,  6.53it/s]
100%|██████████| 23/23 [00:03<00:00,  6.77it/s]
 Site-2| Train Acc: 0.8709

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.85it/s]
100%|██████████| 2/2 [00:00<00:00,  6.75it/s]
100%|██████████| 2/2 [00:00<00:00,  6.76it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.34it/s]
 40%|████      | 2/5 [00:00<00:00,  6.83it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.30it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.48it/s]
100%|██████████| 5/5 [00:00<00:00,  7.11it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8745

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.81it/s]
100%|██████████| 2/2 [00:00<00:00, 10.28it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.86it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.82it/s]
100%|██████████| 3/3 [00:00<00:00,  6.91it/s]
100%|██████████| 3/3 [00:00<00:00,  6.89it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7981

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.19it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.49it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.30it/s]
 31%|███       | 4/13 [00:00<00:01,  7.26it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.59it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.76it/s]
 62%|██████▏   | 8/13 [00:00<00:00,  8.88it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.47it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.36it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.18it/s]
100%|██████████| 13/13 [00:01<00:00,  7.52it/s]
 Test site-3| Test Acc: 0.6294 | Bacc: 0.6191
============ Train epoch 93 ============
0 0
cla loss:  2.7158726962966537 trans loss: 0.8051266712159967
0 0
cla loss:  2.6826381779196273 trans loss: 0.8119061017156246
0 0
cla loss:  2.697703696974558 trans loss: 0.7963734038511113

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.83it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.58it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.69it/s]
 11%|█         | 4/36 [00:00<00:04,  6.73it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.51it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.52it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.59it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.39it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.55it/s]
 28%|██▊       | 10/36 [00:01<00:04,  6.45it/s]
 31%|███       | 11/36 [00:01<00:03,  6.40it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.48it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.51it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.62it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.67it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.64it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.61it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.54it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.59it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.63it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.70it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.48it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.65it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.51it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.52it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.56it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.68it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.69it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.79it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.81it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.75it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.93it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.83it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.79it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.91it/s]
100%|██████████| 36/36 [00:05<00:00,  6.92it/s]
100%|██████████| 36/36 [00:05<00:00,  6.65it/s]
 Site-0| Train Acc: 0.8724

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.55it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.56it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.50it/s]
100%|██████████| 4/4 [00:00<00:00,  6.64it/s]
100%|██████████| 4/4 [00:00<00:00,  6.60it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.87it/s]
 20%|██        | 2/10 [00:00<00:01,  6.74it/s]
 30%|███       | 3/10 [00:00<00:01,  6.76it/s]
 40%|████      | 4/10 [00:00<00:00,  6.76it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.64it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.76it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.72it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.70it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.60it/s]
100%|██████████| 10/10 [00:01<00:00,  6.58it/s]
100%|██████████| 10/10 [00:01<00:00,  6.67it/s]
 Site-1| Train Acc: 0.8719

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.88it/s]
100%|██████████| 1/1 [00:00<00:00,  6.86it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.79it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.66it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.45it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.47it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.53it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.56it/s]
 30%|███       | 7/23 [00:01<00:02,  6.57it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.70it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.75it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.72it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.77it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.88it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.67it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.66it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.75it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.60it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.66it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.73it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.63it/s]
 87%|████████▋ | 20/23 [00:02<00:00,  6.82it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.69it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.67it/s]
100%|██████████| 23/23 [00:03<00:00,  6.63it/s]
100%|██████████| 23/23 [00:03<00:00,  6.66it/s]
 Site-2| Train Acc: 0.8655

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.77it/s]
100%|██████████| 2/2 [00:00<00:00,  6.63it/s]
100%|██████████| 2/2 [00:00<00:00,  6.64it/s]
 Site-2| Val  Acc: 0.8906

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.22it/s]
 40%|████      | 2/5 [00:00<00:00,  6.71it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.13it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.32it/s]
100%|██████████| 5/5 [00:00<00:00,  6.96it/s]
 Test site-0| Test Acc: 0.8367 | Bacc: 0.8631

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.67it/s]
100%|██████████| 2/2 [00:00<00:00,  9.78it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.66it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.64it/s]
100%|██████████| 3/3 [00:00<00:00,  6.74it/s]
100%|██████████| 3/3 [00:00<00:00,  6.71it/s]
 Test site-2| Test Acc: 0.8085 | Bacc: 0.8160

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.18it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.18it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.07it/s]
 31%|███       | 4/13 [00:00<00:01,  7.10it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.46it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.71it/s]
 62%|██████▏   | 8/13 [00:00<00:00,  8.91it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.57it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.31it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.23it/s]
100%|██████████| 13/13 [00:01<00:00,  7.53it/s]
 Test site-3| Test Acc: 0.6396 | Bacc: 0.6315
============ Train epoch 94 ============
0 0
cla loss:  2.7199282011195045 trans loss: 0.8189651471885604
0 0
cla loss:  2.6853154580197742 trans loss: 0.8179069571758635
0 0
cla loss:  2.698817509502622 trans loss: 0.8095918932751794

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:04,  7.19it/s]
  6%|▌         | 2/36 [00:00<00:04,  7.07it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.97it/s]
 11%|█         | 4/36 [00:00<00:04,  6.92it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.95it/s]
 17%|█▋        | 6/36 [00:00<00:04,  7.00it/s]
 19%|█▉        | 7/36 [00:00<00:04,  7.04it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.96it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.89it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.74it/s]
 31%|███       | 11/36 [00:01<00:03,  6.80it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.83it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.83it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.81it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.86it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.86it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.94it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.90it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.72it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.62it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.68it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.72it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.75it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.72it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.70it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.75it/s]
 75%|███████▌  | 27/36 [00:03<00:01,  6.69it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.70it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.82it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.79it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.91it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.83it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.81it/s]
 94%|█████████▍| 34/36 [00:04<00:00,  6.89it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.92it/s]
100%|██████████| 36/36 [00:05<00:00,  6.96it/s]
100%|██████████| 36/36 [00:05<00:00,  6.84it/s]
 Site-0| Train Acc: 0.8689

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.63it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.76it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.79it/s]
100%|██████████| 4/4 [00:00<00:00,  6.90it/s]
100%|██████████| 4/4 [00:00<00:00,  6.84it/s]
 Site-0| Val  Acc: 0.8125

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.85it/s]
 20%|██        | 2/10 [00:00<00:01,  6.87it/s]
 30%|███       | 3/10 [00:00<00:01,  6.74it/s]
 40%|████      | 4/10 [00:00<00:00,  6.80it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.94it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.87it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.79it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.88it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.93it/s]
100%|██████████| 10/10 [00:01<00:00,  6.76it/s]
100%|██████████| 10/10 [00:01<00:00,  6.82it/s]
 Site-1| Train Acc: 0.8750

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  7.00it/s]
100%|██████████| 1/1 [00:00<00:00,  6.98it/s]
 Site-1| Val  Acc: 0.8438

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.68it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.77it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.66it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.64it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.61it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.60it/s]
 30%|███       | 7/23 [00:01<00:02,  6.59it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.49it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.38it/s]
 43%|████▎     | 10/23 [00:01<00:02,  6.32it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.34it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.31it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.52it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.42it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.19it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.26it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.39it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.55it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.64it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.66it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.62it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.73it/s]
100%|██████████| 23/23 [00:03<00:00,  6.71it/s]
100%|██████████| 23/23 [00:03<00:00,  6.53it/s]
 Site-2| Train Acc: 0.8696

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.91it/s]
100%|██████████| 2/2 [00:00<00:00,  6.81it/s]
100%|██████████| 2/2 [00:00<00:00,  6.82it/s]
 Site-2| Val  Acc: 0.9219

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.37it/s]
 40%|████      | 2/5 [00:00<00:00,  6.89it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.27it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.49it/s]
100%|██████████| 5/5 [00:00<00:00,  7.13it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8685

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.83it/s]
100%|██████████| 2/2 [00:00<00:00, 10.30it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.80it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.76it/s]
100%|██████████| 3/3 [00:00<00:00,  6.88it/s]
100%|██████████| 3/3 [00:00<00:00,  6.85it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7981

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.12it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.42it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.21it/s]
 31%|███       | 4/13 [00:00<00:01,  6.88it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.31it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.60it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.82it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.48it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.30it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.24it/s]
100%|██████████| 13/13 [00:01<00:00,  7.52it/s]
 Test site-3| Test Acc: 0.6117 | Bacc: 0.5949
============ Train epoch 95 ============
0 0
cla loss:  2.711006904966268 trans loss: 0.7940654694734506
0 0
cla loss:  2.6836754532914666 trans loss: 0.8284162543526846
0 0
cla loss:  2.7027042606967178 trans loss: 0.8052009718501987

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.73it/s]
  6%|▌         | 2/36 [00:00<00:04,  6.89it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.77it/s]
 11%|█         | 4/36 [00:00<00:04,  6.64it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.71it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.78it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.88it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.88it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.92it/s]
 28%|██▊       | 10/36 [00:01<00:03,  7.01it/s]
 31%|███       | 11/36 [00:01<00:03,  6.95it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.88it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.90it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.88it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.87it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.85it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.88it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.74it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.72it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.67it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.62it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.64it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.62it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.67it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.71it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.50it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.43it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.55it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.65it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.69it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.76it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.78it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.79it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.84it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.88it/s]
100%|██████████| 36/36 [00:05<00:00,  6.88it/s]
100%|██████████| 36/36 [00:05<00:00,  6.77it/s]
 Site-0| Train Acc: 0.8698

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.59it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.67it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.71it/s]
100%|██████████| 4/4 [00:00<00:00,  6.85it/s]
100%|██████████| 4/4 [00:00<00:00,  6.78it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.70it/s]
 20%|██        | 2/10 [00:00<00:01,  6.87it/s]
 30%|███       | 3/10 [00:00<00:01,  6.78it/s]
 40%|████      | 4/10 [00:00<00:00,  6.76it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.85it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.79it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.80it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.72it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.70it/s]
100%|██████████| 10/10 [00:01<00:00,  6.81it/s]
100%|██████████| 10/10 [00:01<00:00,  6.78it/s]
 Site-1| Train Acc: 0.8812

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.62it/s]
100%|██████████| 1/1 [00:00<00:00,  6.60it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.51it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.28it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.56it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.60it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.36it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.29it/s]
 30%|███       | 7/23 [00:01<00:02,  6.47it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.58it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.57it/s]
 43%|████▎     | 10/23 [00:01<00:02,  6.48it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.53it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.55it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.59it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.59it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.65it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.62it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.67it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.56it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.64it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.80it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.77it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.73it/s]
100%|██████████| 23/23 [00:03<00:00,  6.58it/s]
100%|██████████| 23/23 [00:03<00:00,  6.57it/s]
 Site-2| Train Acc: 0.8736

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.86it/s]
100%|██████████| 2/2 [00:00<00:00,  6.68it/s]
100%|██████████| 2/2 [00:00<00:00,  6.70it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.07it/s]
 40%|████      | 2/5 [00:00<00:00,  6.40it/s]
 60%|██████    | 3/5 [00:00<00:00,  5.87it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.20it/s]
100%|██████████| 5/5 [00:00<00:00,  6.81it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8745

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.65it/s]
100%|██████████| 2/2 [00:00<00:00, 10.04it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.62it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.57it/s]
100%|██████████| 3/3 [00:00<00:00,  6.72it/s]
100%|██████████| 3/3 [00:00<00:00,  6.68it/s]
 Test site-2| Test Acc: 0.7766 | Bacc: 0.7754

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.55it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.09it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.06it/s]
 31%|███       | 4/13 [00:00<00:01,  7.07it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.44it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.66it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.85it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.45it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.26it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.19it/s]
100%|██████████| 13/13 [00:01<00:00,  7.47it/s]
 Test site-3| Test Acc: 0.6345 | Bacc: 0.6259
============ Train epoch 96 ============
0 0
cla loss:  2.7187652504024795 trans loss: 0.8057974612892572
0 0
cla loss:  2.6849779064331822 trans loss: 0.8225013970130652
0 0
cla loss:  2.7021753764032717 trans loss: 0.8129744562671413

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.94it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.76it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.78it/s]
 11%|█         | 4/36 [00:00<00:04,  6.57it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.59it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.46it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.58it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.62it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.60it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.58it/s]
 31%|███       | 11/36 [00:01<00:03,  6.47it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.46it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.61it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.63it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.60it/s]
 44%|████▍     | 16/36 [00:02<00:03,  6.61it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.68it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.61it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.66it/s]
 56%|█████▌    | 20/36 [00:03<00:02,  6.60it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.64it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.58it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.62it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.60it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.73it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.66it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.71it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.58it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.68it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.60it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.59it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.64it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.71it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.77it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.82it/s]
100%|██████████| 36/36 [00:05<00:00,  6.77it/s]
100%|██████████| 36/36 [00:05<00:00,  6.64it/s]
 Site-0| Train Acc: 0.8767

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.60it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.32it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.56it/s]
100%|██████████| 4/4 [00:00<00:00,  6.68it/s]
100%|██████████| 4/4 [00:00<00:00,  6.60it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.62it/s]
 20%|██        | 2/10 [00:00<00:01,  6.70it/s]
 30%|███       | 3/10 [00:00<00:01,  6.55it/s]
 40%|████      | 4/10 [00:00<00:00,  6.61it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.54it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.61it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.77it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.69it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.52it/s]
100%|██████████| 10/10 [00:01<00:00,  6.60it/s]
100%|██████████| 10/10 [00:01<00:00,  6.61it/s]
 Site-1| Train Acc: 0.8781

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.83it/s]
100%|██████████| 1/1 [00:00<00:00,  6.81it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.09it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.41it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.28it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.55it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.58it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.69it/s]
 30%|███       | 7/23 [00:01<00:02,  6.67it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.62it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.65it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.65it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.69it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.74it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.70it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.65it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.65it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.66it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.54it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.59it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.57it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.59it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.66it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.78it/s]
100%|██████████| 23/23 [00:03<00:00,  6.79it/s]
100%|██████████| 23/23 [00:03<00:00,  6.64it/s]
 Site-2| Train Acc: 0.8709

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.73it/s]
100%|██████████| 2/2 [00:00<00:00,  6.59it/s]
100%|██████████| 2/2 [00:00<00:00,  6.60it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.16it/s]
 40%|████      | 2/5 [00:00<00:00,  6.66it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.14it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.40it/s]
100%|██████████| 5/5 [00:00<00:00,  6.99it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8685

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.64it/s]
100%|██████████| 2/2 [00:00<00:00, 10.01it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.63it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.54it/s]
100%|██████████| 3/3 [00:00<00:00,  6.65it/s]
100%|██████████| 3/3 [00:00<00:00,  6.62it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7981

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.05it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.03it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.96it/s]
 31%|███       | 4/13 [00:00<00:01,  7.02it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.41it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.64it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.81it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.30it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.24it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.20it/s]
100%|██████████| 13/13 [00:01<00:00,  7.46it/s]
 Test site-3| Test Acc: 0.6244 | Bacc: 0.6097
============ Train epoch 97 ============
0 0
cla loss:  2.709275360682502 trans loss: 0.8140966592721604
0 0
cla loss:  2.685204747933239 trans loss: 0.8192188907508275
0 0
cla loss:  2.703489067566455 trans loss: 0.811493787334193

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.68it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.75it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.84it/s]
 11%|█         | 4/36 [00:00<00:04,  6.91it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.90it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.91it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.80it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.58it/s]
 25%|██▌       | 9/36 [00:01<00:04,  6.44it/s]
 28%|██▊       | 10/36 [00:01<00:04,  6.41it/s]
 31%|███       | 11/36 [00:01<00:03,  6.51it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.57it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.57it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.66it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.66it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.72it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.71it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.83it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.91it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.92it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.86it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.79it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.89it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.86it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.82it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.85it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.81it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.57it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.64it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.66it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.61it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.65it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.71it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.65it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.53it/s]
100%|██████████| 36/36 [00:05<00:00,  6.63it/s]
100%|██████████| 36/36 [00:05<00:00,  6.71it/s]
 Site-0| Train Acc: 0.8759

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.58it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.59it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.67it/s]
100%|██████████| 4/4 [00:00<00:00,  6.73it/s]
100%|██████████| 4/4 [00:00<00:00,  6.69it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  7.18it/s]
 20%|██        | 2/10 [00:00<00:01,  6.67it/s]
 30%|███       | 3/10 [00:00<00:01,  6.65it/s]
 40%|████      | 4/10 [00:00<00:00,  6.79it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.74it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.75it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.73it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.73it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.83it/s]
100%|██████████| 10/10 [00:01<00:00,  6.68it/s]
100%|██████████| 10/10 [00:01<00:00,  6.73it/s]
 Site-1| Train Acc: 0.8781

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  7.01it/s]
100%|██████████| 1/1 [00:00<00:00,  6.99it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.55it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.78it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.64it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.65it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.58it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.80it/s]
 30%|███       | 7/23 [00:01<00:02,  6.50it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.47it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.58it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.68it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.83it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.80it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.62it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.61it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.68it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.67it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.51it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.39it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.47it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.56it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.58it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.71it/s]
100%|██████████| 23/23 [00:03<00:00,  6.65it/s]
100%|██████████| 23/23 [00:03<00:00,  6.62it/s]
 Site-2| Train Acc: 0.8736

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.85it/s]
100%|██████████| 2/2 [00:00<00:00,  6.75it/s]
100%|██████████| 2/2 [00:00<00:00,  6.75it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.15it/s]
 40%|████      | 2/5 [00:00<00:00,  6.73it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.25it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.53it/s]
100%|██████████| 5/5 [00:00<00:00,  7.11it/s]
 Test site-0| Test Acc: 0.8571 | Bacc: 0.8801

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.78it/s]
100%|██████████| 2/2 [00:00<00:00, 10.22it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.78it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.74it/s]
100%|██████████| 3/3 [00:00<00:00,  6.83it/s]
100%|██████████| 3/3 [00:00<00:00,  6.80it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7981

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.08it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.36it/s]
 23%|██▎       | 3/13 [00:00<00:01,  6.96it/s]
 31%|███       | 4/13 [00:00<00:01,  6.76it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.23it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.51it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.77it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.46it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.31it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.23it/s]
100%|██████████| 13/13 [00:01<00:00,  7.46it/s]
 Test site-3| Test Acc: 0.6320 | Bacc: 0.6213
============ Train epoch 92 ============
0 0
cla loss:  2.717819545736265 trans loss: 0.8220389745942313
0 0
cla loss:  2.6828164623011297 trans loss: 0.8152237669307383
0 0
cla loss:  2.7003355984711765 trans loss: 0.8073845886105868

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.81it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.76it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.71it/s]
 11%|█         | 4/36 [00:00<00:04,  6.66it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.71it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.80it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.72it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.77it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.88it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.70it/s]
 31%|███       | 11/36 [00:01<00:03,  6.74it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.62it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.68it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.74it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.74it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.72it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.45it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.53it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.61it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.55it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.54it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.53it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.55it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.46it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.58it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.66it/s]
 75%|███████▌  | 27/36 [00:04<00:01,  6.77it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.78it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.84it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.62it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.62it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.55it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.63it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.70it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.64it/s]
100%|██████████| 36/36 [00:05<00:00,  6.67it/s]
100%|██████████| 36/36 [00:05<00:00,  6.66it/s]
 Site-0| Train Acc: 0.8750

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.61it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.62it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.77it/s]
100%|██████████| 4/4 [00:00<00:00,  6.82it/s]
100%|██████████| 4/4 [00:00<00:00,  6.76it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.71it/s]
 20%|██        | 2/10 [00:00<00:01,  6.63it/s]
 30%|███       | 3/10 [00:00<00:01,  6.53it/s]
 40%|████      | 4/10 [00:00<00:00,  6.64it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.62it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.72it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.57it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.64it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.80it/s]
100%|██████████| 10/10 [00:01<00:00,  6.61it/s]
100%|██████████| 10/10 [00:01<00:00,  6.63it/s]
 Site-1| Train Acc: 0.8906

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.89it/s]
100%|██████████| 1/1 [00:00<00:00,  6.87it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.35it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.53it/s]
 13%|█▎        | 3/23 [00:00<00:03,  6.37it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.52it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.63it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.64it/s]
 30%|███       | 7/23 [00:01<00:02,  6.67it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.60it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.61it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.71it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.53it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.53it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.47it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.50it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.66it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.71it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.79it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.82it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.86it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.75it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.85it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.73it/s]
100%|██████████| 23/23 [00:03<00:00,  6.68it/s]
100%|██████████| 23/23 [00:03<00:00,  6.65it/s]
 Site-2| Train Acc: 0.8750

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.45it/s]
100%|██████████| 2/2 [00:00<00:00,  6.45it/s]
100%|██████████| 2/2 [00:00<00:00,  6.44it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.12it/s]
 40%|████      | 2/5 [00:00<00:00,  6.46it/s]
 60%|██████    | 3/5 [00:00<00:00,  5.89it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.25it/s]
100%|██████████| 5/5 [00:00<00:00,  6.83it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8742

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.69it/s]
100%|██████████| 2/2 [00:00<00:00, 10.08it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.68it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.62it/s]
100%|██████████| 3/3 [00:00<00:00,  6.61it/s]
100%|██████████| 3/3 [00:00<00:00,  6.61it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7854

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.99it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.33it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.13it/s]
 31%|███       | 4/13 [00:00<00:01,  7.11it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.44it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.64it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.78it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  9.45it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.22it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.20it/s]
100%|██████████| 13/13 [00:01<00:00,  7.49it/s]
 Test site-3| Test Acc: 0.6218 | Bacc: 0.6066
============ Train epoch 98 ============
0 0
cla loss:  2.719140167811408 trans loss: 0.8202430108683793
0 0
cla loss:  2.6859805428203027 trans loss: 0.8188413186888
0 0
cla loss:  2.708303356889504 trans loss: 0.8228139622726632

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:05,  6.97it/s]
  6%|▌         | 2/36 [00:00<00:04,  7.20it/s]
  8%|▊         | 3/36 [00:00<00:04,  6.86it/s]
 11%|█         | 4/36 [00:00<00:04,  6.95it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.87it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.86it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.76it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.73it/s]
 25%|██▌       | 9/36 [00:01<00:03,  6.82it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.88it/s]
 31%|███       | 11/36 [00:01<00:03,  6.87it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.73it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.79it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.86it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.71it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.77it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.65it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.68it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.81it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.75it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.80it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.83it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.83it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.78it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.83it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.80it/s]
 75%|███████▌  | 27/36 [00:03<00:01,  6.85it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.77it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.81it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.78it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.59it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.66it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.52it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.40it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.51it/s]
100%|██████████| 36/36 [00:05<00:00,  6.64it/s]
100%|██████████| 36/36 [00:05<00:00,  6.75it/s]
 Site-0| Train Acc: 0.8802

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.60it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.59it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.68it/s]
100%|██████████| 4/4 [00:00<00:00,  6.80it/s]
100%|██████████| 4/4 [00:00<00:00,  6.73it/s]
 Site-0| Val  Acc: 0.7969

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.53it/s]
 20%|██        | 2/10 [00:00<00:01,  6.61it/s]
 30%|███       | 3/10 [00:00<00:01,  6.51it/s]
 40%|████      | 4/10 [00:00<00:00,  6.77it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.90it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.93it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.77it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.69it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.81it/s]
100%|██████████| 10/10 [00:01<00:00,  6.80it/s]
100%|██████████| 10/10 [00:01<00:00,  6.76it/s]
 Site-1| Train Acc: 0.8750

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  6.85it/s]
100%|██████████| 1/1 [00:00<00:00,  6.83it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  7.14it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.69it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.69it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.87it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.59it/s]
 26%|██▌       | 6/23 [00:00<00:02,  6.70it/s]
 30%|███       | 7/23 [00:01<00:02,  6.63it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.51it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.61it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.53it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.55it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.60it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.61it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.49it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.53it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.62it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.65it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.55it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.59it/s]
 87%|████████▋ | 20/23 [00:03<00:00,  6.66it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.61it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.62it/s]
100%|██████████| 23/23 [00:03<00:00,  6.71it/s]
100%|██████████| 23/23 [00:03<00:00,  6.63it/s]
 Site-2| Train Acc: 0.8709

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.61it/s]
100%|██████████| 2/2 [00:00<00:00,  6.31it/s]
100%|██████████| 2/2 [00:00<00:00,  6.34it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.18it/s]
 40%|████      | 2/5 [00:00<00:00,  6.59it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.08it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.40it/s]
100%|██████████| 5/5 [00:00<00:00,  6.99it/s]
 Test site-0| Test Acc: 0.8503 | Bacc: 0.8742

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.80it/s]
100%|██████████| 2/2 [00:00<00:00, 10.25it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.79it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.70it/s]
100%|██████████| 3/3 [00:00<00:00,  6.79it/s]
100%|██████████| 3/3 [00:00<00:00,  6.77it/s]
 Test site-2| Test Acc: 0.8085 | Bacc: 0.8181

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  6.65it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.03it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.00it/s]
 31%|███       | 4/13 [00:00<00:01,  7.00it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.28it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.55it/s]
 54%|█████▍    | 7/13 [00:00<00:00,  7.99it/s]
 62%|██████▏   | 8/13 [00:01<00:00,  8.39it/s]
 69%|██████▉   | 9/13 [00:01<00:00,  8.68it/s]
 77%|███████▋  | 10/13 [00:01<00:00,  8.85it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  6.27it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  5.46it/s]
100%|██████████| 13/13 [00:01<00:00,  7.14it/s]
 Test site-3| Test Acc: 0.6244 | Bacc: 0.6117
============ Train epoch 99 ============
0 0
cla loss:  2.7103543173727678 trans loss: 0.8148189219997157
0 0
cla loss:  2.6809351408301887 trans loss: 0.8020470648554702
0 0
cla loss:  2.698392398393334 trans loss: 0.8160714381304218

  0%|          | 0/36 [00:00<?, ?it/s]
  3%|▎         | 1/36 [00:00<00:04,  7.16it/s]
  6%|▌         | 2/36 [00:00<00:05,  6.69it/s]
  8%|▊         | 3/36 [00:00<00:05,  6.55it/s]
 11%|█         | 4/36 [00:00<00:04,  6.62it/s]
 14%|█▍        | 5/36 [00:00<00:04,  6.78it/s]
 17%|█▋        | 6/36 [00:00<00:04,  6.88it/s]
 19%|█▉        | 7/36 [00:01<00:04,  6.92it/s]
 22%|██▏       | 8/36 [00:01<00:04,  6.88it/s]
 25%|██▌       | 9/36 [00:01<00:03,  7.01it/s]
 28%|██▊       | 10/36 [00:01<00:03,  6.90it/s]
 31%|███       | 11/36 [00:01<00:03,  6.96it/s]
 33%|███▎      | 12/36 [00:01<00:03,  6.75it/s]
 36%|███▌      | 13/36 [00:01<00:03,  6.66it/s]
 39%|███▉      | 14/36 [00:02<00:03,  6.70it/s]
 42%|████▏     | 15/36 [00:02<00:03,  6.67it/s]
 44%|████▍     | 16/36 [00:02<00:02,  6.75it/s]
 47%|████▋     | 17/36 [00:02<00:02,  6.76it/s]
 50%|█████     | 18/36 [00:02<00:02,  6.80it/s]
 53%|█████▎    | 19/36 [00:02<00:02,  6.88it/s]
 56%|█████▌    | 20/36 [00:02<00:02,  6.97it/s]
 58%|█████▊    | 21/36 [00:03<00:02,  6.89it/s]
 61%|██████    | 22/36 [00:03<00:02,  6.94it/s]
 64%|██████▍   | 23/36 [00:03<00:01,  6.98it/s]
 67%|██████▋   | 24/36 [00:03<00:01,  6.88it/s]
 69%|██████▉   | 25/36 [00:03<00:01,  6.86it/s]
 72%|███████▏  | 26/36 [00:03<00:01,  6.81it/s]
 75%|███████▌  | 27/36 [00:03<00:01,  6.79it/s]
 78%|███████▊  | 28/36 [00:04<00:01,  6.72it/s]
 81%|████████  | 29/36 [00:04<00:01,  6.63it/s]
 83%|████████▎ | 30/36 [00:04<00:00,  6.54it/s]
 86%|████████▌ | 31/36 [00:04<00:00,  6.54it/s]
 89%|████████▉ | 32/36 [00:04<00:00,  6.57it/s]
 92%|█████████▏| 33/36 [00:04<00:00,  6.62it/s]
 94%|█████████▍| 34/36 [00:05<00:00,  6.69it/s]
 97%|█████████▋| 35/36 [00:05<00:00,  6.71it/s]
100%|██████████| 36/36 [00:05<00:00,  6.67it/s]
100%|██████████| 36/36 [00:05<00:00,  6.77it/s]
 Site-0| Train Acc: 0.8681

  0%|          | 0/4 [00:00<?, ?it/s]
 25%|██▌       | 1/4 [00:00<00:00,  6.77it/s]
 50%|█████     | 2/4 [00:00<00:00,  6.83it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  6.93it/s]
100%|██████████| 4/4 [00:00<00:00,  7.00it/s]
100%|██████████| 4/4 [00:00<00:00,  6.95it/s]
 Site-0| Val  Acc: 0.8125

  0%|          | 0/10 [00:00<?, ?it/s]
 10%|█         | 1/10 [00:00<00:01,  6.76it/s]
 20%|██        | 2/10 [00:00<00:01,  6.85it/s]
 30%|███       | 3/10 [00:00<00:01,  6.84it/s]
 40%|████      | 4/10 [00:00<00:00,  6.87it/s]
 50%|█████     | 5/10 [00:00<00:00,  6.86it/s]
 60%|██████    | 6/10 [00:00<00:00,  6.86it/s]
 70%|███████   | 7/10 [00:01<00:00,  6.91it/s]
 80%|████████  | 8/10 [00:01<00:00,  6.74it/s]
 90%|█████████ | 9/10 [00:01<00:00,  6.74it/s]
100%|██████████| 10/10 [00:01<00:00,  6.92it/s]
100%|██████████| 10/10 [00:01<00:00,  6.85it/s]
 Site-1| Train Acc: 0.8812

  0%|          | 0/1 [00:00<?, ?it/s]
100%|██████████| 1/1 [00:00<00:00,  7.07it/s]
100%|██████████| 1/1 [00:00<00:00,  7.05it/s]
 Site-1| Val  Acc: 0.8750

  0%|          | 0/23 [00:00<?, ?it/s]
  4%|▍         | 1/23 [00:00<00:03,  6.77it/s]
  9%|▊         | 2/23 [00:00<00:03,  6.76it/s]
 13%|█▎        | 3/23 [00:00<00:02,  6.75it/s]
 17%|█▋        | 4/23 [00:00<00:02,  6.92it/s]
 22%|██▏       | 5/23 [00:00<00:02,  6.98it/s]
 26%|██▌       | 6/23 [00:00<00:02,  7.02it/s]
 30%|███       | 7/23 [00:01<00:02,  6.52it/s]
 35%|███▍      | 8/23 [00:01<00:02,  6.63it/s]
 39%|███▉      | 9/23 [00:01<00:02,  6.69it/s]
 43%|████▎     | 10/23 [00:01<00:01,  6.77it/s]
 48%|████▊     | 11/23 [00:01<00:01,  6.79it/s]
 52%|█████▏    | 12/23 [00:01<00:01,  6.66it/s]
 57%|█████▋    | 13/23 [00:01<00:01,  6.64it/s]
 61%|██████    | 14/23 [00:02<00:01,  6.59it/s]
 65%|██████▌   | 15/23 [00:02<00:01,  6.61it/s]
 70%|██████▉   | 16/23 [00:02<00:01,  6.58it/s]
 74%|███████▍  | 17/23 [00:02<00:00,  6.69it/s]
 78%|███████▊  | 18/23 [00:02<00:00,  6.56it/s]
 83%|████████▎ | 19/23 [00:02<00:00,  6.53it/s]
 87%|████████▋ | 20/23 [00:02<00:00,  6.60it/s]
 91%|█████████▏| 21/23 [00:03<00:00,  6.68it/s]
 96%|█████████▌| 22/23 [00:03<00:00,  6.67it/s]
100%|██████████| 23/23 [00:03<00:00,  6.73it/s]
100%|██████████| 23/23 [00:03<00:00,  6.69it/s]
 Site-2| Train Acc: 0.8668

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.59it/s]
100%|██████████| 2/2 [00:00<00:00,  6.50it/s]
100%|██████████| 2/2 [00:00<00:00,  6.50it/s]
 Site-2| Val  Acc: 0.9062

  0%|          | 0/5 [00:00<?, ?it/s]
 20%|██        | 1/5 [00:00<00:00,  6.12it/s]
 40%|████      | 2/5 [00:00<00:00,  6.71it/s]
 60%|██████    | 3/5 [00:00<00:00,  6.11it/s]
 80%|████████  | 4/5 [00:00<00:00,  6.34it/s]
100%|██████████| 5/5 [00:00<00:00,  6.97it/s]
 Test site-0| Test Acc: 0.8435 | Bacc: 0.8688

  0%|          | 0/2 [00:00<?, ?it/s]
 50%|█████     | 1/2 [00:00<00:00,  6.86it/s]
100%|██████████| 2/2 [00:00<00:00, 10.35it/s]
 Test site-1| Test Acc: 0.8571 | Bacc: 0.8636

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:00<00:00,  6.85it/s]
 67%|██████▋   | 2/3 [00:00<00:00,  6.58it/s]
100%|██████████| 3/3 [00:00<00:00,  6.71it/s]
100%|██████████| 3/3 [00:00<00:00,  6.70it/s]
 Test site-2| Test Acc: 0.7872 | Bacc: 0.7837

  0%|          | 0/13 [00:00<?, ?it/s]
  8%|▊         | 1/13 [00:00<00:01,  7.10it/s]
 15%|█▌        | 2/13 [00:00<00:01,  7.38it/s]
 23%|██▎       | 3/13 [00:00<00:01,  7.20it/s]
 31%|███       | 4/13 [00:00<00:01,  7.15it/s]
 38%|███▊      | 5/13 [00:00<00:01,  7.50it/s]
 46%|████▌     | 6/13 [00:00<00:00,  7.68it/s]
 54%|█████▍    | 7/13 [00:00<00:00,  8.09it/s]
 69%|██████▉   | 9/13 [00:01<00:00,  9.11it/s]
 85%|████████▍ | 11/13 [00:01<00:00,  7.41it/s]
 92%|█████████▏| 12/13 [00:01<00:00,  6.34it/s]
100%|██████████| 13/13 [00:01<00:00,  7.44it/s]
 Test site-3| Test Acc: 0.6396 | Bacc: 0.6326

Test Acc: 0.7819 | Bacc: 0.7879